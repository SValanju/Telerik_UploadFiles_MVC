{"version":3,"file":"kendo.chat.min.js","sources":["kendo.chat.js"],"sourcesContent":["(function(f, define) {\n    define('chat/messageBox',[ \"kendo.core\" ], f);\n})(function() {\n\n(function($, undefined) {\n\n    var kendo = window.kendo;\n    var Widget = kendo.ui.Widget;\n    var extend = $.extend;\n    var DOT = \".\";\n    var NS = \".kendoChat\";\n    var keys = kendo.keys;\n    var SEND_ICON = '<svg version=\"1.1\" ixmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 16 16\" xml:space=\"preserve\"><path d=\"M0,14.3c-0.1,0.6,0.3,0.8,0.8,0.6l14.8-6.5c0.5-0.2,0.5-0.6,0-0.8L0.8,1.1C0.3,0.9-0.1,1.1,0,1.7l0.7,4.2C0.8,6.5,1.4,7,1.9,7.1l8.8,0.8c0.6,0.1,0.6,0.1,0,0.2L1.9,8.9C1.4,9,0.8,9.5,0.7,10.1L0,14.3z\"/></svg>';\n    var TOGGLE_ICON = '<svg version=\"1.1\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 512 512\" style=\"enable-background:new 0 0 512 512;\" xml:space=\"preserve\"><g>   <path d=\"M128,240c0-26.4-21.6-48-48-48s-48,21.6-48,48s21.6,48,48,48S128,266.4,128,240z\"/>   <path d=\"M192,240c0,26.4,21.6,48,48,48c26.4,0,48-21.6,48-48s-21.6-48-48-48C213.6,192,192,213.6,192,240z\"/>   <path d=\"M352,240c0,26.4,21.6,48,48,48c26.4,0,48-21.6,48-48s-21.6-48-48-48C373.6,192,352,213.6,352,240z\"/></g></svg>';\n\n    var messageBoxStyles = {\n        input: \"k-input-inner\",\n        inputWrapper: \"k-textbox k-input k-input-lg k-input-solid\",\n        button: \"k-button\",\n        buttonFlat: \"k-button-lg k-button-flat k-button-flat-base\",\n        iconButton: \"k-icon-button\",\n        buttonIcon: \"k-button-icon\",\n        buttonSend: \"k-button-send\",\n        buttonToggle: \"k-button-toggle\",\n        iconAdd: \"k-icon k-i-add\",\n        hidden: \"k-hidden\",\n        inputSuffix: \"k-input-suffix\"\n    };\n\n    var ChatMessageBox = Widget.extend({\n        init: function(element, options) {\n            Widget.fn.init.call(this, element, options);\n\n            this._wrapper();\n\n            this._attachEvents();\n\n            this._typing = false;\n        },\n\n        events: [\n        ],\n\n        options: {\n            messages: {\n                placeholder: \"Type a message...\",\n                toggleButton: \"Toggle toolbar\",\n                sendButton: \"Send message\"\n            }\n        },\n\n        destroy: function() {\n            Widget.fn.destroy.call(this);\n\n            if (this.input) {\n                this.input.off(NS);\n                this.input.remove();\n                this.input = null;\n            }\n\n            this.element.off(NS);\n            this.element.empty();\n        },\n\n        _wrapper: function() {\n            var styles = ChatMessageBox.styles;\n            var options = this.options;\n            var messages = options.messages;\n            var inputId = \"inputId_\" + kendo.guid();\n\n            $(\"<label>\")\n                .addClass(styles.hidden)\n                .html(messages.placeholder)\n                .attr(\"for\", inputId)\n                .appendTo(this.element);\n\n            this.inputWrapper = this.element\n                .addClass(styles.inputWrapper)\n                .appendTo(this.element);\n\n            this.input = $(\"<input type='text'>\")\n                .addClass(styles.input)\n                .attr(\"id\", inputId)\n                .attr(\"placeholder\", messages.placeholder)\n                .appendTo(this.inputWrapper);\n\n            this.inputSuffix = $(\"<span></span>\")\n                .addClass(styles.inputSuffix)\n                .appendTo(this.inputWrapper);\n\n            if (options.toolbar && options.toolbar.toggleable && options.toolbar.buttons && options.toolbar.buttons.length) {\n                $(\"<button>\")\n                    .addClass(styles.button)\n                    .addClass(styles.buttonFlat)\n                    .addClass(styles.iconButton)\n                    .addClass(styles.buttonToggle)\n                    .attr(\"type\", \"button\")\n                    .append($(TOGGLE_ICON))\n                    .appendTo(this.inputSuffix)\n                    .attr(\"title\", messages.toggleButton)\n                    .attr(\"aria-label\", messages.toggleButton);\n            }\n\n            $(\"<button>\")\n                .addClass(styles.button)\n                .addClass(styles.buttonFlat)\n                .addClass(styles.iconButton)\n                .addClass(styles.buttonSend)\n                .append($(SEND_ICON))\n                .appendTo(this.inputSuffix)\n                .attr(\"title\", messages.sendButton)\n                .attr(\"aria-label\", messages.sendButton);\n        },\n\n        _attachEvents: function() {\n            var styles = ChatMessageBox.styles;\n\n            this.input\n                .on(\"keydown\" + NS, this._keydown.bind(this))\n                .on(\"input\" + NS, this._input.bind(this))\n                .on(\"focusout\" + NS, this._inputFocusout.bind(this));\n\n            this.element\n                .on(\"click\" + NS, DOT + styles.buttonSend, this._buttonClick.bind(this));\n\n            this.element\n                .on(\"click\" + NS, DOT + styles.buttonToggle, this._toggleToolbar.bind(this));\n        },\n\n        _input: function() {\n            var currentValue = this.input.val();\n            var start = currentValue.length > 0;\n\n            this._triggerTyping(start);\n        },\n\n        _keydown: function(e) {\n            var key = e.keyCode;\n\n            switch (key) {\n                case keys.ENTER:\n                    e.preventDefault();\n\n                    this._sendMessage();\n                    break;\n            }\n        },\n\n        _buttonClick: function(e) {\n            e.preventDefault();\n\n            this._sendMessage();\n        },\n\n        _sendMessage: function() {\n            var value = this.input.val();\n\n            if (!value.length) {\n                return;\n            }\n\n            this._triggerTyping(false);\n\n            var args = {\n                text: value\n            };\n\n            this.trigger(\"sendMessage\", args);\n\n            this.input.val(\"\");\n        },\n\n        _inputFocusout: function() {\n            this._triggerTyping(false);\n        },\n\n        _triggerTyping: function(start) {\n            if (start) {\n                if (!this._typing) {\n                    this.trigger(\"typingStart\", {});\n                    this._typing = true;\n                }\n            } else {\n                if (this._typing) {\n                    this.trigger(\"typingEnd\", {});\n                    this._typing = false;\n                }\n            }\n        },\n\n        _toggleToolbar: function(ev) {\n            this.trigger(\"toggleToolbar\", { originalEvent: ev });\n        }\n    });\n\n    extend(true, ChatMessageBox, { styles: messageBoxStyles });\n    extend(kendo, {\n        chat: {\n            ChatMessageBox: ChatMessageBox\n        }\n    });\n})(window.kendo.jQuery);\n\nreturn window.kendo;\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3) { (a3 || a2)(); });\n\n(function(f, define) {\n    define('chat/toolbar',[ \"kendo.core\" ], f);\n})(function() {\n\n(function($, undefined) {\n\n    var kendo = window.kendo;\n    var Widget = kendo.ui.Widget;\n    var extend = $.extend;\n    var DOT = \".\";\n    var NS = \".kendoChat\";\n\n    var DATA_K_BUTTON_NAME = \"kButtonName\";\n    var SCROLL_LEFT_NAME = \"chatToolbarScrollLeft\";\n    var SCROLL_RIGHT_NAME = \"chatToolbarScrollRight\";\n    var VISIBLE = \":visible\";\n    var DEFAULT_ANIMATION = {\n        effects: \"expand:vertical\",\n        duration: 200\n    };\n    var NO_ANIMATION = {\n        expand: {\n            show: true\n        },\n        collapse: {\n            hide: true\n        }\n    };\n\n    var toolbarStyles = {\n        button: \"k-button\",\n        buttonDefaults: \"k-button-md k-rounded-md k-button-solid k-button-solid-base\",\n        buttonList: \"k-button-list\",\n        scrollButton: \"k-scroll-button\",\n        scrollButtonLeft: \"k-scroll-button-left\",\n        scrollButtonRight: \"k-scroll-button-right\",\n        scrollButtonLeftIcon: \"k-icon k-i-arrow-chevron-left\",\n        scrollButtonRightIcon: \"k-icon k-i-arrow-chevron-right\",\n        iconButton: \"k-icon-button\"\n    };\n\n    var ChatToolBar = Widget.extend({\n        init: function(element, options) {\n            options = extend({}, options, { name: \"ChatToolbar\" });\n            var toolbarOptions = options.toolbar;\n            var buttonsDefined = toolbarOptions.buttons && toolbarOptions.buttons.length;\n\n            Widget.fn.init.call(this, element, options);\n\n            if (buttonsDefined) {\n                this._createButtonList();\n            }\n\n            if (buttonsDefined && toolbarOptions.scrollable &&\n                    this.buttonsWidth() > this.element.width()) {\n                this._initScrolling();\n            }\n\n            this._setupAnimation();\n\n            if (buttonsDefined && toolbarOptions.toggleable) {\n                this.toggle(true);\n            }\n\n            this.element.on(\"click\" + NS, this._onClick.bind(this));\n        },\n\n        events: [\n            \"click\"\n        ],\n\n        destroy: function() {\n            Widget.fn.destroy.call(this);\n\n            this.element.off(NS);\n            this.element.empty();\n        },\n\n        _createButtonList: function() {\n            var that = this;\n            var styles = ChatToolBar.styles;\n            var buttons = that.options.toolbar.buttons;\n            var buttonList = $(\"<div class='\" + styles.buttonList + \"'></div>\");\n\n            for (var i = 0; i < buttons.length; i++) {\n                var button = that._createButton(buttons[i]);\n                buttonList.append(button);\n            }\n\n            buttonList.appendTo(this.element);\n\n            this.buttonList = buttonList;\n        },\n\n        _createButton: function(btnOptions) {\n            var styles = ChatToolBar.styles;\n            var buttonElm = $(\"<button>\");\n\n            if (typeof btnOptions === \"string\") {\n                btnOptions = {\n                    name: btnOptions\n                };\n            }\n\n            buttonElm\n                .attr(btnOptions.attr || {})\n                .attr(\"title\", btnOptions.text || btnOptions.name)\n                .attr(\"aria-label\", btnOptions.text || btnOptions.name)\n                .attr(\"type\", \"button\")\n                .addClass(btnOptions.name)\n                .data(DATA_K_BUTTON_NAME, btnOptions.name)\n                .addClass(styles.button)\n                .addClass(styles.buttonDefaults);\n\n            if (btnOptions.iconClass) {\n                buttonElm.addClass(styles.iconButton);\n                buttonElm.prepend(\"<span class='k-button-icon \" + btnOptions.iconClass + \"'></span>\");\n            }\n\n            return buttonElm;\n        },\n\n        _onClick: function(ev) {\n            var styles = ChatToolBar.styles;\n            var target = $(ev.target).closest(DOT + styles.button);\n\n            if (target.is(DOT + styles.scrollButton) && !this._scrolling) {\n                this._scroll(target.data(DATA_K_BUTTON_NAME));\n            }\n\n            if (target.data(DATA_K_BUTTON_NAME)) {\n                this.trigger(\"click\", {\n                    button: target[0],\n                    name: target.data(DATA_K_BUTTON_NAME),\n                    originalEvent: ev\n                });\n            }\n        },\n\n        _initScrolling: function() {\n            var styles = ChatToolBar.styles;\n\n            this.scrollButtonLeft = this._createButton({\n                name: SCROLL_LEFT_NAME,\n                iconClass: styles.scrollButtonLeftIcon,\n                attr: {\n                    \"class\": styles.scrollButton + \" \" + styles.scrollButtonLeft\n                }\n            });\n\n            this.scrollButtonRight = this._createButton({\n                name: SCROLL_RIGHT_NAME,\n                iconClass: styles.scrollButtonRightIcon,\n                attr: {\n                    \"class\": styles.scrollButton + \" \" + styles.scrollButtonRight\n                }\n            });\n\n            this.element.prepend(this.scrollButtonLeft);\n            this.element.append(this.scrollButtonRight);\n            this._refreshScrollButtons();\n\n            this.element.on(\"keydown\" + NS, this._refreshScrollButtons.bind(this));\n        },\n\n        _scroll: function(commandName) {\n            var that = this;\n            var buttonWidth = that.buttonWidth();\n            var maxScrollSize = this.maxScrollSize();\n            var scrollAmmount = commandName === SCROLL_LEFT_NAME ? buttonWidth * -1 : buttonWidth;\n            var currentScroll = this.currentScrollLeft();\n            var scrollValue = currentScroll + scrollAmmount;\n            scrollValue = Math.min(Math.max(scrollValue, 0), maxScrollSize);\n\n            if (commandName !== SCROLL_LEFT_NAME && commandName !== SCROLL_RIGHT_NAME) {\n                return;\n            }\n\n            kendo.scrollLeft(that.buttonList, scrollValue);\n            that._refreshScrollButtons(scrollValue);\n        },\n\n        _refreshScrollButtons: function(value) {\n            var maxScrollSize = this.maxScrollSize();\n            var currentScrollLeft = value === undefined || isNaN(parseInt(value, 10)) ? this.currentScrollLeft() : value;\n\n            if (!this.scrollButtonLeft && !this.scrollButtonRight) {\n                return;\n            }\n\n            this.scrollButtonLeft.toggle(currentScrollLeft !== 0);\n            this.scrollButtonRight.toggle(currentScrollLeft !== maxScrollSize);\n        },\n\n        _setupAnimation: function() {\n            var animation = this.options.toolbar.animation;\n            var defaultExpandAnimation = extend({}, DEFAULT_ANIMATION);\n            var defaultCollapseAnimation = extend({\n                reverse: true,\n                hide: true\n            }, DEFAULT_ANIMATION);\n\n            if (animation === false) {\n                animation = extend(true, {}, NO_ANIMATION);\n            } else {\n                animation = extend(true, {\n                    expand: defaultExpandAnimation,\n                    collapse: defaultCollapseAnimation\n                }, animation);\n            }\n\n            this.options.toolbar.animation = animation;\n        },\n\n        _animationComplete: function() {\n            this._refreshScrollButtons();\n        },\n\n        currentScrollLeft: function() {\n            return Math.round(kendo.scrollLeft(this.buttonList));\n        },\n\n        maxScrollSize: function() {\n            return Math.round(this.buttonList[0].scrollWidth - this.buttonList[0].clientWidth);\n        },\n\n        buttons: function() {\n            var styles = ChatToolBar.styles;\n            return this.buttonList ? this.buttonList.children(DOT + styles.button) : null;\n        },\n\n        buttonWidth: function() {\n            return Math.round(this.buttons().last().outerWidth(true));\n        },\n\n        buttonsWidth: function() {\n            var width = 0;\n\n            if (this.buttons()) {\n                width = this.buttonWidth() * this.buttons().length;\n            }\n\n            return width;\n        },\n\n        toggle: function(skipAnimation) {\n            var animation = this.options.toolbar.animation;\n\n            if (skipAnimation) {\n                animation = extend(true, {}, NO_ANIMATION);\n            }\n\n            animation.expand.complete = this._animationComplete.bind(this);\n            animation.collapse.complete = this._animationComplete.bind(this);\n\n            if (this.element.is(VISIBLE)) {\n                this.element.kendoStop().kendoAnimate(animation.collapse);\n            } else {\n                this.element.kendoStop().kendoAnimate(animation.expand);\n            }\n\n        }\n    });\n\n    extend(true, ChatToolBar, { styles: toolbarStyles });\n    extend(kendo.chat, {\n        ChatToolBar: ChatToolBar\n    });\n})(window.kendo.jQuery);\n\nreturn window.kendo;\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3) { (a3 || a2)(); });\n(function(f, define) {\n    define('chat/view',[ \"kendo.core\", \"kendo.draganddrop\" ], f);\n})(function() {\n\n(function($, undefined) {\n\n    var kendo = window.kendo;\n    var Widget = kendo.ui.Widget;\n    var extend = $.extend;\n    var DOT = \".\";\n    var SPACE = \" \";\n    var NS = \".kendoChat\";\n\n    var MESSAGE_GROUP_TEMPLATE = kendo.template(\n        '<div #:text# class=\"#=styles.messageGroup# #= url ? \"\" : styles.noAvatar #\">' +\n            '<p class=\"#=styles.author#\">#:text#</p>' +\n            '# if (url) { #' +\n                '<img src=\"#=url#\" alt=\"#:text#\" class=\"#=styles.avatar#\">' +\n            '# } #' +\n        '</div>');\n\n    var SELF_MESSAGE_GROUP_TEMPLATE = kendo.template(\n        '<div me class=\"#=styles.messageGroup# #=styles.self# #= url ? \"\" : styles.noAvatar #\">' +\n            '# if (url) { #' +\n                '<img src=\"#=url#\" alt=\"#:text#\" class=\"#=styles.avatar#\">' +\n            '# } #' +\n        '</div>');\n\n    var TEXT_MESSAGE_TEMPLATE = kendo.template(\n        '<div class=\"#=styles.message#\">' +\n            '<time class=\"#=styles.messageTime#\">#= kendo.toString(kendo.parseDate(timestamp), \"HH:mm:ss\") #</time>' +\n            '<div class=\"#=styles.bubble#\">#:text#</div>' +\n        '</div>');\n\n    var TYPING_INDICATOR_TEMPLATE = kendo.template(\n        '<div class=\"#=styles.messageListContent# #=styles.typingIndicatorBubble#\">' +\n            '<p class=\"#=styles.author#\">#:text#</p>' +\n            '<div class=\"#=styles.message#\">' +\n                '<div class=\"#=styles.bubble#\">' +\n                    '<div class=\"#=styles.typingIndicator#\">' +\n                        '<span></span><span></span><span></span>' +\n                    '</div>' +\n                '</div>' +\n            '</div>' +\n        '</div>');\n\n    var SUGGESTED_ACTIONS_TEMPLATE = kendo.template(\n        '<div class=\"#=styles.suggestedActions#\">' +\n            '# for (var i = 0; i < suggestedActions.length; i++) { #' +\n                '<span role=\"button\" tabindex=\"0\" class=\"#=styles.suggestedAction#\" data-value=\"#:suggestedActions[i].value#\">#:suggestedActions[i].title#</span>' +\n            '# } #' +\n        '</div>'\n        );\n\n    var HERO_CARD_TEMPLATE = kendo.template(\n        '<div class=\"#=styles.card# #=styles.cardRich#\">' +\n            '# if (typeof images !== \"undefined\" && images.length > 0) { #' +\n                '<img src=\"#:images[0].url#\" alt=\"#:images[0].alt#\" class=\"#=styles.cardImage#\" />' +\n            '# } #' +\n            '<div class=\"#=styles.cardBody#\">' +\n                '# if (typeof title !== \"undefined\") { #' +\n                    '<h5 class=\"#=styles.cardTitle#\">#:title#</h5>' +\n                '# } #' +\n                '# if (typeof subtitle !== \"undefined\") { #' +\n                    '<h6 class=\"#=styles.cardSubtitle#\">#:subtitle#</h6>' +\n                '# } #' +\n                '# if (typeof text !== \"undefined\") { #' +\n                    '<p>#:text#</p>' +\n                '# } #' +\n            '</div>' +\n            '# if (typeof buttons !== \"undefined\" && buttons.length > 0) { #' +\n                '<div class=\"#=styles.cardActions# #=styles.cardActionsVertical#\">' +\n                '# for (var i = 0; i < buttons.length; i++) { #' +\n                    '<span class=\"#=styles.cardAction#\"><span class=\"#=styles.button# #=styles.buttonPrimary#\" data-value=\"#:buttons[i].value#\">#:buttons[i].title#</span></span>' +\n                '# } #' +\n                '</div>' +\n            '# } #' +\n        '</div>'\n        );\n\n    extend(kendo.chat, {\n        Templates: {},\n        Components: {}\n    });\n\n    kendo.chat.registerTemplate = function(templateName, template) {\n        kendo.chat.Templates[templateName] = kendo.template(template);\n    };\n\n    kendo.chat.getTemplate = function(templateName) {\n        return kendo.chat.Templates[templateName] || TEXT_MESSAGE_TEMPLATE;\n    };\n\n    kendo.chat.registerTemplate(\"text\", TEXT_MESSAGE_TEMPLATE);\n    kendo.chat.registerTemplate(\"message\", TEXT_MESSAGE_TEMPLATE);\n    kendo.chat.registerTemplate(\"typing\", TYPING_INDICATOR_TEMPLATE);\n    kendo.chat.registerTemplate(\"suggestedAction\", SUGGESTED_ACTIONS_TEMPLATE);\n    kendo.chat.registerTemplate(\"heroCard\", HERO_CARD_TEMPLATE);\n    kendo.chat.registerTemplate(\"application/vnd.microsoft.card.hero\", HERO_CARD_TEMPLATE);\n\n    kendo.chat.registerComponent = function(componentName, component) {\n        kendo.chat.Components[componentName] = component;\n    };\n\n    kendo.chat.getComponent = function(componentName) {\n        return kendo.chat.Components[componentName] || null;\n    };\n\n    var Component = kendo.chat.Component = kendo.Class.extend({\n        init: function(options, view) {\n            this.element = $('<div></div>');\n            this.options = options;\n            this.view = view;\n        },\n\n        destroy: function() {\n            kendo.destroy(this.element);\n        }\n    });\n\n    var Calendar = Component.extend({\n        init: function(options, view) {\n            Component.fn.init.call(this, options, view);\n\n            this.element.kendoCalendar({\n                change: function() {\n                    view.trigger(\"suggestedAction\", { text: kendo.toString(this.value(), 'd'), type: \"message\" });\n                }\n            });\n        },\n\n        destroy: function() {\n        }\n    });\n    kendo.chat.registerComponent(\"calendar\", Calendar);\n\n    var viewStyles = {\n        wrapper: \"k-widget k-chat\",\n        messageList: \"k-avatars\",\n        messageListContent: \"k-message-list-content\",\n        messageTime: \"k-message-time\",\n        messageGroup: \"k-message-group\",\n        message: \"k-message\",\n        only: \"k-only\",\n        first: \"k-first\",\n        middle: \"k-middle\",\n        last: \"k-last\",\n        author: \"k-author\",\n        avatar: \"k-avatar\",\n        noAvatar: \"k-no-avatar\",\n        self: \"k-alt\",\n        button: \"k-button\",\n        buttonDefaults: \"k-button-md k-rounded-md k-button-solid k-button-solid-base\",\n        iconButton: \"k-icon-button\",\n        buttonIcon: \"k-button-icon\",\n        buttonPrimary: \"k-button-md k-rounded-md k-button-flat k-button-flat-primary\",\n        scrollButtonIcon: \"k-icon\",\n        scrollButtonIconLeft: \"k-i-arrow-chevron-left\",\n        scrollButtonIconRight: \"k-i-arrow-chevron-right\",\n        typingIndicator: \"k-typing-indicator\",\n        typingIndicatorBubble: \"k-typing-indicator-bubble\",\n        bubble: \"k-bubble\",\n        suggestedActions: \"k-quick-replies\",\n        suggestedAction: \"k-quick-reply\",\n        cardWrapper: \"k-card-container\",\n        cardDeckScrollWrap: \"k-card-deck-scrollwrap\",\n        cardDeck: \"k-card-deck\",\n        cardList: \"k-card-list\",\n        card: \"k-card\",\n        cardRich: \"k-card-type-rich\",\n        cardBody: \"k-card-body\",\n        cardImage: \"k-card-image\",\n        cardTitle: \"k-card-title\",\n        cardSubtitle: \"k-card-subtitle\",\n        cardActions: \"k-card-actions\",\n        cardActionsVertical: \"k-card-actions-vertical\",\n        cardAction: \"k-card-action\",\n        selected: \"k-state-selected\"\n    };\n\n    var ChatView = kendo.chat.ChatView = Widget.extend({\n        init: function(element, options) {\n            Widget.fn.init.call(this, element, options);\n\n            this._list();\n\n            this._lastSender = null;\n\n            this.typingParticipants = [];\n\n            this._attachEvents();\n\n            this._scrollable();\n        },\n\n        events: [\n        ],\n\n        options: {\n            messages: {\n                isTyping: \" is typing.\",\n                areTyping: \" are typing.\",\n                and: \" and \"\n            }\n        },\n\n        destroy: function() {\n            Widget.fn.destroy.call(this);\n\n            if (this._scrollDraggable) {\n                this._scrollDraggable.destroy();\n            }\n\n            this.element.empty();\n            this.element.off(NS);\n\n            this.list = null;\n            this._lastSender = null;\n        },\n\n        _list: function() {\n            var viewStyles = ChatView.styles;\n\n            this.element\n                .addClass(viewStyles.messageList)\n                .attr(\"role\", \"log\")\n                .attr(\"aria-label\", this.options.messages.messageListLabel);\n\n            this.list = $(\"<div>\")\n                .addClass(viewStyles.messageListContent)\n                .appendTo(this.element);\n        },\n\n        _attachEvents: function() {\n            var styles = ChatView.styles;\n\n            this.element\n                .on(\"click\" + NS, this._listClick.bind(this))\n                .on(\"click\" + NS, DOT + styles.message, this._messageClick.bind(this))\n                .on(\"click\" + NS, DOT + styles.suggestedAction, this._suggestedActionClick.bind(this))\n                .on(\"click\" + NS, DOT + styles.cardAction + SPACE + DOT + styles.button, this._cardActionClick.bind(this));\n\n            this.element.on(\"keydown\" + NS, DOT + styles.suggestedAction, this._suggestedActionKeydown.bind(this));\n        },\n\n        _scrollable: function() {\n            var viewStyles = ChatView.styles;\n\n            this.element\n                .on(\"click\" + NS, DOT + viewStyles.cardDeckScrollWrap + SPACE + DOT + viewStyles.button, this._scrollButtonClick.bind(this));\n        },\n\n        _scrollButtonClick: function(e) {\n            var viewStyles = ChatView.styles;\n            var button = $(e.currentTarget);\n            var scrollToLeft = button.find(DOT + viewStyles.scrollButtonIconLeft).length !== 0;\n            var scrollContainer = button.siblings(DOT + viewStyles.cardDeck);\n            var lastCard = scrollContainer.find(DOT + viewStyles.card).last();\n            var cardWidth = lastCard.outerWidth(true);\n\n            if (scrollToLeft) {\n                kendo.scrollLeft(scrollContainer, kendo.scrollLeft(scrollContainer) - cardWidth);\n            } else {\n                kendo.scrollLeft(scrollContainer, kendo.scrollLeft(scrollContainer) + cardWidth);\n            }\n        },\n\n        getTemplate: function(templateName) {\n            return kendo.chat.getTemplate(templateName);\n        },\n\n        getComponent: function(type) {\n           return kendo.chat.getComponent(type);\n        },\n\n        renderMessage: function(message, sender) {\n            if (!message.timestamp) {\n                message.timestamp = new Date();\n            }\n\n            if (!message.text) {\n                message.text = \"\";\n            }\n\n            var bubbleElement = this._renderTemplate(message.type, message);\n\n            this._renderBubble(message.type, bubbleElement, sender);\n\n            if (message.type == \"typing\") {\n                if (this.typingParticipants.length > 0) {\n                    this._removeTypingParticipant(sender);\n                }\n            } else {\n                this._lastSender = sender.id;\n            }\n        },\n\n        renderSuggestedActions: function(suggestedActions) {\n            this._removeSuggestedActions();\n\n            var element = this._renderTemplate(\"suggestedAction\", { suggestedActions: suggestedActions });\n\n            this.list.append(element);\n\n            this._scrollToBottom();\n        },\n\n        renderAttachments: function(options) {\n            var wrapper = this._renderAttachmentWrapper(options.attachmentLayout);\n            var cardContainer = options.attachmentLayout === \"carousel\" ? wrapper.find(DOT + ChatView.styles.cardDeck) : wrapper;\n            var attachments = options.attachments;\n\n            if (!attachments.length) {\n                return;\n            }\n\n            for (var i = 0; i < attachments.length; i++) {\n                var cardElement = this._renderTemplate(attachments[i].contentType, attachments[i].content);\n\n                cardContainer.append(cardElement);\n            }\n\n            this._removeSuggestedActions();\n            this._removeTypingIndicator();\n\n            this.list.append(wrapper);\n\n            this._lastSender = null;\n        },\n\n        renderComponent: function(type) {\n            var componentType = this.getComponent(type);\n            var component = new componentType({}, this);\n\n            this.list.append(component.element);\n\n            this._scrollToBottom();\n        },\n\n        _renderAttachmentWrapper: function(layout) {\n            var viewStyles = ChatView.styles;\n            var wrapper = $(\"<div>\");\n\n            if (layout === \"carousel\") {\n                wrapper.addClass(viewStyles.cardDeckScrollWrap);\n\n                var buttonLeft = this._renderScrollButton(viewStyles.scrollButtonIconLeft);\n                wrapper.append(buttonLeft);\n\n                wrapper.append($(\"<div>\").addClass(viewStyles.cardDeck));\n\n                var buttonRight = this._renderScrollButton(viewStyles.scrollButtonIconRight);\n                wrapper.append(buttonRight);\n            } else {\n                wrapper.addClass(viewStyles.cardList);\n            }\n\n            return wrapper;\n        },\n\n        _renderScrollButton: function(directionClass) {\n            var viewStyles = ChatView.styles;\n\n            return $(\"<button>\")\n                .addClass(viewStyles.button)\n                .addClass(viewStyles.buttonDefaults)\n                .addClass(viewStyles.iconButton)\n                .append($(\"<span>\")\n                    .addClass(viewStyles.buttonIcon)\n                    .addClass(viewStyles.scrollButtonIcon)\n                    .addClass(directionClass)\n                );\n        },\n\n        _removeSuggestedActions: function() {\n            this.list.find(DOT + ChatView.styles.suggestedActions).remove();\n        },\n\n        _listClick: function(e) {\n            var styles = ChatView.styles;\n            var targetElement = $(e.target);\n\n            if (targetElement.hasClass(styles.message) || targetElement.parents(DOT + styles.message).length) {\n                return;\n            }\n\n            this._clearSelection();\n        },\n\n        _messageClick: function(e) {\n            this._clearSelection();\n\n            $(e.currentTarget).addClass(ChatView.styles.selected);\n        },\n\n        _suggestedActionClick: function(e) {\n            var text = $(e.target).data(\"value\") || \"\";\n\n            this.trigger(\"actionClick\", { text: text });\n\n            this._removeSuggestedActions();\n        },\n\n        _suggestedActionKeydown: function(e) {\n            if (e.keyCode === kendo.keys.SPACEBAR || e.keyCode === kendo.keys.ENTER) {\n                this._suggestedActionClick(e);\n            }\n        },\n\n        _cardActionClick: function(e) {\n            var text = $(e.target).data(\"value\") || \"\";\n\n            this.trigger(\"actionClick\", { text: text });\n        },\n\n        _renderBubble: function(messageType, bubbleElement, sender) {\n            this._removeSuggestedActions();\n            this._removeTypingIndicator();\n\n            var group = this._getMessageGroup(sender, messageType);\n\n            this._appendToGroup(group, bubbleElement, messageType);\n\n            this._scrollToBottom();\n        },\n\n        _renderTemplate: function(type, options) {\n            var componentType = this.getComponent(type);\n            var element;\n\n            if (componentType) {\n                var component = new componentType(options, this);\n\n                element = component.element;\n            } else {\n                var template = this.getTemplate(type);\n                var templateOptions = extend(true, {}, options, { styles: ChatView.styles });\n\n                element = $(template(templateOptions));\n            }\n\n            return element;\n        },\n\n        _getMessageGroup: function(sender, messageType) {\n            var viewStyles = ChatView.styles;\n            var template = this._getMessageGroupTemplate(sender, messageType);\n            var appendTarget = messageType == \"typing\" ? this.element : this.list;\n            var group;\n\n            if (sender.id === this._lastSender && this._lastSender !== null && messageType !== \"typing\") {\n                group = this.list.find(DOT + viewStyles.messageGroup).last();\n\n                if (group.length) {\n                    return group;\n                }\n            }\n\n            return $(template({ text: sender.name, url: sender.iconUrl, styles: viewStyles })).appendTo(appendTarget);\n        },\n\n        _getMessageGroupTemplate: function(sender, messageType) {\n            var isOwnMessage = sender.id === this.options.user.id;\n            var template = isOwnMessage ?\n                SELF_MESSAGE_GROUP_TEMPLATE :\n                MESSAGE_GROUP_TEMPLATE;\n\n            if (messageType == \"typing\") {\n                template = TYPING_INDICATOR_TEMPLATE;\n            }\n\n            return template;\n        },\n\n        _appendToGroup: function(group, messageElement, messageType) {\n            var viewStyles = ChatView.styles;\n            var children = group.find(DOT + viewStyles.message);\n            var childrenCount = children.length;\n            var indicator = this.element.find(DOT + viewStyles.typingIndicator);\n\n            if (indicator.length && messageType == \"typing\") {\n                return;\n            }\n\n            messageElement.addClass(childrenCount === 0 ? viewStyles.only : viewStyles.last);\n\n            children.filter(DOT + viewStyles.only)\n                .removeClass(viewStyles.only)\n                .addClass(viewStyles.first);\n\n            children.filter(DOT + viewStyles.last)\n                .removeClass(viewStyles.last)\n                .addClass(viewStyles.middle);\n\n            group.append(messageElement);\n        },\n\n        _renderTypingIndicator: function(sender) {\n            var indicator = this.element.find(DOT + viewStyles.typingIndicatorBubble),\n                indicatorList,\n                participants;\n\n            this._addTypingParticipant(sender);\n\n            if (indicator.length) {\n                participants = this._composeTypingParticipantsText(this.typingParticipants);\n\n                indicatorList = indicator.find(DOT + viewStyles.author).first();\n                indicatorList.text(participants);\n\n            } else {\n                $(TYPING_INDICATOR_TEMPLATE({\n                    text: sender.name + this.options.messages.isTyping,\n                    styles: viewStyles\n                })).appendTo(this.element);\n            }\n\n            this._scrollToBottom();\n        },\n\n        _addTypingParticipant: function(sender) {\n            var found = false;\n            for (var i = 0; i < this.typingParticipants.length; i += 1) {\n                if (this.typingParticipants[i].id == sender.id) {\n                    found = true;\n                    break;\n                }\n            }\n            if (!found) {\n                this.typingParticipants.push(sender);\n            }\n        },\n\n        _removeTypingParticipant: function(sender) {\n            var indicator = this.element.find(DOT + viewStyles.typingIndicatorBubble),\n                indicatorList,\n                participants;\n\n            if (indicator.length) {\n                for (var i = 0; i < this.typingParticipants.length; i += 1) {\n                    if (this.typingParticipants[i].id == sender.id) {\n                        this.typingParticipants.splice(i, 1);\n                    }\n                }\n\n                participants = this._composeTypingParticipantsText(this.typingParticipants);\n\n                if (participants === \"\") {\n                    indicator.remove();\n                } else {\n                    indicatorList = indicator.find(DOT + viewStyles.author).first();\n                    indicatorList.text(participants);\n                }\n            }\n        },\n\n        _composeTypingParticipantsText: function(participants) {\n            var messages = this.options.messages,\n                typingAction = participants.length == 1 ? messages.isTyping : messages.areTyping,\n                typingText = \"\";\n\n            if (participants.length === 0) {\n                return typingText;\n            }\n\n            typingText = this.typingParticipants.map(function(author) {\n                return author.name;\n            }).join(', ').replace(/,(?!.*,)/gmi, messages.and.trimRight()) + typingAction;\n\n            return typingText;\n        },\n\n        _removeTypingIndicator: function() {\n            var indicator = this.element.find(DOT + viewStyles.typingIndicatorBubble);\n\n            if (indicator.length) {\n                this.typingParticipants = [];\n                indicator.remove();\n            }\n        },\n\n        _clearSelection: function() {\n            var selectedClass = ChatView.styles.selected;\n\n            this.element.find(DOT + selectedClass).removeClass(selectedClass);\n        },\n\n        _scrollToBottom: function() {\n            this.element.scrollTop(this.element.prop(\"scrollHeight\"));\n        }\n    });\n\n    extend(true, ChatView, { styles: viewStyles });\n\n})(window.kendo.jQuery);\n\nreturn window.kendo;\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3) { (a3 || a2)(); });\n\n(function(f, define) {\n    define('kendo.chat',[ \"./chat/messageBox\", \"./chat/toolbar\", \"./chat/view\" ], f);\n})(function() {\n\nvar __meta__ = { // jshint ignore:line\n    id: \"chat\",\n    name: \"Chat\",\n    category: \"web\",\n    description: \"The Chat component.\",\n    depends: [ \"core\", \"draganddrop\" ]\n};\n\n(function($, undefined) {\n\n    var kendo = window.kendo;\n    var Widget = kendo.ui.Widget;\n    var extend = $.extend;\n    var DOT = \".\";\n\n    var chatStyles = {\n        wrapper: \"k-widget k-chat\",\n        canvas: \"k-chat-canvas\",\n        viewWrapper: \"k-message-list\",\n        messageBoxWrapper: \"k-message-box\",\n        toolbarBoxWrapper: \"k-toolbar-box\"\n    };\n\n    var Chat = Widget.extend({\n        init: function(element, options, events) {\n            Widget.fn.init.call(this, element, options);\n\n            if (events) {\n                this._events = events;\n            }\n\n            this._user();\n\n            this._wrapper();\n\n            this._view();\n\n            this._messageBox();\n\n            if (options && options.toolbar && options.toolbar.buttons) {\n                this._toolbar();\n            }\n\n            kendo.notify(this);\n        },\n\n        events: [\n            \"typingStart\",\n            \"typingEnd\",\n            \"post\",\n            \"sendMessage\",\n            \"actionClick\",\n            \"toolClick\"\n        ],\n\n        options: {\n            user: {\n                name: \"User\",\n                iconUrl: \"\"\n            },\n            name: \"Chat\",\n            messages: {\n                messageListLabel: \"Message list\",\n                placeholder: \"Type a message...\",\n                toggleButton: \"Toggle toolbar\",\n                sendButton: \"Send message\"\n            },\n            toolbar: false\n        },\n\n        setOptions: function(options) {\n            this._setEvents(options);\n            $.extend(true, this.options, options);\n\n            if (this.toolbar && \"toolbar\" in options) {\n                this.toolbar.destroy();\n                this.toolbar = null;\n            }\n\n            if (this.messageBox) {\n                this.messageBox.unbind();\n                this.messageBox.destroy();\n                this.messageBox = null;\n            }\n\n            this._messageBox();\n\n            if (\"toolbar\" in options) {\n                this._resetToolbarButtons(options);\n                this._toolbar();\n            }\n        },\n\n        _resetToolbarButtons: function(options) {\n            var toolbarBoxWrapper = this.wrapper.find(DOT + chatStyles.toolbarBoxWrapper);\n\n            if (!toolbarBoxWrapper.is(\":visible\")) {\n                toolbarBoxWrapper.show();\n            }\n\n            if (options.toolbar && typeof options.toolbar == \"object\" && \"buttons\" in options.toolbar) {\n                this.options.toolbar.buttons = options.toolbar.buttons;\n            }\n        },\n\n        destroy: function() {\n            if (this.view) {\n                this.view.unbind();\n                this.view.destroy();\n                this.view = null;\n            }\n\n            if (this.messageBox) {\n                this.messageBox.unbind();\n                this.messageBox.destroy();\n                this.messageBox = null;\n            }\n\n            if (this.toolbar) {\n                this.toolbar.destroy();\n                this.toolbar = null;\n            }\n\n            Widget.fn.destroy.call(this);\n        },\n\n        _user: function() {\n            this.options.user.id = kendo.guid();\n        },\n\n        getUser: function() {\n            return extend(true, {}, this.options.user);\n        },\n\n        _wrapper: function() {\n            var chatStyles = Chat.styles;\n            var options = this.options;\n            var height = options.height;\n            var width = options.width;\n            var uiElements = \"<div class='\" + chatStyles.viewWrapper + \"'></div>\" +\n                             \"<span class='\" + chatStyles.messageBoxWrapper + \"'></span>\" +\n                             \"<div class='\" + chatStyles.toolbarBoxWrapper + \"' role='toolbar' style='display:none;'></div>\";\n\n            this.wrapper = this.element\n                .addClass(chatStyles.wrapper)\n                .append(uiElements);\n\n            if (options.toolbar && options.toolbar.buttons && options.toolbar.buttons.length) {\n                this.wrapper.find(DOT + chatStyles.toolbarBoxWrapper).show();\n            }\n\n            if (height) {\n                this.wrapper.height(height);\n            }\n\n            if (width) {\n                this.wrapper.css(\"max-width\", width);\n            }\n        },\n\n        _view: function() {\n            var that = this;\n            var chatStyles = Chat.styles;\n            var options = extend(true, {}, this.options);\n\n            var element = this.wrapper.find(DOT + chatStyles.viewWrapper + \"\");\n\n            this.view = new kendo.chat.ChatView(element, options);\n\n            this.view\n                .bind(\"actionClick\", function(args) {\n                    that.trigger(\"actionClick\", args);\n\n                    that.postMessage(args.text);\n                });\n        },\n\n        _messageBox: function() {\n            var that = this;\n            var chatStyles = Chat.styles;\n            var options = extend(true, {}, this.options);\n            var element = this.wrapper.find(DOT + chatStyles.messageBoxWrapper + \"\");\n\n            this.messageBox = new kendo.chat.ChatMessageBox(element, options);\n\n            this.messageBox\n                .bind(\"typingStart\", function(args) {\n                    that.trigger(\"typingStart\", args);\n                })\n                .bind(\"typingEnd\", function(args) {\n                    that.trigger(\"typingEnd\", args);\n                })\n                .bind(\"sendMessage\", function(args) {\n                    that.trigger(\"sendMessage\", args);\n\n                    that.postMessage(args.text);\n                })\n                .bind(\"toggleToolbar\", function() {\n                    that.toggleToolbar();\n                });\n        },\n\n        _toolbar: function() {\n            var that = this;\n            var chatStyles = Chat.styles;\n            var options = extend(true, {}, that.options);\n            var element = that.wrapper.find(DOT + chatStyles.toolbarBoxWrapper + \"\");\n\n            if (options.toolbar.scrollable === undefined) {\n                this.options.toolbar.scrollable = options.toolbar.scrollable = true;\n            }\n\n            if (options.toolbar.toggleable === undefined) {\n                this.options.toolbar.toggleable = options.toolbar.toggleable = false;\n            }\n\n            that.toolbar = new kendo.chat.ChatToolBar(element, options);\n\n            that.toolbar.bind(\"click\", function(ev) {\n                that.trigger(\"toolClick\", {\n                    sender: that,\n                    name: ev.name,\n                    button: ev.button,\n                    messageBox: that.messageBox.input[0],\n                    originalEvent: ev.originalEvent\n                });\n            });\n        },\n\n        postMessage: function(message) {\n            var postArgs = extend(true, {}, { text: message, type: \"message\", timestamp: new Date(), from: this.getUser() });\n\n            this.trigger(\"post\", postArgs);\n\n            this.renderMessage(postArgs, postArgs.from);\n        },\n\n        // TEST calling View renderMessage\n        renderMessage: function(message, sender) {\n            this.view.renderMessage(message, sender);\n        },\n\n        // TEST calling View renderSuggestedActions\n        renderSuggestedActions: function(suggestedActions) {\n            this.view.renderSuggestedActions(suggestedActions);\n        },\n\n        // TEST calling View renderCard\n        renderAttachments: function(options, sender) {\n            this.view.renderAttachments(options, sender);\n        },\n\n        toggleToolbar: function(skipAnimation) {\n            this.toolbar.toggle(skipAnimation);\n        },\n\n        renderUserTypingIndicator: function(sender) {\n            this.view._renderTypingIndicator(sender);\n        },\n\n        clearUserTypingIndicator: function(sender) {\n            this.view._removeTypingParticipant(sender);\n        },\n\n        removeTypingIndicator: function() {\n            this.view._removeTypingIndicator();\n        }\n    });\n\n    kendo.ui.plugin(Chat);\n\n    extend(true, Chat, { styles: chatStyles });\n\n})(window.kendo.jQuery);\n\nreturn window.kendo;\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3) { (a3 || a2)(); });\n\n"],"names":["define","$","window","kendo","jQuery","undefined","Widget","ui","extend","DOT","NS","keys","SEND_ICON","TOGGLE_ICON","messageBoxStyles","input","inputWrapper","button","buttonFlat","iconButton","buttonIcon","buttonSend","buttonToggle","iconAdd","hidden","inputSuffix","ChatMessageBox","init","element","options","fn","call","this","_wrapper","_attachEvents","_typing","events","messages","placeholder","toggleButton","sendButton","destroy","off","remove","empty","styles","inputId","guid","addClass","html","attr","appendTo","toolbar","toggleable","buttons","length","append","on","_keydown","bind","_input","_inputFocusout","_buttonClick","_toggleToolbar","currentValue","val","start","_triggerTyping","e","key","keyCode","ENTER","preventDefault","_sendMessage","value","args","text","trigger","ev","originalEvent","chat","amd","a1","a2","a3","DATA_K_BUTTON_NAME","SCROLL_LEFT_NAME","SCROLL_RIGHT_NAME","VISIBLE","DEFAULT_ANIMATION","effects","duration","NO_ANIMATION","expand","show","collapse","hide","toolbarStyles","buttonDefaults","buttonList","scrollButton","scrollButtonLeft","scrollButtonRight","scrollButtonLeftIcon","scrollButtonRightIcon","ChatToolBar","name","toolbarOptions","buttonsDefined","_createButtonList","scrollable","buttonsWidth","width","_initScrolling","_setupAnimation","toggle","_onClick","that","i","_createButton","btnOptions","buttonElm","data","iconClass","prepend","target","closest","is","_scrolling","_scroll","class","_refreshScrollButtons","commandName","buttonWidth","maxScrollSize","scrollAmmount","currentScroll","currentScrollLeft","scrollValue","Math","min","max","scrollLeft","isNaN","parseInt","animation","defaultExpandAnimation","defaultCollapseAnimation","reverse","_animationComplete","round","scrollWidth","clientWidth","children","last","outerWidth","skipAnimation","complete","kendoStop","kendoAnimate","SPACE","MESSAGE_GROUP_TEMPLATE","template","SELF_MESSAGE_GROUP_TEMPLATE","TEXT_MESSAGE_TEMPLATE","TYPING_INDICATOR_TEMPLATE","SUGGESTED_ACTIONS_TEMPLATE","HERO_CARD_TEMPLATE","Component","Templates","Components","registerTemplate","templateName","getTemplate","registerComponent","componentName","component","getComponent","Class","view","Calendar","kendoCalendar","change","toString","type","viewStyles","wrapper","messageList","messageListContent","messageTime","messageGroup","message","only","first","middle","author","avatar","noAvatar","self","buttonPrimary","scrollButtonIcon","scrollButtonIconLeft","scrollButtonIconRight","typingIndicator","typingIndicatorBubble","bubble","suggestedActions","suggestedAction","cardWrapper","cardDeckScrollWrap","cardDeck","cardList","card","cardRich","cardBody","cardImage","cardTitle","cardSubtitle","cardActions","cardActionsVertical","cardAction","selected","ChatView","_list","_lastSender","typingParticipants","_scrollable","isTyping","areTyping","and","_scrollDraggable","list","messageListLabel","_listClick","_messageClick","_suggestedActionClick","_cardActionClick","_suggestedActionKeydown","_scrollButtonClick","currentTarget","scrollToLeft","find","scrollContainer","siblings","lastCard","cardWidth","renderMessage","sender","timestamp","Date","bubbleElement","_renderTemplate","_renderBubble","_removeTypingParticipant","id","renderSuggestedActions","_removeSuggestedActions","_scrollToBottom","renderAttachments","_renderAttachmentWrapper","attachmentLayout","cardContainer","attachments","cardElement","contentType","content","_removeTypingIndicator","renderComponent","componentType","layout","buttonLeft","_renderScrollButton","buttonRight","directionClass","targetElement","hasClass","parents","_clearSelection","SPACEBAR","messageType","group","_getMessageGroup","_appendToGroup","templateOptions","_getMessageGroupTemplate","appendTarget","url","iconUrl","isOwnMessage","user","messageElement","childrenCount","indicator","filter","removeClass","_renderTypingIndicator","indicatorList","participants","_addTypingParticipant","_composeTypingParticipantsText","found","push","splice","typingAction","typingText","map","join","replace","trimRight","selectedClass","scrollTop","prop","__meta__","category","description","depends","chatStyles","canvas","viewWrapper","messageBoxWrapper","toolbarBoxWrapper","Chat","_events","_user","_view","_messageBox","_toolbar","notify","setOptions","_setEvents","messageBox","unbind","_resetToolbarButtons","getUser","height","uiElements","css","postMessage","toggleToolbar","postArgs","from","renderUserTypingIndicator","clearUserTypingIndicator","removeTypingIndicator","plugin"],"mappings":"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"}