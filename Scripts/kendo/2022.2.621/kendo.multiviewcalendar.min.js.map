{"version":3,"file":"kendo.multiviewcalendar.min.js","sources":["kendo.multiviewcalendar.js"],"sourcesContent":["(function(f, define) {\n    define('kendo.multiviewcalendar',[ \"kendo.core\", \"kendo.selectable\", \"kendo.calendar\" ], f);\n})(function() {\n\nvar __meta__ = { // jshint ignore:line\n    id: \"multiviewcalendar\",\n    name: \"MultiViewCalendar\",\n    category: \"web\",\n    description: \"Multi-view calendar.\",\n    depends: [ \"core\", \"selectable\", \"calendar\" ]\n};\n\n(function($, undefined) {\n    var kendo = window.kendo,\n        calendar = kendo.calendar,\n        support = kendo.support,\n        isInRange = calendar.isInRange,\n        toDateObject = calendar.toDateObject,\n        createDate = calendar.createDate,\n        isEqualDate = calendar.isEqualDate,\n        getToday = calendar.getToday,\n        keys = kendo.keys,\n        ui = kendo.ui,\n        Widget = ui.Widget,\n        Selectable = ui.Selectable,\n        template = kendo.template,\n        mobileOS = support.mobileOS,\n        ns = \".kendoMultiViewCalendar\",\n        CLICK = \"click\",\n        KEYDOWN = \"keydown\",\n        ID = \"id\",\n        MIN = \"min\",\n        MONTH = \"month\",\n        DOT = \".\",\n        CENTURY = \"century\",\n        DECADE = \"decade\",\n        CHANGE = \"change\",\n        NAVIGATE = \"navigate\",\n        VALUE = \"value\",\n        FOCUSED = \"k-state-focused\",\n        SELECTED = \"k-state-selected\",\n        MID = \"k-range-mid\",\n        SPLITEND = \"k-range-split-end\",\n        SPLITSTART = \"k-range-split-start\",\n        START = \"k-range-start\",\n        END = \"k-range-end\",\n        HOVER = \"k-state-hover\",\n        DISABLED = \"k-state-disabled\",\n        TODAY = \"k-nav-today\",\n        OTHERMONTH = \"k-other-month\",\n        OUTOFRANGE = \"k-out-of-range\",\n        CELLSELECTOR = \"td:has(.k-link):not(.\" + OUTOFRANGE + \")\",\n        CELLSELECTORVALID = \"td:has(.k-link):not(.\" + DISABLED + \"):not(.\" + OUTOFRANGE + \")\",\n        BLUR = \"blur\",\n        FOCUS = \"focus\",\n        MOUSEENTER = support.touch ? \"touchstart\" : \"mouseenter\",\n        MOUSELEAVE_NS = support.touch ? \"touchend\" + ns + \" touchmove\" + ns : \"mouseleave\" + ns,\n        PREVARROW = \"_prevArrow\",\n        NEXTARROW = \"_nextArrow\",\n        ARIA_SELECTED = \"aria-selected\",\n        INPUTSELECTOR = \"input,a,textarea,.k-multiselect-wrap,select,button,.k-button>span,.k-button>img,span.k-icon.k-i-arrow-60-down,span.k-icon.k-i-arrow-60-up\",\n        ARIA_DISABLED = \"aria-disabled\",\n        ARIA_LABEL = \"aria-label\",\n        DATE = Date,\n        views = {\n            month: 0,\n            year: 1,\n            decade: 2,\n            century: 3\n        };\n\n    var RangeSelectable = Widget.extend({\n        init: function(element, options) {\n            var that = this;\n\n            Widget.fn.init.call(that, element, options);\n\n            that.calendar = options.calendar;\n\n            that.userEvents = new kendo.UserEvents(that.element, {\n                global: true,\n                allowSelection: true,\n                filter: that.options.filter,\n                tap: that._tap.bind(that),\n                touchAction: \"none\"\n            });\n        },\n\n        events: [CHANGE],\n\n        options: {\n            name: \"RangeSelectable\",\n            filter: \">*\",\n            inputSelectors: INPUTSELECTOR,\n            multiple: false,\n            dragToSelect: true,\n            relatedTarget: $.noop\n        },\n\n        destroy: function() {\n            var that = this;\n\n            Widget.fn.destroy.call(that);\n\n            that.userEvents.destroy();\n            that.calendar = null;\n\n            that._lastActive = that.element = that.userEvents = that._start = that._end = null;\n        },\n\n        _allowSelection: function(target) {\n            if ($(target).is(this.options.inputSelectors)) {\n                this.userEvents.cancel();\n                return false;\n            }\n\n            return true;\n        },\n\n        start: function(element) {\n            if (element === undefined) {\n                return this._start;\n            }\n            element.addClass(START + \" \" + SELECTED);\n            this._start = element;\n        },\n\n        end: function(element) {\n            if (element === undefined) {\n                return this._start;\n            }\n            element.addClass(END + \" \" + SELECTED);\n            this._end = element;\n        },\n\n        mid: function(elements) {\n            var tables = this.element.find(\"table.k-month\");\n\n            elements.addClass(MID);\n            tables.each(function() {\n                var that = $(this);\n                var lastCell = that.find(CELLSELECTORVALID).last();\n                var firstCell = that.find(CELLSELECTORVALID).first();\n\n                if (lastCell.hasClass(MID)) {\n                    lastCell.addClass(SPLITEND);\n                }\n\n                if (firstCell.hasClass(MID)) {\n                    firstCell.addClass(SPLITSTART);\n                }\n            });\n        },\n\n        clear: function(clearVariables) {\n            this.element.find(CELLSELECTOR).removeClass(END + \" \" + SELECTED + \" \" + START + \" \" + MID + \" \" + SPLITEND + \" \" + SPLITSTART);\n\n            if (clearVariables) {\n                this._start = this._end = null;\n            }\n        },\n\n        selectFrom: function(start) {\n            var that = this;\n            var items;\n            var startIdx;\n\n            items = that.element.find(CELLSELECTOR);\n\n            startIdx = $.inArray($(start)[0], items);\n\n            that.clear();\n            that.start(start);\n\n            items = items.filter(function(index) {\n                return index > startIdx;\n            });\n            that.mid(items);\n        },\n\n        selectTo: function(end) {\n            var that = this;\n            var items;\n            var endIdx;\n\n            items = that.element.find(CELLSELECTOR);\n\n            endIdx = $.inArray($(end)[0], items);\n\n            that.clear();\n\n            items = items.filter(function(index) {\n                return index < endIdx;\n            });\n            that.mid(items);\n            that.end($(end));\n        },\n\n        range: function(start, end) {\n            var that = this;\n            var items;\n            var startIdx;\n            var endIdx;\n            var temp;\n\n            if (start === undefined) {\n                return { start: that._start, end: that._end };\n            }\n\n            items = that.element.find(CELLSELECTOR);\n\n            startIdx = $.inArray($(start)[0], items);\n            endIdx = $.inArray($(end)[0], items);\n\n            if (endIdx == -1) {\n                endIdx = items.length;\n            }\n\n            if (startIdx > endIdx) {\n                temp = end;\n                end = start;\n                start = temp;\n                temp = startIdx;\n                startIdx = endIdx;\n                endIdx = temp;\n            }\n            that.clear();\n            start.addClass(START + \" \" + SELECTED);\n            that._start = start;\n\n            items = items.filter(function(index) {\n                return index > startIdx && index < endIdx;\n            });\n            that.mid(items);\n\n            if (end) {\n                that.end($(end));\n            } else {\n                that._useEnd = true;\n            }\n        },\n\n        change: function() {\n            this.trigger(CHANGE);\n        },\n\n        _clearFlags: function() {\n            this._useStart = this._useEnd = false;\n        },\n\n        _tap: function(e) {\n            var target = $(e.target),\n                range = this.calendar.selectRange() || {},\n                start = range.start,\n                end = range.end,\n                that = this,\n                currentDate = toDateObject($(target).find(\"a\")),\n                items,\n                startIdx,\n                endIdx;\n\n\n            that._lastActive = target;\n\n            if (!start || +start > +currentDate) {\n                that.clear(true);\n                that.start(target);\n                that._clearFlags();\n                that.trigger(CHANGE);\n                return;\n            }\n\n            if (start && !end) {\n                items = that.element.find(CELLSELECTOR);\n\n                startIdx = $.inArray($(that._start)[0], items);\n                endIdx = $.inArray($(target)[0], items);\n\n                if (start) {\n                    that._useStart = true;\n                }\n\n                items = items.filter(function(index) {\n                    return index > startIdx && index < endIdx;\n                });\n                that.mid(items);\n                that.end($(target));\n                that.trigger(CHANGE);\n                that._clearFlags();\n                return;\n            }\n\n            if (start && end) {\n                if (target.hasClass(MID)) {\n                    if (!that._toggling) {\n                        that.range(target, that._end);\n                    } else {\n                        that.range(that._start, target);\n                    }\n                    that._toggling = !that._toggling;\n                    that.trigger(CHANGE);\n                    that._clearFlags();\n                    return;\n                }\n                that._toggling = false;\n                that._end = null;\n                that.clear();\n                that.start(target);\n                that.trigger(CHANGE);\n                that._clearFlags();\n            }\n        }\n    });\n\n\n    var MultiViewCalendar = Widget.extend({\n        init: function(element, options) {\n            var that = this;\n            var id;\n            var culture;\n\n            Widget.fn.init.call(that, element, options);\n\n            element = that.wrapper = that.element;\n            options = that.options;\n\n            that.options.disableDates = calendar.disabled(that.options.disableDates);\n\n            culture = kendo.getCulture(options.culture);\n            options.format = kendo._extractFormat(options.format || culture.calendars.standard.patterns.d);\n\n            that._templates();\n\n            that._header();\n\n            that._wrapper();\n\n            id = element\n                .addClass(\"k-widget k-calendar k-calendar-range\" + (options.weekNumber ? \" k-week-number\" : \"\"))\n                .on(KEYDOWN + ns, \"table.k-content\", that._move.bind(that))\n                .on(BLUR + ns, \"table\", that._blur.bind(that))\n                .on(CLICK + ns, CELLSELECTORVALID, function(e) {\n                    var link = e.currentTarget.firstChild;\n\n                    if (link.href.indexOf(\"#\") != -1) {\n                        e.preventDefault();\n                    }\n\n                    that._click($(link));\n                })\n                .on(MOUSEENTER + ns, CELLSELECTORVALID, that._mouseEnter.bind(that))\n                .on(MOUSELEAVE_NS, CELLSELECTORVALID, function() {\n                    $(this).removeClass(HOVER);\n                })\n                .attr(ID);\n\n            if (id) {\n                that._cellID = id + \"_cell_selected\";\n            }\n\n            that._calendarWidth = that.element.width();\n\n            that._range = options.range;\n\n            that._initViews({ viewName: options.start, value: options.value });\n            that._selectable();\n\n            that._footer(that.footer);\n            that._selectDates = [];\n            that.value(options.value);\n\n            if (options.selectable == \"multiple\") {\n                that._selectDates = options.selectDates.length ? options.selectDates : that._selectDates;\n                that._restoreSelection();\n            }\n\n            if (options.selectable == \"range\") {\n                that.selectRange(that._range);\n            }\n\n            kendo.notify(that);\n        },\n\n        options: {\n            name: \"MultiViewCalendar\",\n            value: null,\n            min: new DATE(1900, 0, 1),\n            max: new DATE(2099, 11, 31),\n            dates: [],\n            disableDates: null,\n            culture: \"\",\n            footer: \"\",\n            format: \"\",\n            month: {},\n            range: { start: null, end: null },\n            weekNumber: false,\n            views: 2,\n            showViewHeader: false,\n            selectable: \"single\",\n            selectDates: [],\n            start: MONTH,\n            depth: MONTH,\n            messages: {\n                weekColumnHeader: \"\"\n            }\n        },\n\n        events: [\n            CHANGE,\n            NAVIGATE\n        ],\n\n        setOptions: function(options) {\n            var that = this;\n\n            calendar.normalize(options);\n\n            options.disableDates = calendar.disabled(options.disableDates);\n\n            Widget.fn.setOptions.call(that, options);\n\n            that._selectable();\n\n            that._templates();\n\n            that._footer(that.footer);\n\n            for (var i = 0; i < that._views.length; i++) {\n                that._views[i].off(ns).remove();\n            }\n\n            that._initViews({ viewName: options.start, value: options.value });\n\n            that._range = options.range || { start: null, end: null };\n\n            that._restoreSelection();\n        },\n\n        destroy: function() {\n            var that = this;\n\n            that._cell = null;\n            that._currentView = null;\n            that._current = null;\n\n            if (that._views) {\n                for (var i = 0; i < that._views.length; i++) {\n                    that._views[i].off(ns).remove();\n                }\n            }\n\n            that.element.off(ns);\n\n            if (that.header) {\n                that.header.off(ns);\n                that._title = null;\n                that.header = null;\n            }\n\n            if (that.selectable) {\n                that.selectable.destroy();\n                that.selectable = null;\n            }\n\n            if (that.rangeSelectable) {\n                that.rangeSelectable.destroy();\n                that.rangeSelectable = null;\n            }\n\n            if (that._today) {\n                kendo.destroy(that._today.off(ns));\n            }\n\n            that._views = null;\n\n            Widget.fn.destroy.call(that);\n        },\n\n        current: function() {\n            return this._current;\n        },\n\n        focus: function() {\n            var table;\n\n            if (this._cell) {\n                this._cell.closest(\"table\").trigger(\"focus\");\n            } else if (this._current && this._dateInViews(this._current)) {\n                this._cell = this._cellByDate(this._current);\n                this._cell.closest(\"table\").trigger(\"focus\");\n            } else {\n                table = this.element.find(\"table\").first().trigger(\"focus\");\n                this._cell = table.find(CELLSELECTORVALID).first();\n                this._current = toDateObject(this._cell.find(\"a\"));\n            }\n            this._cell.addClass(FOCUSED);\n        },\n\n        min: function(value) {\n            return this._option(MIN, value);\n        },\n\n        max: function(value) {\n            return this._option(\"max\", value);\n        },\n\n        view: function() {\n            return this._currentView;\n        },\n\n        navigateToPast: function() {\n            this._navigate(PREVARROW, -1);\n        },\n\n        navigateToFuture: function() {\n            this._navigate(NEXTARROW, 1);\n        },\n\n        navigateUp: function() {\n            var that = this,\n            index = that._index;\n\n            if (that._title.hasClass(DISABLED)) {\n                return;\n            }\n\n            that.navigate(that._current, ++index);\n        },\n\n        navigateDown: function(value) {\n            var that = this,\n            index = that._index,\n            depth = that.options.depth;\n\n            if (!value) {\n                return;\n            }\n\n            if (index === views[depth]) {\n                if (!isEqualDate(that._value, that._current) || !isEqualDate(that._value, value)) {\n                    that.value(value);\n                    that.trigger(CHANGE);\n                }\n                return;\n            }\n\n            that.navigate(value, --index);\n        },\n\n        navigate: function(value, view) {\n            view = isNaN(view) ? calendar.views[calendar.viewsEnum[view]] : calendar.views[view];\n\n            var that = this;\n            var options = that.options;\n            var min = options.min;\n            var max = options.max;\n\n            if (!value) {\n                that._current = value = new DATE(+calendar.restrictValue(value, min, max));\n            } else {\n                that._current = value;\n            }\n\n            if (view === undefined) {\n                view = that._currentView;\n            }\n\n            that._currentView = view;\n\n            for (var i = 0; i < that._views.length; i++) {\n                that._views[i].off(ns).remove();\n            }\n\n            that._initViews({ viewName: view.name, value: value });\n\n            that._restoreSelection();\n        },\n\n        _updateHeader: function() {\n            var that = this;\n            var view = that._currentView;\n            var title = that._title;\n            var value = that._firstViewValue;\n            var options = that.options;\n            var visibleRange = that._visibleRange();\n            var culture = options.culture;\n            var min = options.min;\n            var max = options.max;\n            var lastDate;\n            var disabled;\n            var prevDisabled;\n            var nextDisabled;\n\n\n            if (view.name === DECADE || view.name === CENTURY) {\n                lastDate = shiftDate(value, view.name, options.views - 1);\n                if (!isInRange(lastDate, min, max)) {\n                    lastDate = max;\n                }\n\n                title.html(view.first(value).getFullYear() + \" - \" + view.last(lastDate).getFullYear());\n            } else {\n                title.html(view.title(value, min, max, culture) + \" - \" + view.title(shiftDate(value, view.name, options.views - 1), min, max, culture));\n            }\n\n            disabled = view.name === CENTURY;\n            title.toggleClass(DISABLED, disabled).attr(ARIA_DISABLED, disabled);\n\n            prevDisabled = view.compare(visibleRange.start, that.options.min) < 1;\n            nextDisabled = view.compare(visibleRange.end, that.options.max) > -1;\n\n            if (prevDisabled && nextDisabled) {\n                if (that._navContainer) {\n                    that._navContainer.remove();\n                    that._navContainer = null;\n                }\n            } else {\n                if (!that._navContainer) {\n                    that._navContainer = $('<span class=\"k-calendar-nav k-hstack\">' +\n                    '<a href=\"#\" role=\"button\" class=\"k-button k-button-md k-rounded-md k-button-flat k-button-flat-base k-icon-button k-prev-view\" ' + ARIA_LABEL + '=\"Previous\"><span class=\"k-button-icon k-icon k-i-arrow-60-left\"></span></a>' +\n                    '<a href=\"#\" role=\"button\" class=\"k-button k-button-md k-rounded-md k-button-flat k-button-flat-base k-icon-button k-next-view\" ' + ARIA_LABEL + '=\"Next\"><span class=\"k-button-icon k-icon k-i-arrow-60-right\"></span></a>' +\n                    '</span>').appendTo(that.header);\n                    that[PREVARROW] = that._navContainer.find(\".k-prev-view\");\n                    that[NEXTARROW] = that._navContainer.find(\".k-next-view\");\n                }\n\n                that[PREVARROW].toggleClass(DISABLED, prevDisabled).attr(ARIA_DISABLED, prevDisabled);\n                if (that[PREVARROW].hasClass(DISABLED)) {\n                    that[PREVARROW].removeClass(HOVER);\n                }\n\n                that[NEXTARROW].toggleClass(DISABLED, nextDisabled).attr(ARIA_DISABLED, nextDisabled);\n                if (that[NEXTARROW].hasClass(DISABLED)) {\n                    that[NEXTARROW].removeClass(HOVER);\n                }\n            }\n        },\n\n        _mouseEnter: function(e) {\n            var that = this;\n            var cell = $(e.currentTarget);\n            var range;\n            var items;\n            var startIdx;\n            var endIdx;\n\n            cell.addClass(HOVER);\n\n            if (that.rangeSelectable && that._currentView.name === \"month\") {\n                range = that.selectRange();\n                if (range.start && !range.end) {\n                    if (that._dateInViews(that.selectRange().start)) {\n                        items = that.element.find(that.rangeSelectable.options.filter);\n                        startIdx = $.inArray($(that.rangeSelectable._start)[0], items);\n                        endIdx = $.inArray($(cell)[0], items);\n                        if (startIdx > endIdx) {\n                            return;\n                        }\n                        that.rangeSelectable.range(that.rangeSelectable._start, cell);\n                    } else if (+toDateObject(that.element.find(CELLSELECTOR).first().find(\"a\")) > +range.start) {\n                        that.rangeSelectable.selectTo(cell);\n                    }\n                    that.rangeSelectable._end = null;\n                }\n            }\n        },\n\n        _move: function(e, preventFocus) {\n            var that = this;\n            var options = that.options;\n            var key = e.keyCode;\n            var index = that._index;\n            var min = options.min;\n            var max = options.max;\n            var focusedCell = that.element.find(DOT + FOCUSED);\n            var table = focusedCell.closest(\"table\");\n            var currentValue = new DATE(+(that._current || toDateObject(focusedCell.find(\"a\"))));\n            var isRtl = kendo.support.isRtl(that.wrapper);\n            var navigate = false;\n            var value, prevent, method, cell, lastActive, cellIndex;\n\n            if (key == keys.RIGHT && !isRtl || key == keys.LEFT && isRtl) {\n                value = 1;\n                prevent = true;\n            } else if (key == keys.LEFT && !isRtl || key == keys.RIGHT && isRtl) {\n                value = -1;\n                prevent = true;\n            } else if (key == keys.UP) {\n                value = index === 0 ? -7 : -4;\n                prevent = true;\n            } else if (key == keys.DOWN) {\n                value = index === 0 ? 7 : 4;\n                prevent = true;\n            }\n            else if (key == keys.SPACEBAR) {\n                value = 0;\n                prevent = true;\n            }\n            else if (key == keys.HOME) {\n                prevent = true;\n                cell = table.find(CELLSELECTORVALID).eq(0);\n                if (cell.hasClass(FOCUSED)) {\n                    table = table.prev();\n                    if (table.length) {\n                        that._focusCell(table.find(CELLSELECTORVALID).eq(0));\n                    } else {\n                        navigate = that[PREVARROW] && !that[PREVARROW].hasClass(DISABLED);\n                        that._navigate(PREVARROW, -1, preventFocus);\n                        that._focusCell(that.element.find(\"table\").first().find(CELLSELECTORVALID).first());\n                    }\n                } else {\n                    that._focusCell(cell);\n                }\n            } else if (key == keys.END) {\n                prevent = true;\n                cell = table.find(CELLSELECTORVALID).last();\n                if (cell.hasClass(FOCUSED)) {\n                    table = table.next();\n                    if (table.length) {\n                        that._focusCell(table.find(CELLSELECTORVALID).last());\n                    } else {\n                        navigate = that[NEXTARROW] && !that[NEXTARROW].hasClass(DISABLED);\n                        that._navigate(NEXTARROW, 1, preventFocus);\n                        that._focusCell(that.element.find(\"table\").last().find(CELLSELECTORVALID).last());\n                    }\n                } else {\n                    that._focusCell(cell);\n                }\n            }\n\n            if (e.ctrlKey || e.metaKey) {\n                if (key == keys.RIGHT && !isRtl || key == keys.LEFT && isRtl) {\n                    navigate = that[NEXTARROW] && !that[NEXTARROW].hasClass(DISABLED);\n                    that._navigate(NEXTARROW, 1, preventFocus);\n                    prevent = true;\n                } else if (key == keys.LEFT && !isRtl || key == keys.RIGHT && isRtl) {\n                    navigate = that[PREVARROW] && !that[PREVARROW].hasClass(DISABLED);\n                    that._navigate(PREVARROW, -1, preventFocus);\n                    prevent = true;\n                } else if (key == keys.UP) {\n                    navigate = !that._title.hasClass(DISABLED);\n                    that.navigateUp();\n                    that._focusCell(that._cellByDate(that._current), !preventFocus);\n                    prevent = true;\n                } else if (key == keys.DOWN) {\n                    if (that._currentView.name === \"month\") {\n                        that.value(currentValue);\n                    } else {\n                        that.navigateDown(currentValue);\n                        that._focusCell(that._cellByDate(that._current), !preventFocus);\n                        navigate = true;\n                    }\n                    prevent = true;\n                } else if ((key == keys.ENTER || key == keys.SPACEBAR)) {\n                    if (options.selectable === \"multiple\") {\n                        that._toggleSelection(e);\n                    }\n                }\n            } else if (e.shiftKey && options.selectable !== \"single\") {\n                if (value !== undefined || method) {\n                    if (!method) {\n                        that._currentView.setDate(currentValue, value);\n                    }\n\n                    if (that._currentView.name !== \"month\") {\n                        return;\n                    }\n\n                    if (options.disableDates(currentValue)) {\n                        currentValue = that._nextNavigatable(currentValue, value);\n                    }\n\n                    min = createDate(min.getFullYear(), min.getMonth(), min.getDate());\n\n                    if (isInRange(currentValue, min, max)) {\n                        if (!that._dateInViews(currentValue)) {\n                            if (value > 0) {\n                                navigate = that[NEXTARROW] && !that[NEXTARROW].hasClass(DISABLED);\n                                that._navigate(NEXTARROW, 1, preventFocus);\n                            } else {\n                                navigate = that[PREVARROW] && !that[PREVARROW].hasClass(DISABLED);\n                                that._navigate(PREVARROW, -1, preventFocus);\n                            }\n                        }\n                        cell = that._cellByDate(currentValue);\n                        that._current = currentValue;\n\n                        if (that.selectable) {\n                            that._selectRange(toDateObject((that.selectable._lastActive || focusedCell).find(\"a\")), currentValue);\n                            if (!that.selectable._lastActive) {\n                                that.selectable._lastActive = focusedCell;\n                            }\n                            that.trigger(CHANGE);\n                            that._focusCell(cell);\n                        }\n\n                        if (that.rangeSelectable) {\n                            lastActive = toDateObject((that.rangeSelectable._lastActive || focusedCell).find(\"a\"));\n                            if (!that._dateInViews(lastActive)) {\n                                if (+lastActive > +currentValue) {\n                                    that.rangeSelectable._end = that.rangeSelectable._lastActive;\n                                    that.rangeSelectable.selectFrom(cell);\n                                } else {\n                                    that.rangeSelectable.selectTo(cell);\n                                }\n                            } else {\n                                if (that.rangeSelectable._end && that.rangeSelectable._end.is(DOT + FOCUSED)) {\n                                    that.rangeSelectable._lastActive = that.rangeSelectable._start;\n                                } else {\n                                    that.rangeSelectable._lastActive = that._cellByDate(lastActive);\n                                }\n                                that.rangeSelectable.range(that.rangeSelectable._lastActive, cell);\n                            }\n                            that.rangeSelectable.change();\n                            that._focusCell(cell);\n                        }\n                    }\n                }\n            } else {\n                if (key == keys.ENTER || key == keys.SPACEBAR) {\n                    if (that._currentView.name === \"month\") {\n                        if (that.selectable) {\n                            that.selectable._lastActive = that._cellByDate(currentValue);\n                        }\n                        that.value(currentValue);\n                        if (that.rangeSelectable) {\n                            that.rangeSelectable.change();\n                        }\n                    } else {\n                        that._click($(that._cell[0].firstChild), preventFocus);\n                    }\n                    prevent = true;\n                } else if (key == keys.PAGEUP || key == keys.PAGEDOWN) {\n                    prevent = true;\n                    cellIndex = table.find(CELLSELECTORVALID).index(focusedCell);\n                    table = key == keys.PAGEUP ? table.prev() : table.next();\n                    if (!table.length) {\n                        if (key == keys.PAGEUP) {\n                            navigate = that[PREVARROW] && !that[PREVARROW].hasClass(DISABLED);\n                            that.navigateToPast();\n                            table = that.element.find(\"table\").first();\n                        } else {\n                            navigate = that[NEXTARROW] && !that[NEXTARROW].hasClass(DISABLED);\n                            that.navigateToFuture();\n                            table = that.element.find(\"table\").last();\n                        }\n                    }\n                    cell = table.find(CELLSELECTORVALID).eq(cellIndex);\n                    if (cell.length) {\n                        that._focusCell(cell);\n                    } else {\n                        that._focusCell(table.find(CELLSELECTORVALID).last());\n                    }\n                }\n\n                if (value || method) {\n                    if (!method) {\n                        that._currentView.setDate(currentValue, value);\n                    }\n\n                    min = createDate(min.getFullYear(), min.getMonth(), min.getDate());\n\n                    if (isInRange(currentValue, min, max)) {\n                        if (that.selectable && options.disableDates(currentValue)) {\n                            currentValue = that._nextNavigatable(currentValue, value);\n                        }\n                        if (!that._dateInViews(currentValue)) {\n                            if (value > 0) {\n                                navigate = that[NEXTARROW] && !that[NEXTARROW].hasClass(DISABLED);\n                                that._navigate(NEXTARROW, 1, preventFocus);\n                            } else {\n                                navigate = that[PREVARROW] && !that[PREVARROW].hasClass(DISABLED);\n                                that._navigate(NEXTARROW, -1, preventFocus);\n                            }\n                        }\n                        cell = that._cellByDate(currentValue);\n                        that._current = currentValue;\n                        that._focusCell(cell, !preventFocus);\n                    }\n                }\n            }\n\n            if (navigate) {\n                that.trigger(NAVIGATE);\n            }\n\n            if (prevent) {\n                e.preventDefault();\n            }\n\n            return that._current;\n\n        },\n\n        _visualizeSelectedDatesInView: function() {\n            var that = this;\n            var selectedDates = {};\n            var cells;\n\n            $.each(that._selectDates, function(index, value) {\n                selectedDates[kendo.calendar.views[0].toDateString(value)] = value;\n            });\n            that.selectable.clear();\n            cells = that.element.find(\"table\")\n                .find(CELLSELECTOR)\n                .filter(function(index, element) {\n                    return selectedDates[$(element.firstChild).attr(kendo.attr(VALUE))];\n                });\n\n            if (cells.length > 0) {\n                that.selectable._selectElement(cells, true);\n            }\n        },\n\n        _nextNavigatable: function(currentValue, value) {\n            var that = this;\n            var disabled = true;\n            var view = that._currentView;\n            var min = that.options.min;\n            var max = that.options.max;\n            var isDisabled = that.options.disableDates;\n            var navigatableDate = new Date(currentValue.getTime());\n\n            view.setDate(navigatableDate, -value);\n            while (disabled) {\n                view.setDate(currentValue, value);\n                 if (!isInRange(currentValue, min, max)) {\n                    currentValue = navigatableDate;\n                    break;\n                }\n                disabled = isDisabled(currentValue);\n            }\n            return currentValue;\n        },\n\n        _toggleSelection: function(event) {\n            var that = this;\n\n            that.selectable._lastActive = $(that._cell[0]);\n\n            if ($(that._cell[0]).hasClass(SELECTED)) {\n                that.selectable._unselect($(that._cell[0]));\n                that.selectable.trigger(CHANGE, { event: event });\n            }\n            else {\n                that.selectable.value($(that._cell[0]), { event: event });\n            }\n        },\n\n        _option: function(option, value) {\n            var that = this;\n            var options = that.options;\n            var currentValue = that._value || that._current;\n            var isBigger;\n\n            if (value === undefined) {\n                return options[option];\n            }\n\n            value = kendo.parseDate(value, options.format, options.culture);\n\n            if (!value) {\n                return;\n            }\n\n            options[option] = new DATE(+value);\n\n            if (option === MIN) {\n                isBigger = value > currentValue;\n            } else {\n                isBigger = currentValue > value;\n            }\n\n            if (isBigger) {\n                that._value = null;\n            }\n\n            that.navigate(that._value);\n\n            that._toggle();\n        },\n\n        _cellByDate: function(value) {\n            if (value instanceof Date) {\n                value = this._currentView.toDateString(value);\n            }\n            return this.element.find(\"table\").find(\"td:not(.\" + OTHERMONTH + \")\")\n            .filter(function() {\n                return $(this.firstChild).attr(kendo.attr(VALUE)) === value;\n            });\n        },\n\n        _selectable: function() {\n            var that = this;\n            var selectable = that.options.selectable;\n\n            if (that.selectable) {\n                that.selectable.destroy();\n                that.selectable = null;\n            }\n\n            if (that.rangeSelectable) {\n                that.rangeSelectable.destroy();\n                that.rangeSelectable = null;\n            }\n\n            if (selectable.toLowerCase() === \"range\") {\n                that.rangeSelectable = new RangeSelectable(that.wrapper, {\n                    calendar: that,\n                    filter: \"table.k-month \" + CELLSELECTORVALID,\n                    change: that._rangeSelection.bind(that)\n                });\n            } else {\n                that.selectable = new Selectable(that.wrapper, {\n                    aria: true,\n                    dragToSelect: false,\n                    inputSelectors: \"input,textarea,.k-multiselect-wrap,select,button,.k-button>span,.k-button>img,span.k-icon.k-i-arrow-60-down,span.k-icon.k-i-arrow-60-up\",\n                    multiple: Selectable.parseOptions(selectable).multiple,\n                    filter: \"table.k-content \" + CELLSELECTORVALID,\n                    change: that._selection.bind(that),\n                    relatedTarget: that._onRelatedTarget.bind(that),\n                    unselect: that._unselecting.bind(that)\n                });\n            }\n        },\n\n        _onRelatedTarget: function(target) {\n            var that = this;\n\n            if (that.selectable.options.multiple && target.is(CELLSELECTORVALID) && target.length > 1) {\n                that._focusCell(target.first(), true);\n            }\n        },\n\n        _getFirstViewDate: function(currentView) {\n            var that = this;\n            var options = that.options;\n            var ranges = [];\n            var start;\n            var end;\n            var current = new Date(+that._current);\n            var i;\n\n            for (i = 0; i < options.views; i++) {\n                start = currentView.first(current);\n                end = currentView.last(current);\n\n                if (+end > +options.max) {\n                    if (+start <= +options.max) {\n                        ranges.push({ start: start, end: new Date(+options.max) });\n                    }\n                    break;\n                }\n\n                ranges.push({ start: start, end: end });\n\n                current = new Date(+shiftDate(end, currentView.name, 1));\n            }\n\n            current = new Date(+that._current);\n\n            for (i = 0; i < options.views; i++) {\n                start = currentView.first(current);\n                end = currentView.last(current);\n\n                if (+start < +options.min) {\n                    if (+end >= +options.min) {\n                        ranges.push({ start: new Date(+options.min), end: end });\n                    }\n                    break;\n                }\n\n                ranges.push({ start: start, end: end });\n\n                current = new Date(+shiftDate(start, currentView.name, -1));\n            }\n\n            start = ranges[0].start;\n\n            for (i = 0; i < options.views + 1; i++) {\n                if (!ranges[i]) {\n                    break;\n                }\n\n                if (+start > +ranges[i].start) {\n                    start = ranges[i].start;\n                }\n            }\n\n            return new Date(+start);\n        },\n\n        _canRenderNextView: function(viewDate) {\n            var fullYear = viewDate.getFullYear();\n            var month = viewDate.getMonth();\n            var date = viewDate.getDate();\n            var max = this.options.max;\n            var maxYear = max.getFullYear();\n            var maxMonth = max.getMonth();\n\n\n            if (fullYear < maxYear) {\n                return true;\n            }\n\n            if (fullYear === maxYear && month < maxMonth) {\n                return true;\n            }\n\n            if (fullYear === maxYear && month === maxMonth && date < max.getDate()) {\n                return true;\n            }\n\n            if (fullYear === maxYear && month === maxMonth && date === max.getDate()) {\n                return true;\n            }\n\n            return false;\n        },\n\n        _initViews: function(viewOptions) {\n            var that = this;\n            var options = that.options;\n            var index = calendar.viewsEnum[viewOptions.viewName];\n            var currentView = calendar.views[index];\n            var viewDate;\n\n            that._current = new DATE(+calendar.restrictValue(viewOptions.value, options.min, options.max));\n            that._views = [];\n            that._index = index;\n            viewDate = that._getFirstViewDate(currentView);\n            viewDate.setDate(1);\n\n            that._firstViewValue = new Date(+viewDate);\n\n            for (var i = 0; i < options.views; i++) {\n                viewDate = i ? shiftDate(viewDate, currentView.name, 1) : viewDate;\n                viewDate.setDate(1);\n\n                if (!that._canRenderNextView(viewDate)) {\n                    break;\n                }\n\n                that._table = $(currentView.content($.extend({\n                    min: options.min,\n                    max: options.max,\n                    date: viewDate,\n                    url: options.url,\n                    dates: options.dates,\n                    format: options.format,\n                    culture: options.culture,\n                    disableDates: options.disableDates,\n                    showHeader: options.showViewHeader,\n                    isWeekColumnVisible: options.weekNumber,\n                    otherMonth: options.otherMonth,\n                    messages: options.messages,\n                    contentClasses: \"k-content\"\n                }, that[currentView.name])));\n\n                that._table.appendTo(that.tablesWrapper).addClass(\"k-\" + currentView.name);\n                that._views.push(that._table);\n            }\n\n            // that.wrapper.width(visibleViews * that._calendarWidth);\n\n            that._currentView = currentView;\n\n            that.tablesWrapper.attr(\"class\", \"k-calendar-view k-calendar-\" + currentView.name + \"view k-hstack k-align-items-start k-justify-content-center\");\n\n            that._updateHeader();\n        },\n\n        _rangeSelection: function(e) {\n            var that = this;\n            var range = e.sender.range();\n            var useEnd = e.sender._useEnd;\n            var useStart = e.sender._useStart;\n            var initialRange = that.selectRange() || {};\n            var start;\n            var end;\n\n            if (range.start) {\n                start = toDateObject(range.start.find(\"a\"));\n            }\n\n            if (range.end) {\n                end = toDateObject(range.end.find(\"a\"));\n            }\n\n            that._range = { start: useStart ? initialRange.start : start, end: useEnd ? initialRange.end : end };\n\n            if (!that._preventChange) {\n                that.trigger(CHANGE);\n            }\n        },\n\n        _selection: function(e) {\n            var that = this;\n            var selectElements = e.sender.value();\n            var domEvent = e.event;\n            var currentTarget = $(domEvent && domEvent.currentTarget);\n            var isCell = currentTarget.is(\"td\");\n            var currentValue;\n\n            if (that.options.selectable === \"single\") {\n                that._validateValue(selectElements[0] ? toDateObject(selectElements.first().find(\"a\")) : e.sender._lastActive ? toDateObject(e.sender._lastActive.find(\"a\")) : that.value());\n            }\n\n            if (that.options.selectable == \"multiple\") {\n\n                if (isCell) {\n                    currentValue = toDateObject(currentTarget.find(\"a\"));\n                }\n\n                if (domEvent && domEvent.ctrlKey) {\n                    if (isCell) {\n                        if (currentTarget.hasClass(SELECTED)) {\n                            that._selectDates.push(currentValue);\n                        } else {\n                            that._deselect(currentValue);\n                        }\n                    } else {\n                        that.element.find(\"table \" + CELLSELECTORVALID).each(function(index, element) {\n                            var value = toDateObject($(element).find(\"a\"));\n                            that._deselect(value);\n                        });\n                        that._addSelectedCellsToArray();\n                    }\n                } else if (domEvent && domEvent.shiftKey) {\n                    that._selectRange(toDateObject(e.sender._lastActive ? e.sender._lastActive.find(\"a\") : selectElements.first().find(\"a\")), currentValue);\n                } else if (isCell) {\n                    that._selectDates = [];\n                    that._selectDates.push(currentValue);\n                } else {\n                    that._selectDates = [];\n                    that._addSelectedCellsToArray();\n                }\n            }\n\n            if (!that._preventChange) {\n                that.trigger(CHANGE);\n            }\n        },\n\n        _addSelectedCellsToArray: function() {\n            var that = this;\n            that.selectable.value().each(function(index, item) {\n                var date = toDateObject($(item.firstChild));\n                if (!that.options.disableDates(date)) {\n                    that._selectDates.push(date);\n                }\n            });\n        },\n\n        _deselect: function(date) {\n            var that = this;\n            var currentDateIndex = that._selectDates.map(Number).indexOf(+date);\n             if (currentDateIndex != -1) {\n                that._selectDates.splice(currentDateIndex, 1);\n            }\n        },\n\n        _unselecting: function(e) {\n            var that = this;\n            var element = e.element;\n\n            if (that.options.selectable === \"single\" && !mobileOS && element.hasClass(FOCUSED)) {\n                e.preventDefault();\n            }\n        },\n\n        _visibleRange: function() {\n            var tables = this.element.find(\".k-calendar-view table\");\n            var firstDateInView = toDateObject(tables.first().find(CELLSELECTOR).first().find(\"a\"));\n            var lastDateInView = toDateObject(tables.last().find(CELLSELECTOR).last().find(\"a\"));\n            return { start: firstDateInView, end: lastDateInView };\n        },\n\n        _dateInViews: function(date) {\n            var that = this;\n            var tables = that.element.find(\".k-calendar-view table\");\n            var firstDateInView = toDateObject(tables.first().find(CELLSELECTOR).first().find(\"a\"));\n            var lastDateInView = toDateObject(tables.last().find(CELLSELECTOR).last().find(\"a\"));\n\n            date = new Date(date.toDateString());\n\n            return +date <= +lastDateInView && +date >= +firstDateInView;\n        },\n\n        _fillRange: function(start, end) {\n            var that = this;\n            var daysDifference;\n\n            that._selectDates = [];\n            daysDifference = daysBetweenTwoDates(start, end);\n            addDaysToArray(that._selectDates, daysDifference, start, that.options.disableDates);\n        },\n\n        _selectRange: function(start, end) {\n            var that = this;\n            var current;\n\n            if (+end < +start) {\n                current = end;\n                end = start;\n                start = current;\n            }\n\n            that._fillRange(start, end);\n            that._visualizeSelectedDatesInView();\n        },\n\n        _header: function() {\n            var that = this;\n            var element = that.element;\n            var buttons;\n            var header = element.find(\".k-calendar-header\");\n\n            if (!header.length) {\n                header = $('<div class=\"k-calendar-header k-hstack\">' +\n                    '<a href=\"#\" role=\"button\" class=\"k-calendar-title k-title k-button k-button-md k-rounded-md k-button-flat k-button-flat-base\" aria-live=\"assertive\" aria-atomic=\"true\"></a>' +\n                    '<span class=\"k-spacer\"></span>' +\n                    '<span class=\"k-calendar-nav k-hstack\">' +\n                        '<a href=\"#\" role=\"button\" class=\"k-button k-button-md k-rounded-md k-button-flat k-button-flat-base k-icon-button k-prev-view\" ' + ARIA_LABEL + '=\"Previous\"><span class=\"k-button-icon k-icon k-i-arrow-60-left\"></span></a>' +\n                        '<a href=\"#\" role=\"button\" class=\"k-button k-button-md k-rounded-md k-button-flat k-button-flat-base k-icon-button k-next-view\" ' + ARIA_LABEL + '=\"Next\"><span class=\"k-button-icon k-icon k-i-arrow-60-right\"></span></a>' +\n                    '</span>' +\n                '</div>').prependTo(element);\n            }\n\n            that.header = header;\n\n            header.on(MOUSEENTER + ns + \" \" + MOUSELEAVE_NS + \" \" + FOCUS + ns + \" \" + BLUR + ns, \".k-button\", mousetoggle).on(\"click\", function() { return false; })\n                .on(CLICK + ns, \".k-button.k-calendar-title\", function() { that.navigateUp(); that._focusCell(that._cellByDate(that._current), true); that.trigger(NAVIGATE); })\n                .on(CLICK + ns, \".k-button.k-prev-view\", function(e) { e.preventDefault(); that.navigateToPast(); that.trigger(NAVIGATE); })\n                .on(CLICK + ns, \".k-button.k-next-view\", function(e) { e.preventDefault(); that.navigateToFuture(); that.trigger(NAVIGATE); });\n\n            buttons = header.find(\".k-button\");\n\n            that._title = buttons.filter(\".k-calendar-title\");\n            that._navContainer = header.find(\".k-calendar-nav\");\n            that[PREVARROW] = buttons.filter(\".k-prev-view\");\n            that[NEXTARROW] = buttons.filter(\".k-next-view\");\n        },\n\n        _wrapper: function() {\n            this.tablesWrapper = $('<div class=\"k-calendar-view\" />').insertAfter(this.element[0].firstChild);\n        },\n\n        _templates: function() {\n            var that = this;\n            var options = that.options;\n            var month = options.month;\n            var content = month.content;\n            var weekNumber = month.weekNumber;\n            var empty = month.empty;\n\n            that.month = {\n                content: template('<td class=\"#=data.cssClass#\" role=\"gridcell\"><a tabindex=\"-1\" class=\"k-link#=data.linkClass#\" href=\"#=data.url#\" ' + kendo.attr(VALUE) + '=\"#=data.dateString#\" title=\"#=data.title#\">' + (content || \"#=data.value#\") + '</a></td>', { useWithBlock: !!content }),\n                empty: template('<td role=\"gridcell\"' + (empty ? '>' : ' class=\"k-calendar-td k-out-of-range\">') + (empty || \"<a class='k-link'></a>\") + \"</td>\", { useWithBlock: !!empty }),\n                weekNumber: template('<td class=\"k-calenar-td k-alt\">' + (weekNumber || \"#= data.weekNumber #\") + \"</td>\", { useWithBlock: !!weekNumber })\n            };\n        },\n\n        _footer: function() {\n            var that = this;\n            var options = that.options;\n            var template = options.footer !== false ? kendo.template(that.options.footer || '#= kendo.toString(data,\"D\",\"' + options.culture + '\") #', { useWithBlock: false }) : null;\n            var today = getToday();\n            var element = that.element;\n            var footer = element.find(\".k-footer\");\n\n            if (!template) {\n                that._toggle(false);\n                footer.hide();\n                return;\n            }\n\n            if (!footer[0]) {\n                footer = $('<div class=\"k-footer\"><a href=\"#\" class=\"k-link k-nav-today\"></a></div>').appendTo(element);\n            }\n\n            that._today = footer.show()\n                .find(\".k-link\")\n                .html(template(today))\n                .attr(\"title\", kendo.toString(today, \"D\", that.options.culture));\n\n            that._toggle();\n        },\n\n        _navigate: function(arrow, modifier, preventFocus) {\n            var that = this;\n            var index = that._index + 1;\n            var currentValue = new DATE(+that._current);\n            var originaValue = new DATE(+that._current);\n            var offset;\n\n            arrow = that[arrow];\n\n            offset = that._cellByDate(currentValue).closest(\"table\").index();\n\n            if (modifier > 0) {\n                offset = 1 - offset;\n            } else {\n                offset = offset + 1;\n            }\n\n            if (!arrow || !arrow.hasClass(DISABLED)) {\n                if (index > 3) {\n                    currentValue.setFullYear(currentValue.getFullYear() + 100 * (modifier * offset));\n                } else {\n                    calendar.views[index].setDate(currentValue, (modifier * offset));\n                }\n\n                that.navigate(currentValue);\n\n                if (that._dateInViews(originaValue)) {\n                    that._focusCell(that._cellByDate(originaValue), !preventFocus);\n                    that._current = originaValue;\n                } else {\n                    if (index > 3) {\n                        originaValue.setFullYear(originaValue.getFullYear() + 100 * modifier);\n                    } else {\n                        calendar.views[index].setDate(originaValue, modifier);\n                    }\n                    that._focusCell(that._cellByDate(originaValue), !preventFocus);\n                    that._current = originaValue;\n                }\n            }\n        },\n\n        _toggle: function(toggle) {\n            var that = this;\n            var options = that.options;\n            var isTodayDisabled = options.selectable !== \"range\" && that.options.disableDates(getToday());\n            var link = that._today;\n\n            if (toggle === undefined) {\n                toggle = isInRange(getToday(), options.min, options.max);\n            }\n\n            if (link) {\n                link.off(CLICK + ns);\n\n                if (toggle && !isTodayDisabled) {\n                    link.addClass(TODAY)\n                    .removeClass(DISABLED)\n                    .on(CLICK + ns, that._todayClick.bind(that));\n                } else {\n                    link.removeClass(TODAY)\n                    .addClass(DISABLED)\n                    .on(CLICK + ns, function prevent(e) {\n                        e.preventDefault();\n                    });\n                }\n            }\n        },\n\n        _click: function(link, preventFocus) {\n            var that = this;\n            var options = that.options;\n            var currentValue = new Date(+that._current);\n            var value = toDateObject(link);\n\n            kendo.date.adjustDST(value, 0);\n\n            that._currentView.setDate(currentValue, value);\n            that._current = value;\n\n            if (that._currentView.name !== options.depth) {\n                that.navigateDown(calendar.restrictValue(currentValue, options.min, options.max));\n                that._focusCell(that._cellByDate(that._current), !preventFocus);\n                that.trigger(NAVIGATE);\n            } else {\n                that._focusCell(link.closest(\"td\"), !preventFocus);\n            }\n        },\n\n        _blur: function() {\n            var that = this;\n\n            if (that._cell) {\n                that._cell.removeClass(FOCUSED);\n            }\n        },\n\n        _focus: function(e) {\n            var that = this;\n            var table = $(e.currentTarget);\n            var cell = that._cell;\n\n            if (!cell || !$.contains(table[0], cell[0])) {\n                cell = table.find(CELLSELECTORVALID).first();\n            }\n\n            that._focusCell(cell);\n        },\n\n        _focusCell: function(cell, focusTable) {\n            var that = this;\n            var cellId = that._cellID;\n            var table = cell.closest(\"table\");\n\n            if (that._cell && that._cell.length) {\n                that._cell[0].removeAttribute(ARIA_SELECTED);\n                that._cell[0].removeAttribute(ARIA_LABEL);\n                that._cell.removeClass(FOCUSED);\n                that._cell[0].removeAttribute(ID);\n                that._cell.closest(\"table\")[0].removeAttribute(\"aria-activedescendant\");\n            }\n\n            that._cell = cell;\n\n            if (focusTable) {\n                table.trigger(\"focus\");\n            }\n\n            if (cellId) {\n                cell.attr(ID, cellId);\n                table.attr(\"aria-activedescendant\", cellId);\n            }\n\n            cell.attr(ARIA_SELECTED, true).addClass(FOCUSED);\n\n            if (cell.length && that._currentView.name == \"month\") {\n                that._current = toDateObject(cell.find(\"a\"));\n            }\n        },\n\n        _todayClick: function(e) {\n            var that = this;\n            var disabled = that.options.disableDates;\n            var today = getToday();\n            var navigate = false;\n\n            e.preventDefault();\n\n            if (disabled(today)) {\n                return;\n            }\n\n            that._value = today;\n\n            if (that.options.selectable === \"multiple\") {\n                that._selectDates = [today];\n            }\n\n            if (that.options.selectable === \"range\") {\n                that.rangeSelectable.clear(true);\n                that._range = { start: today, end: null };\n            }\n\n            if (that._currentView.name != \"month\" || !that._dateInViews(today)) {\n                navigate = true;\n            }\n\n            that.navigate(today, that.options.depth);\n\n            if (that.options.selectable === \"single\") {\n                that.selectable._lastActive = null;\n            }\n\n            if (navigate) {\n                that.trigger(NAVIGATE);\n            }\n\n            that.trigger(CHANGE);\n        },\n\n        _validateValue: function(value) {\n            var that = this;\n            var options = that.options;\n            var min = options.min;\n            var max = options.max;\n\n            value = kendo.parseDate(value, options.format, options.culture);\n\n            if (value !== null) {\n                value = new DATE(+value);\n\n                if (!isInRange(value, min, max)) {\n                    value = null;\n                }\n            }\n\n            if (value === null || !that.options.disableDates(new Date(+value))) {\n                that._value = value;\n            } else if (that._value === undefined) {\n                that._value = null;\n            }\n\n            return that._value;\n        },\n\n        _updateAria: function(ariaTemplate, date) {\n            var that = this;\n            var cell = that._cellByDate(date || that.current());\n            var valueType = that.view().valueType();\n            var current = date || that.current();\n            var text;\n\n            that._focusCell(cell);\n\n            if (valueType === \"month\") {\n                text = kendo.toString(current, \"MMMM\");\n            } else if (valueType === \"date\") {\n                text = kendo.toString(current, \"D\");\n            } else {\n                text = cell.text();\n            }\n\n            cell.attr(\"aria-label\", ariaTemplate({ current: current, valueType: valueType, text: text }));\n            return cell.attr(\"id\");\n        },\n\n        clearSelection: function() {\n            var that = this;\n\n            if (that.selectable) {\n                that.element.find(DOT + SELECTED).removeClass(SELECTED);\n            }\n\n            if (that.rangeSelectable) {\n                that.rangeSelectable.clear(true);\n            }\n        },\n\n        _restoreSelection: function() {\n            var that = this;\n            var range;\n            var selectable = that.options.selectable;\n\n            if (that._currentView.name !== that.options.depth) {\n                return;\n            }\n\n            that._preventChange = true;\n\n            if (selectable === \"range\") {\n                range = that.selectRange();\n\n                if (!range || !range.start) {\n                    that._preventChange = false;\n                    return;\n                }\n\n                that.selectRange(range);\n            }\n\n            if (selectable === \"single\" && that.value()) {\n                that.selectable.value(that._cellByDate(that.value()));\n            }\n\n            if (selectable === \"multiple\") {\n                that._visualizeSelectedDatesInView();\n            }\n\n            that._preventChange = false;\n        },\n\n        value: function(value) {\n            var that = this;\n            var cell;\n\n            if (value === undefined) {\n                return that._value;\n            }\n\n            value = that._validateValue(value);\n\n            that.clearSelection();\n\n            if (value && !that._dateInViews(value)) {\n                that.navigate(value);\n            }\n\n            if (value !== null && that._currentView.name === MONTH) {\n                cell = that._cellByDate(value);\n\n                if (that.selectable) {\n                    that.selectable.value(cell);\n                }\n\n                if (that.rangeSelectable) {\n                    that.rangeSelectable.start(cell);\n                    that.rangeSelectable._lastActive = cell;\n                }\n            }\n        },\n\n        selectDates: function(dates) {\n            var that = this;\n            var validSelectedDates;\n            var datesUnique;\n\n            if (dates === undefined) {\n                return that._selectDates;\n            }\n\n            datesUnique = dates\n                .map(function(date) { return date.getTime(); })\n                .filter(function(date, position, array) {\n                    return array.indexOf(date) === position;\n                })\n                .map(function(time) { return new Date(time); });\n\n            validSelectedDates = $.grep(datesUnique, function(value) {\n                if (value) {\n                    return +that._validateValue(new Date(value.setHours(0, 0, 0, 0))) === +value;\n                }\n            });\n            that._selectDates = validSelectedDates.length > 0 ? validSelectedDates : (datesUnique.length === 0 ? datesUnique : that._selectDates);\n            that._visualizeSelectedDatesInView();\n        },\n\n        selectRange: function(range) {\n            var that = this;\n            var startInRange;\n            var endInRange;\n            var visibleRange;\n\n            if (range === undefined) {\n                return that._range;\n            }\n\n            that._range = range;\n\n            if (!range.start) {\n                return;\n            }\n\n            visibleRange = that._visibleRange();\n\n            startInRange = that._dateInViews(range.start);\n            endInRange = range.end && that._dateInViews(range.end);\n\n            if (!startInRange && endInRange) {\n                that.rangeSelectable.selectTo(that._cellByDate(range.end));\n            }\n\n            if (startInRange && endInRange) {\n                that.rangeSelectable.range(that._cellByDate(range.start), that._cellByDate(range.end));\n            }\n\n            if (range.end && startInRange && !endInRange) {\n                that.rangeSelectable.selectFrom(that._cellByDate(range.start));\n            }\n\n            if (!range.end && startInRange) {\n                that.rangeSelectable.start(that._cellByDate(range.start));\n            }\n\n            if (+visibleRange.start > +range.start && +visibleRange.end < +range.end) {\n                that.rangeSelectable.mid(that.element.find(CELLSELECTORVALID));\n            }\n        }\n    });\n\n    kendo.ui.plugin(MultiViewCalendar);\n\n    function mousetoggle(e) {\n        var disabled = $(this).hasClass(\"k-state-disabled\");\n\n        if (!disabled) {\n            $(this).toggleClass(HOVER, MOUSEENTER.indexOf(e.type) > -1 || e.type == FOCUS);\n        }\n    }\n\n    function addDaysToArray(array, numberOfDays, fromDate, disableDates) {\n        for (var i = 0; i <= numberOfDays; i++) {\n            var nextDay = new Date(fromDate.getTime());\n            nextDay = new Date(nextDay.setDate(nextDay.getDate() + i));\n            if (!disableDates(nextDay)) {\n                array.push(nextDay);\n            }\n        }\n    }\n\n    function daysBetweenTwoDates(startDate, endDate) {\n        if (+endDate < +startDate) {\n            var temp = +startDate;\n            calendar.views[0].setDate(startDate, endDate);\n            calendar.views[0].setDate(endDate, new Date(temp));\n        }\n        var fromDateUTC = Date.UTC(startDate.getFullYear(), startDate.getMonth(), startDate.getDate());\n        var endDateUTC = Date.UTC(endDate.getFullYear(), endDate.getMonth(), endDate.getDate());\n\n        return Math.ceil((+endDateUTC - +fromDateUTC) / kendo.date.MS_PER_DAY);\n    }\n\n    function shiftDate(value, dimension, numberOfViews) {\n        var current;\n        if (dimension === \"month\") {\n            current = new DATE(value.getFullYear(), value.getMonth() + numberOfViews, value.getDate());\n            current.setFullYear(value.getFullYear());\n            if (Math.abs(current.getMonth() - value.getMonth()) > numberOfViews || numberOfViews > 10) {\n                current.setMonth(value.getMonth() + numberOfViews);\n                current = calendar.views[0].last(current);\n            }\n            return current;\n        } else if (dimension === \"year\") {\n            current = new DATE(1, value.getMonth(), value.getDate());\n            current.setFullYear(value.getFullYear() + numberOfViews);\n            if (Math.abs(current.getFullYear() - value.getFullYear()) > numberOfViews) {\n                current = new DATE(1, value.getMonth(), 1);\n                current.setFullYear(value.getFullYear() + numberOfViews);\n                current = calendar.views[1].last(current);\n            }\n            return current;\n        } else if (dimension === \"decade\") {\n            current = new DATE(1, value.getMonth(), value.getDate());\n            current.setFullYear(value.getFullYear() + 10 * numberOfViews);\n            if (Math.abs(current.getFullYear() - value.getFullYear()) > 10 * numberOfViews) {\n                current = new DATE(1, value.getMonth(), 1);\n                current.setFullYear(value.getFullYear() + 10 * numberOfViews);\n                current = calendar.views[2].last(current);\n            }\n            return current;\n        } else if (dimension === \"century\") {\n            current = new DATE(1, value.getMonth(), value.getDate());\n            current.setFullYear(value.getFullYear() + 100 * numberOfViews);\n            if (Math.abs(current.getFullYear() - value.getFullYear()) > 100 * numberOfViews) {\n                current = new DATE(1, value.getMonth(), 1);\n                current.setFullYear(value.getFullYear() + 100 * numberOfViews);\n                current = calendar.views[3].last(current);\n            }\n            return current;\n        }\n    }\n\n})(window.kendo.jQuery);\n\nreturn window.kendo;\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3) { (a3 || a2)(); });\n\n"],"names":["define","__meta__","id","name","category","description","depends","$","window","kendo","jQuery","undefined","calendar","support","isInRange","toDateObject","createDate","isEqualDate","getToday","keys","ui","Widget","Selectable","template","mobileOS","ns","CLICK","KEYDOWN","ID","MIN","MONTH","DOT","CENTURY","DECADE","CHANGE","NAVIGATE","VALUE","FOCUSED","SELECTED","MID","SPLITEND","SPLITSTART","START","END","HOVER","DISABLED","TODAY","OTHERMONTH","OUTOFRANGE","CELLSELECTOR","CELLSELECTORVALID","BLUR","FOCUS","MOUSEENTER","touch","MOUSELEAVE_NS","PREVARROW","NEXTARROW","ARIA_SELECTED","INPUTSELECTOR","ARIA_DISABLED","ARIA_LABEL","DATE","Date","views","month","year","decade","century","RangeSelectable","extend","init","element","options","that","this","fn","call","userEvents","UserEvents","global","allowSelection","filter","tap","_tap","bind","touchAction","events","inputSelectors","multiple","dragToSelect","relatedTarget","noop","destroy","_lastActive","_start","_end","_allowSelection","target","is","cancel","start","addClass","end","mid","elements","tables","find","each","lastCell","last","firstCell","first","hasClass","clear","clearVariables","removeClass","selectFrom","items","startIdx","inArray","index","selectTo","endIdx","range","temp","length","_useEnd","change","trigger","_clearFlags","_useStart","e","selectRange","currentDate","_toggling","MultiViewCalendar","culture","wrapper","disableDates","disabled","getCulture","format","_extractFormat","calendars","standard","patterns","d","_templates","_header","_wrapper","weekNumber","on","_move","_blur","link","currentTarget","firstChild","href","indexOf","preventDefault","_click","_mouseEnter","attr","_cellID","_calendarWidth","width","_range","_initViews","viewName","value","_selectable","_footer","footer","_selectDates","selectable","selectDates","_restoreSelection","notify","min","max","dates","showViewHeader","depth","messages","weekColumnHeader","setOptions","normalize","i","_views","off","remove","_cell","_currentView","_current","header","_title","rangeSelectable","_today","current","focus","table","closest","_dateInViews","_cellByDate","_option","view","navigateToPast","_navigate","navigateToFuture","navigateUp","_index","navigate","navigateDown","_value","isNaN","viewsEnum","restrictValue","_updateHeader","title","_firstViewValue","visibleRange","_visibleRange","lastDate","prevDisabled","nextDisabled","shiftDate","html","getFullYear","toggleClass","compare","_navContainer","appendTo","cell","preventFocus","key","keyCode","focusedCell","currentValue","isRtl","prevent","method","lastActive","cellIndex","RIGHT","LEFT","UP","DOWN","SPACEBAR","HOME","eq","prev","_focusCell","next","ctrlKey","metaKey","ENTER","_toggleSelection","shiftKey","setDate","_nextNavigatable","getMonth","getDate","_selectRange","PAGEUP","PAGEDOWN","_visualizeSelectedDatesInView","selectedDates","cells","toDateString","_selectElement","isDisabled","navigatableDate","getTime","event","_unselect","option","isBigger","parseDate","_toggle","toLowerCase","_rangeSelection","aria","parseOptions","_selection","_onRelatedTarget","unselect","_unselecting","_getFirstViewDate","currentView","ranges","push","_canRenderNextView","viewDate","fullYear","date","maxYear","maxMonth","viewOptions","_table","content","url","showHeader","isWeekColumnVisible","otherMonth","contentClasses","tablesWrapper","sender","useEnd","useStart","initialRange","_preventChange","selectElements","domEvent","isCell","_validateValue","_deselect","_addSelectedCellsToArray","item","currentDateIndex","map","Number","splice","firstDateInView","lastDateInView","_fillRange","daysDifference","daysBetweenTwoDates","addDaysToArray","buttons","prependTo","mousetoggle","insertAfter","empty","useWithBlock","today","hide","show","toString","arrow","modifier","originaValue","offset","setFullYear","toggle","isTodayDisabled","_todayClick","adjustDST","_focus","contains","focusTable","cellId","removeAttribute","_updateAria","ariaTemplate","valueType","text","clearSelection","validSelectedDates","datesUnique","position","array","time","grep","setHours","startInRange","endInRange","type","numberOfDays","fromDate","nextDay","startDate","endDate","fromDateUTC","UTC","endDateUTC","Math","ceil","MS_PER_DAY","dimension","numberOfViews","abs","setMonth","plugin","amd","a1","a2","a3"],"mappings":"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"}