{"version":3,"file":"kendo.view.min.js","sources":["kendo.view.js"],"sourcesContent":["(function(f, define) {\n    define('kendo.view',[\n        \"kendo.core\",\n        \"kendo.binder\",\n        \"kendo.fx\"\n    ], f);\n})(function() {\n\nvar __meta__ = { // jshint ignore:line\n    id: \"view\",\n    name: \"View\",\n    category: \"framework\",\n    description: \"The View class instantiates and handles the events of a certain screen from the application.\",\n    depends: [ \"core\", \"binder\", \"fx\" ],\n    hidden: false\n};\n\n(function($, undefined) {\n    var kendo = window.kendo,\n        attr = kendo.attr,\n        ui = kendo.ui,\n        attrValue = kendo.attrValue,\n        directiveSelector = kendo.directiveSelector,\n        Observable = kendo.Observable,\n        Widget = kendo.ui.Widget,\n        roleSelector = kendo.roleSelector,\n\n        SCRIPT = \"SCRIPT\",\n        INIT = \"init\",\n        TRANSITION_START = \"transitionStart\",\n        TRANSITION_END = \"transitionEnd\",\n        SHOW = \"show\",\n        HIDE = \"hide\",\n        ATTACH = \"attach\",\n        DETACH = \"detach\",\n        sizzleErrorRegExp = /unrecognized expression/;\n\n    var bodyRegExp = /<body[^>]*>(([\\u000a\\u000d\\u2028\\u2029]|.)*)<\\/body>/i;\n    var LOAD_START = \"loadStart\";\n    var LOAD_COMPLETE = \"loadComplete\";\n    var SHOW_START = \"showStart\";\n    var SAME_VIEW_REQUESTED = \"sameViewRequested\";\n    var VIEW_SHOW = \"viewShow\";\n    var VIEW_TYPE_DETERMINED = \"viewTypeDetermined\";\n    var AFTER = \"after\";\n    var classNames = {\n        content: \"k-content\",\n        view: \"k-view\",\n        stretchedView: \"k-stretched-view\",\n        widget: \"k-widget\",\n        header: \"k-header\",\n        footer: \"k-footer\"\n    };\n\n    var View = kendo.ui.Widget.extend({\n        init: function(content, options) {\n            var that = this;\n            options = options || {};\n            that.id = kendo.guid();\n\n            Observable.fn.init.call(that);\n            this.options = $.extend({}, this.options, options);\n\n            that.content = content;\n\n            if (that.options.renderOnInit) {\n                Widget.fn.init.call(that, that._createElement(), options);\n            }\n\n            if (that.options.wrapInSections) {\n                that._renderSections();\n            }\n\n            that.tagName = options.tagName || \"div\";\n            that.model = options.model;\n            that._wrap = options.wrap !== false;\n            this._evalTemplate = options.evalTemplate || false;\n            this._useWithBlock = options.useWithBlock;\n            that._fragments = {};\n\n            that.bind([ INIT, SHOW, HIDE, TRANSITION_START, TRANSITION_END ], options);\n        },\n\n        options: {\n            name: \"View\",\n            renderOnInit: false,\n            wrapInSections: false,\n            detachOnHide: true,\n            detachOnDestroy: true\n        },\n\n        render: function(container) {\n            var that = this,\n                notInitialized = !that.element;\n\n            // The order below matters - kendo.bind should happen when the element is in the DOM, and show should be triggered after init.\n\n            if (notInitialized) {\n                that.element = that._createElement();\n            }\n\n            if (container) {\n                $(container).append(that.element);\n            }\n\n            if (notInitialized) {\n                kendo.bind(that.element, that.model);\n                that.trigger(INIT);\n            }\n\n            if (container) {\n                that._eachFragment(ATTACH);\n                that.trigger(SHOW);\n            }\n\n            return that.element;\n        },\n\n        clone: function() {\n            return new ViewClone(this);\n        },\n\n        triggerBeforeShow: function() {\n            return true;\n        },\n\n        triggerBeforeHide: function() {\n            return true;\n        },\n\n        showStart: function() {\n            var that = this;\n            var element = that.render();\n\n            if (element) {\n                element.css(\"display\", \"\");\n            }\n\n            this.trigger(SHOW_START, { view: this });\n        },\n\n        showEnd: function() {\n        },\n\n        hideEnd: function() {\n            this.hide();\n        },\n\n        beforeTransition: function(type) {\n            this.trigger(TRANSITION_START, { type: type });\n        },\n\n        afterTransition: function(type) {\n            this.trigger(TRANSITION_END, { type: type });\n        },\n\n        hide: function() {\n            if (this.options.detachOnHide) {\n                this._eachFragment(DETACH);\n                $(this.element).detach();\n            }\n\n            this.trigger(HIDE);\n        },\n\n        destroy: function() {\n            var that = this;\n            var element = that.element;\n\n            if (element) {\n                Widget.fn.destroy.call(that);\n\n                kendo.unbind(element);\n                kendo.destroy(element);\n\n                if (that.options.detachOnDestroy) {\n                    element.remove();\n                }\n            }\n        },\n\n        // ported from mobile view\n        purge: function() {\n            var that = this;\n\n            that.destroy();\n            $(that.element).add(that.content).add(that.wrapper).off().remove();\n        },\n\n        fragments: function(fragments) {\n            $.extend(this._fragments, fragments);\n        },\n\n        _eachFragment: function(methodName) {\n            for (var placeholder in this._fragments) {\n                this._fragments[placeholder][methodName](this, placeholder);\n            }\n        },\n\n        _createElement: function() {\n            var that = this,\n                wrapper = \"<\" + that.tagName + \">\",\n                element,\n                content;\n\n            try {\n                content = $(document.getElementById(that.content) || that.content); // support passing id without #\n\n                if (content[0].tagName === SCRIPT) {\n                    content = content.html();\n                }\n            } catch (e) {\n                if (sizzleErrorRegExp.test(e.message)) {\n                    content = that.content;\n                }\n            }\n\n            if (typeof content === \"string\") {\n                content = content.replace(/^\\s+|\\s+$/g, '');\n                if (that._evalTemplate) {\n                    content = kendo.template(content, { useWithBlock: that._useWithBlock })(that.model || {});\n                }\n\n                element = $(wrapper).append(content);\n                // drop the wrapper if asked - this seems like the easiest (although not very intuitive) way to avoid messing up templates with questionable content, like this one for instance:\n                // <script id=\"my-template\">\n                // foo\n                // <span> Span </span>\n                // </script>\n                if (!that._wrap) {\n                   element = element.contents();\n                }\n            } else {\n                element = content;\n                if (that._evalTemplate) {\n                    var result = $(kendo.template($(\"<div />\").append(element.clone(true)).html(), { useWithBlock: that._useWithBlock })(that.model || {}));\n\n                    // template uses DOM\n                    if ($.contains(document, element[0])) {\n                        element.replaceWith(result);\n                    }\n\n                    element = result;\n                }\n                if (that._wrap) {\n                    element = element.wrapAll(wrapper).parent();\n                }\n            }\n\n            return element;\n        },\n\n        _renderSections: function() {\n            var that = this;\n\n            if (that.options.wrapInSections) {\n                that._wrapper();\n                that._createContent();\n                that._createHeader();\n                that._createFooter();\n            }\n        },\n\n        _wrapper: function() {\n            var that = this;\n            var content = that.content;\n\n            if (content.is(roleSelector(\"view\"))) {\n                that.wrapper = that.content;\n            } else {\n                that.wrapper = content\n                    .wrap('<div data-' + kendo.ns + 'stretch=\"true\" data-' + kendo.ns + 'role=\"view\" data-' + kendo.ns + 'init-widgets=\"false\"></div>')\n                    .parent();\n            }\n\n            var wrapper = that.wrapper;\n\n            wrapper.attr(\"id\", that.id);\n\n            wrapper.addClass(classNames.view);\n            wrapper.addClass(classNames.widget);\n            wrapper.attr(\"role\", \"view\");\n        },\n\n        _createContent: function() {\n            var that = this;\n            var wrapper = $(that.wrapper);\n            var contentSelector = roleSelector(\"content\");\n\n            if (!wrapper.children(contentSelector)[0]) {\n                var ccontentElements = wrapper.children().filter(function() {\n                    var child = $(this);\n                    if (!child.is(roleSelector(\"header\")) && !child.is(roleSelector(\"footer\"))) {\n                        return child;\n                    }\n                });\n\n                ccontentElements.wrap(\"<div \" + attr(\"role\") + '=\"content\"></div>');\n            }\n\n            // use contentElement instead of content as view.content can be a string\n            this.contentElement = wrapper.children(roleSelector(\"content\"));\n\n            this.contentElement\n                .addClass(classNames.stretchedView)\n                .addClass(classNames.content);\n        },\n\n        _createHeader: function() {\n            var that = this;\n            var wrapper = that.wrapper;\n\n            this.header = wrapper.children(roleSelector(\"header\")).addClass(classNames.header);\n        },\n\n        _createFooter: function() {\n            var that = this;\n            var wrapper = that.wrapper;\n\n            this.footer = wrapper.children(roleSelector(\"footer\")).addClass(classNames.footer);\n        }\n    });\n\n    var ViewClone = kendo.Class.extend({\n        init: function(view) {\n            $.extend(this, {\n                element: view.element.clone(true),\n                transition: view.transition,\n                id: view.id\n            });\n\n            view.element.parent().append(this.element);\n        },\n\n        hideEnd: function() {\n            this.element.remove();\n        },\n\n        beforeTransition: $.noop,\n        afterTransition: $.noop\n    });\n\n    var Layout = View.extend({\n        init: function(content, options) {\n            View.fn.init.call(this, content, options);\n            this.containers = {};\n        },\n\n        container: function(selector) {\n            var container = this.containers[selector];\n\n            if (!container) {\n                container = this._createContainer(selector);\n                this.containers[selector] = container;\n            }\n\n            return container;\n        },\n\n        showIn: function(selector, view, transition) {\n            this.container(selector).show(view, transition);\n        },\n\n        _createContainer: function(selector) {\n            var root = this.render(),\n                element = root.find(selector),\n                container;\n\n            if (!element.length && root.is(selector)) {\n                if (root.is(selector)) {\n                    element = root;\n                } else {\n\n                    throw new Error(\"can't find a container with the specified \" + selector + \" selector\");\n                }\n            }\n\n            container = new ViewContainer(element);\n\n            container.bind(\"accepted\", function(e) {\n                e.view.render(element);\n            });\n\n            return container;\n        }\n    });\n\n    var Fragment = View.extend({\n        attach: function(view, placeholder) {\n            view.element.find(placeholder).replaceWith(this.render());\n        },\n\n        detach: function() {\n        }\n    });\n\n    var transitionRegExp = /^(\\w+)(:(\\w+))?( (\\w+))?$/;\n\n    function parseTransition(transition) {\n        if (!transition) {\n            return {};\n        }\n\n        var matches = transition.match(transitionRegExp) || [];\n\n        return {\n            type: matches[1],\n            direction: matches[3],\n            reverse: matches[5] === \"reverse\"\n        };\n    }\n\n    var ViewContainer = Observable.extend({\n        init: function(container) {\n            Observable.fn.init.call(this);\n            this.container = container;\n            this.history = [];\n            this.view = null;\n            this.running = false;\n        },\n\n        after: function() {\n            this.running = false;\n            this.trigger(\"complete\", { view: this.view });\n            this.trigger(\"after\");\n        },\n\n        end: function() {\n            this.view.showEnd();\n            this.previous.hideEnd();\n            this.after();\n        },\n\n        show: function(view, transition, locationID) {\n            if (!view.triggerBeforeShow() || (this.view && !this.view.triggerBeforeHide())) {\n                this.trigger(\"after\");\n                return false;\n            }\n\n            locationID = locationID || view.id;\n\n            var that = this,\n                current = (view === that.view) ? view.clone() : that.view,\n                history = that.history,\n                previousEntry = history[history.length - 2] || {},\n                back = previousEntry.id === locationID,\n                // If explicit transition is set, it will be with highest priority\n                // Next we will try using the history record transition or the view transition configuration\n                theTransition = transition || ( back ? history[history.length - 1].transition : view.transition ),\n                transitionData = parseTransition(theTransition);\n\n            if (that.running) {\n                that.effect.stop();\n            }\n\n            if (theTransition === \"none\") {\n                theTransition = null;\n            }\n\n            that.trigger(\"accepted\", { view: view });\n            that.view = view;\n            that.previous = current;\n            that.running = true;\n\n            if (!back) {\n                history.push({ id: locationID, transition: theTransition });\n            } else {\n                history.pop();\n            }\n\n            if (!current) {\n                view.showStart();\n                view.showEnd();\n                that.after();\n                return true;\n            }\n\n            if (!theTransition || !kendo.effects.enabled) {\n                view.showStart();\n                that.end();\n            } else {\n                // hide the view element before init/show - prevents blinks on iPad\n                // the replace effect will remove this class\n                view.element.addClass(\"k-fx-hidden\");\n                view.showStart();\n                // do not reverse the explicit transition\n                if (back && !transition) {\n                    transitionData.reverse = !transitionData.reverse;\n                }\n\n                that.effect = kendo.fx(view.element).replace(current.element, transitionData.type)\n                    .beforeTransition(function() {\n                        view.beforeTransition(\"show\");\n                        current.beforeTransition(\"hide\");\n                    })\n                    .afterTransition(function() {\n                        view.afterTransition(\"show\");\n                        current.afterTransition(\"hide\");\n                    })\n                    .direction(transitionData.direction)\n                    .setReverse(transitionData.reverse);\n\n                that.effect.run().then(function() { that.end(); });\n            }\n\n            return true;\n        },\n\n        destroy: function() {\n            var that = this;\n            var view = that.view;\n\n            if (view && view.destroy) {\n                view.destroy();\n            }\n        }\n    });\n\n    var ViewEngine = Observable.extend({\n        init: function(options) {\n            var that = this,\n                views,\n                container;\n\n            Observable.fn.init.call(that);\n            that.options = options;\n\n            $.extend(that, options);\n            that.sandbox = $(\"<div />\");\n            container = that.container;\n\n            views = that._hideViews(container);\n            that.rootView = views.first();\n            that.layouts = {};\n\n            that.viewContainer = new kendo.ViewContainer(that.container);\n\n            that.viewContainer.bind(\"accepted\", function(e) {\n                e.view.params = that.params;\n            });\n\n            that.viewContainer.bind(\"complete\", function(e) {\n                that.trigger(VIEW_SHOW, { view: e.view });\n            });\n\n            that.viewContainer.bind(AFTER, function() {\n                that.trigger(AFTER);\n            });\n\n            this.bind(this.events, options);\n        },\n\n        events: [\n            SHOW_START,\n            AFTER,\n            VIEW_SHOW,\n            LOAD_START,\n            LOAD_COMPLETE,\n            SAME_VIEW_REQUESTED,\n            VIEW_TYPE_DETERMINED\n        ],\n\n        destroy: function() {\n            var that = this;\n            var viewContainer = that.viewContainer;\n\n            kendo.destroy(that.container);\n\n            for (var id in that.layouts) {\n                this.layouts[id].destroy();\n            }\n\n            if (viewContainer) {\n                viewContainer.destroy();\n            }\n        },\n\n        view: function() {\n            return this.viewContainer.view;\n        },\n\n        showView: function(url, transition, params) {\n            url = url.replace(new RegExp(\"^\" + this.remoteViewURLPrefix), \"\");\n            if (url === \"\" && this.remoteViewURLPrefix) {\n                url = \"/\";\n            }\n\n            if (url.replace(/^#/, \"\") === this.url) {\n                this.trigger(SAME_VIEW_REQUESTED);\n                return false;\n            }\n\n            this.trigger(SHOW_START);\n\n            var that = this,\n                element = that._findViewElement(url),\n                view = kendo.widgetInstance(element);\n\n            that.url = url.replace(/^#/, \"\");\n\n            that.params = params;\n\n            if (view && view.reload) {\n                view.purge();\n                element = [];\n            }\n\n            this.trigger(VIEW_TYPE_DETERMINED, { remote: element.length === 0, url: url });\n\n            if (element[0]) {\n                if (!view) {\n                    view = that._createView(element);\n                }\n\n                return that.viewContainer.show(view, transition, url);\n            } else {\n                return true;\n            }\n        },\n\n        append: function(html, url) {\n            var sandbox = this.sandbox,\n                urlPath = (url || \"\").split(\"?\")[0],\n                container = this.container,\n                views,\n                view;\n\n            if (bodyRegExp.test(html)) {\n                html = RegExp.$1;\n            }\n\n            sandbox[0].innerHTML = html;\n\n            container.append(sandbox.children(\"script, style\"));\n\n            views = this._hideViews(sandbox);\n            view = views.first();\n\n            // Generic HTML content found as remote view - no remote view markers\n            if (!view.length) {\n                views = view = sandbox.wrapInner(\"<div data-role=view />\").children(); // one element\n            }\n\n            if (urlPath) {\n                view.hide().attr(attr(\"url\"), urlPath);\n            }\n\n            container.append(views);\n\n            return this._createView(view);\n        },\n\n        _locate: function(selectors) {\n            return this.$angular ? directiveSelector(selectors) : roleSelector(selectors);\n        },\n\n        _findViewElement: function(url) {\n            var element,\n                urlPath = url.split(\"?\")[0];\n\n            if (!urlPath) {\n                return this.rootView;\n            }\n\n            element = this.container.children(\"[\" + attr(\"url\") + \"='\" + urlPath + \"']\");\n\n            // do not try to search for \"#/foo/bar\" id, jQuery throws error\n            if (!element[0] && urlPath.indexOf(\"/\") === -1) {\n                element = this.container.children(urlPath.charAt(0) === \"#\" ? urlPath : \"#\" + urlPath);\n            }\n\n            if (!element[0]) {\n                element = this._findViewElementById(url);\n            }\n\n            return element;\n        },\n\n        _findViewElementById: function(id) {\n            var element = this.container.children(\"[id='\" + id + \"']\");\n            return element;\n        },\n\n        _createView: function(element) {\n            //return this._createMobileView(element);\n            return this._createSpaView(element);\n        },\n\n        _createMobileView: function(element) {\n            return kendo.initWidget(element, {\n                defaultTransition: this.transition,\n                loader: this.loader,\n                container: this.container,\n                getLayout: this.getLayoutProxy,\n                modelScope: this.modelScope,\n                reload: attrValue(element, \"reload\")\n            }, ui.roles);\n        },\n\n        _createSpaView: function(element) {\n            var viewOptions = (this.options || {}).viewOptions || {};\n            return new kendo.View(element, {\n                renderOnInit: viewOptions.renderOnInit,\n                wrap: viewOptions.wrap || false,\n                wrapInSections: viewOptions.wrapInSections,\n                detachOnHide: viewOptions.detachOnHide,\n                detachOnDestroy: viewOptions.detachOnDestroy\n            });\n        },\n\n        _hideViews: function(container) {\n            return container.children(this._locate(\"view\")).hide();\n        }\n    });\n\n    kendo.ViewEngine = ViewEngine;\n\n    kendo.ViewContainer = ViewContainer;\n    kendo.Fragment = Fragment;\n    kendo.Layout = Layout;\n    kendo.View = View;\n    kendo.ViewClone = ViewClone;\n\n})(window.kendo.jQuery);\n\nreturn window.kendo;\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3) { (a3 || a2)(); });\n\n"],"names":["define","__meta__","id","name","category","description","depends","hidden","$","window","kendo","jQuery","undefined","attr","ui","attrValue","directiveSelector","Observable","Widget","roleSelector","SCRIPT","INIT","TRANSITION_START","TRANSITION_END","SHOW","HIDE","ATTACH","DETACH","sizzleErrorRegExp","bodyRegExp","LOAD_START","LOAD_COMPLETE","SHOW_START","SAME_VIEW_REQUESTED","VIEW_SHOW","VIEW_TYPE_DETERMINED","AFTER","classNames","content","view","stretchedView","widget","header","footer","View","extend","init","options","that","this","guid","fn","call","renderOnInit","_createElement","wrapInSections","_renderSections","tagName","model","_wrap","wrap","_evalTemplate","evalTemplate","_useWithBlock","useWithBlock","_fragments","bind","detachOnHide","detachOnDestroy","render","container","notInitialized","element","append","trigger","_eachFragment","clone","ViewClone","triggerBeforeShow","triggerBeforeHide","showStart","css","showEnd","hideEnd","hide","beforeTransition","type","afterTransition","detach","destroy","unbind","remove","purge","add","wrapper","off","fragments","methodName","placeholder","document","getElementById","html","e","test","message","replace","template","contents","result","contains","replaceWith","wrapAll","parent","_wrapper","_createContent","_createHeader","_createFooter","is","ns","addClass","contentSelector","children","ccontentElements","filter","child","contentElement","Class","transition","noop","Layout","containers","selector","_createContainer","showIn","show","root","find","length","Error","ViewContainer","Fragment","attach","transitionRegExp","parseTransition","matches","match","direction","reverse","history","running","after","end","previous","locationID","current","previousEntry","back","theTransition","transitionData","effect","stop","push","pop","effects","enabled","fx","setReverse","run","then","ViewEngine","views","sandbox","_hideViews","rootView","first","layouts","viewContainer","params","events","showView","url","RegExp","remoteViewURLPrefix","_findViewElement","widgetInstance","reload","remote","_createView","urlPath","split","$1","innerHTML","wrapInner","_locate","selectors","$angular","indexOf","charAt","_findViewElementById","_createSpaView","_createMobileView","initWidget","defaultTransition","loader","getLayout","getLayoutProxy","modelScope","roles","viewOptions","amd","a1","a2","a3"],"mappings":"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"}