{"version":3,"file":"kendo.dataviz.treemap.min.js","sources":["kendo.dataviz.treemap.js"],"sourcesContent":["(function(f, define) {\n    define('kendo.dataviz.treemap',[ \"kendo.data\", \"kendo.userevents\", \"kendo.dataviz.themes\" ], f);\n})(function() {\n\nvar __meta__ = { // jshint ignore:line\n    id: \"dataviz.treeMap\",\n    name: \"TreeMap\",\n    category: \"dataviz\",\n    description: \"The Kendo DataViz TreeMap\",\n    depends: [ \"data\", \"userevents\", \"dataviz.themes\" ]\n};\n\n(function($, undefined) {\n    var math = Math,\n\n        isArray = Array.isArray,\n\n        kendo = window.kendo,\n        outerHeight = kendo._outerHeight,\n        outerWidth = kendo._outerWidth,\n        Class = kendo.Class,\n        Widget = kendo.ui.Widget,\n        template = kendo.template,\n        deepExtend = kendo.deepExtend,\n        HierarchicalDataSource = kendo.data.HierarchicalDataSource,\n        getter = kendo.getter,\n\n        dataviz = kendo.dataviz;\n\n    var NS = \".kendoTreeMap\",\n        CHANGE = \"change\",\n        DATA_BOUND = \"dataBound\",\n        ITEM_CREATED = \"itemCreated\",\n        MAX_VALUE = Number.MAX_VALUE,\n        MOUSEOVER_NS = \"mouseover\" + NS,\n        MOUSELEAVE_NS = \"mouseleave\" + NS,\n        UNDEFINED = \"undefined\";\n\n    var TreeMap = Widget.extend({\n        init: function(element, options) {\n            kendo.destroy(element);\n            $(element).empty();\n\n            Widget.fn.init.call(this, element, options);\n            this.wrapper = this.element;\n\n            this._initTheme(this.options);\n\n            this.element.addClass(\"k-widget k-treemap\");\n\n            this._setLayout();\n\n            this._originalOptions = deepExtend({}, this.options);\n\n            this._initDataSource();\n\n            this._attachEvents();\n\n            kendo.notify(this, dataviz.ui);\n        },\n\n        options: {\n            name: \"TreeMap\",\n            theme: \"default\",\n            autoBind: true,\n            textField: \"text\",\n            valueField: \"value\",\n            colorField: \"color\"\n        },\n\n        events: [DATA_BOUND, ITEM_CREATED],\n\n        _initTheme: function(options) {\n            var that = this,\n                themes = dataviz.ui.themes || {},\n                themeName = ((options || {}).theme || \"\").toLowerCase(),\n                themeOptions = (themes[themeName] || {}).treeMap;\n\n            that.options = deepExtend({}, themeOptions, options);\n        },\n\n        _attachEvents: function() {\n            this.element\n                .on(MOUSEOVER_NS, this._mouseover.bind(this))\n                .on(MOUSELEAVE_NS, this._mouseleave.bind(this));\n\n            this._resizeHandler = this.resize.bind(this, false);\n            kendo.onResize(this._resizeHandler);\n        },\n\n        _setLayout: function() {\n            if (this.options.type === \"horizontal\") {\n                this._layout = new SliceAndDice(false);\n                this._view = new SliceAndDiceView(this, this.options);\n            } else if (this.options.type === \"vertical\") {\n                this._layout = new SliceAndDice(true);\n                this._view = new SliceAndDiceView(this, this.options);\n            } else {\n                this._layout = new Squarified();\n                this._view = new SquarifiedView(this, this.options);\n            }\n        },\n\n        _initDataSource: function() {\n            var that = this,\n                options = that.options,\n                dataSource = options.dataSource;\n\n            that._dataChangeHandler = that._onDataChange.bind(that);\n\n            that.dataSource = HierarchicalDataSource\n                .create(dataSource)\n                .bind(CHANGE, that._dataChangeHandler);\n\n            if (dataSource) {\n                if (that.options.autoBind) {\n                    that.dataSource.fetch();\n                }\n            }\n        },\n\n        setDataSource: function(dataSource) {\n            var that = this;\n            that.dataSource.unbind(CHANGE, that._dataChangeHandler);\n            that.dataSource = dataSource\n                    .bind(CHANGE, that._dataChangeHandler);\n\n            if (dataSource) {\n                if (that.options.autoBind) {\n                    that.dataSource.fetch();\n                }\n            }\n        },\n\n        _onDataChange: function(e) {\n            var node = e.node;\n            var items = e.items;\n            var options = this.options;\n            var item, i;\n\n            if (!node) {\n                this._cleanItems();\n                this.element.empty();\n                item = this._wrapItem(items[0]);\n                this._layout.createRoot(\n                    item,\n                    outerWidth(this.element),\n                    outerHeight(this.element),\n                    this.options.type === \"vertical\"\n                );\n                this._view.createRoot(item);\n                // Reference of the root\n                this._root = item;\n                this._colorIdx = 0;\n            } else {\n                if (items.length) {\n                    var root = this._getByUid(node.uid);\n                    root.children = [];\n                    items = new kendo.data.Query(items)._sortForGrouping(options.valueField, \"desc\");\n\n                    for (i = 0; i < items.length; i++) {\n                        item = items[i];\n                        root.children.push(this._wrapItem(item));\n                    }\n\n                    var htmlSize = this._view.htmlSize(root);\n                    this._layout.compute(root.children, root.coord, htmlSize);\n\n                    this._setColors(root.children);\n                    this._view.render(root);\n                }\n            }\n\n            for (i = 0; i < items.length; i++) {\n                items[i].load();\n            }\n\n            if (node) {\n                this.trigger(DATA_BOUND, {\n                    node: node\n                });\n            }\n        },\n\n        _cleanItems: function() {\n            var that = this;\n            that.angular(\"cleanup\", function() {\n               return { elements: that.element.find(\".k-leaf div,.k-treemap-title,.k-treemap-title-vertical\") };\n            });\n        },\n\n        _setColors: function(items) {\n            var colors = this.options.colors;\n            var colorIdx = this._colorIdx;\n            var color = colors[colorIdx % colors.length];\n            var colorRange, item;\n            if (isArray(color)) {\n                colorRange = colorsByLength(color[0], color[1], items.length);\n            }\n\n            var leafNodes = false;\n            for (var i = 0; i < items.length; i++) {\n                item = items[i];\n\n                if (!defined(item.color)) {\n                    if (colorRange) {\n                        item.color = colorRange[i];\n                    } else {\n                        item.color = color;\n                    }\n                }\n                if (!item.dataItem.hasChildren) {\n                    leafNodes = true;\n                }\n            }\n\n            if (leafNodes) {\n                this._colorIdx++;\n            }\n        },\n\n        _contentSize: function(root) {\n            this.view.renderHeight(root);\n        },\n\n        _wrapItem: function(item) {\n            var wrap = {};\n\n            if (defined(this.options.valueField)) {\n                wrap.value = getField(this.options.valueField, item);\n            }\n\n            if (defined(this.options.colorField)) {\n                wrap.color = getField(this.options.colorField, item);\n            }\n\n            if (defined(this.options.textField)) {\n                wrap.text = getField(this.options.textField, item);\n            }\n\n            wrap.level = item.level();\n\n            wrap.dataItem = item;\n\n            return wrap;\n        },\n\n        _getByUid: function(uid) {\n            var items = [this._root];\n            var item;\n\n            while (items.length) {\n                item = items.pop();\n                if (item.dataItem.uid === uid) {\n                    return item;\n                }\n\n                if (item.children) {\n                    items = items.concat(item.children);\n                }\n            }\n        },\n\n        dataItem: function(node) {\n            var uid = $(node).attr(kendo.attr(\"uid\")),\n                dataSource = this.dataSource;\n\n            return dataSource && dataSource.getByUid(uid);\n        },\n\n        findByUid: function(uid) {\n            return this.element.find(\".k-treemap-tile[\" + kendo.attr(\"uid\") + \"='\" + uid + \"']\");\n        },\n\n        _mouseover: function(e) {\n            var target = $(e.target);\n            if (target.hasClass(\"k-leaf\")) {\n                this._removeActiveState();\n                target\n                    .removeClass(\"k-state-hover\")\n                    .addClass(\"k-state-hover\");\n            }\n        },\n\n        _removeActiveState: function() {\n            this.element\n                .find(\".k-state-hover\")\n                .removeClass(\"k-state-hover\");\n        },\n\n        _mouseleave: function() {\n            this._removeActiveState();\n        },\n\n        destroy: function() {\n            Widget.fn.destroy.call(this);\n            this.element.off(NS);\n\n            if (this.dataSource) {\n                this.dataSource.unbind(CHANGE, this._dataChangeHandler);\n            }\n\n            this._root = null;\n            kendo.unbindResize(this._resizeHandler);\n\n            kendo.destroy(this.element);\n        },\n\n        items: function() {\n            return $();\n        },\n\n        getSize: function() {\n            return kendo.dimensions(this.element);\n        },\n\n        _resize: function() {\n            var root = this._root;\n            if (root) {\n                var element = this.element;\n                var rootElement = element.children();\n                root.coord.width = outerWidth(element);\n                root.coord.height = outerHeight(element);\n\n                rootElement.css({\n                    width: root.coord.width,\n                    height: root.coord.height\n                });\n\n                this._resizeItems(root, rootElement);\n            }\n        },\n\n        _resizeItems: function(root, element) {\n            if (root.children && root.children.length) {\n                var elements = element.children(\".k-treemap-wrap\").children();\n                var child, childElement;\n\n                this._layout.compute(root.children, root.coord, { text: this._view.titleSize(root, element) });\n                for (var idx = 0; idx < root.children.length; idx++) {\n                    child = root.children[idx];\n                    childElement = elements.filter(\"[\" + kendo.attr(\"uid\") + \"='\" + child.dataItem.uid + \"']\");\n                    this._view.setItemSize(child, childElement);\n                    this._resizeItems(child, childElement);\n                }\n            }\n        },\n\n        setOptions: function(options) {\n            var dataSource = options.dataSource;\n\n            options.dataSource = undefined;\n            this._originalOptions = deepExtend(this._originalOptions, options);\n            this.options = deepExtend({}, this._originalOptions);\n            this._setLayout();\n            this._initTheme(this.options);\n\n            Widget.fn._setEvents.call(this, options);\n\n            if (dataSource) {\n                this.setDataSource(HierarchicalDataSource.create(dataSource));\n            }\n\n            if (this.options.autoBind) {\n                this.dataSource.fetch();\n            }\n        }\n    });\n\n    var Squarified = Class.extend({\n        createRoot: function(root, width, height) {\n            root.coord = {\n                width: width,\n                height: height,\n                top: 0,\n                left: 0\n            };\n        },\n\n        leaf: function(tree) {\n            return !tree.children;\n        },\n\n        layoutChildren: function(items, coord) {\n            var parentArea = coord.width * coord.height;\n            var totalArea = 0,\n                itemsArea = [],\n                i;\n\n            for (i = 0; i < items.length; i++) {\n                itemsArea[i] = parseFloat(items[i].value);\n                totalArea += itemsArea[i];\n            }\n\n            for (i = 0; i < itemsArea.length; i++) {\n                items[i].area = parentArea * itemsArea[i] / totalArea;\n            }\n\n            var minimumSideValue = this.layoutHorizontal() ? coord.height : coord.width;\n\n            var firstElement = [items[0]];\n            var tail = items.slice(1);\n            this.squarify(tail, firstElement, minimumSideValue, coord);\n        },\n\n        squarify: function(tail, initElement, width, coord) {\n            this.computeDim(tail, initElement, width, coord);\n        },\n\n        computeDim: function(tail, initElement, width, coord) {\n            if (tail.length + initElement.length == 1) {\n                var element = tail.length == 1 ? tail : initElement;\n                this.layoutLast(element, width, coord);\n                return;\n            }\n\n            if (tail.length >= 2 && initElement.length === 0) {\n                initElement = [tail[0]];\n                tail = tail.slice(1);\n            }\n\n            if (tail.length === 0) {\n                if (initElement.length > 0) {\n                    this.layoutRow(initElement, width, coord);\n                }\n                return;\n            }\n\n            var firstElement = tail[0];\n\n            if (this.worstAspectRatio(initElement, width) >= this.worstAspectRatio([firstElement].concat(initElement), width)) {\n                this.computeDim(tail.slice(1), initElement.concat([firstElement]), width, coord);\n            } else {\n                var newCoords = this.layoutRow(initElement, width, coord);\n                this.computeDim(tail, [], newCoords.dim, newCoords);\n            }\n        },\n\n        layoutLast: function(items, w, coord) {\n            items[0].coord = coord;\n        },\n\n        layoutRow: function(items, width, coord) {\n            if (this.layoutHorizontal()) {\n                return this.layoutV(items, width, coord);\n            } else {\n                return this.layoutH(items, width, coord);\n            }\n        },\n\n        orientation: \"h\",\n\n        layoutVertical: function() {\n            return this.orientation === \"v\";\n        },\n\n        layoutHorizontal: function() {\n            return this.orientation === \"h\";\n        },\n\n        layoutChange: function() {\n            this.orientation = this.layoutVertical() ? \"h\" : \"v\";\n        },\n\n        worstAspectRatio: function(items, width) {\n            if (!items || items.length === 0) {\n                return MAX_VALUE;\n            }\n\n            var areaSum = 0,\n                maxArea = 0,\n                minArea = MAX_VALUE;\n\n            for (var i = 0; i < items.length; i++) {\n                var area = items[i].area;\n                areaSum += area;\n                minArea = (minArea < area) ? minArea : area;\n                maxArea = (maxArea > area) ? maxArea : area;\n            }\n\n            return math.max(\n                (width * width * maxArea) / (areaSum * areaSum),\n                (areaSum * areaSum) / (width * width * minArea)\n            );\n        },\n\n        compute: function(children, rootCoord, htmlSize) {\n            if (!(rootCoord.width >= rootCoord.height && this.layoutHorizontal())) {\n                this.layoutChange();\n            }\n\n            if (children && children.length > 0) {\n                var newRootCoord = {\n                    width: rootCoord.width,\n                    height: rootCoord.height - htmlSize.text,\n                    top: 0,\n                    left: 0\n                };\n\n                this.layoutChildren(children, newRootCoord);\n            }\n        },\n\n        layoutV: function(items, width, coord) {\n            var totalArea = this._totalArea(items),\n                top = 0;\n\n            width = round(totalArea / width);\n\n            for (var i = 0; i < items.length; i++) {\n                var height = round(items[i].area / width);\n                items[i].coord = {\n                    height: height,\n                    width: width,\n                    top: coord.top + top,\n                    left: coord.left\n                };\n\n                top += height;\n            }\n\n            var ans = {\n                height: coord.height,\n                width: coord.width - width,\n                top: coord.top,\n                left: coord.left + width\n            };\n\n            ans.dim = math.min(ans.width, ans.height);\n\n            if (ans.dim != ans.height) {\n                this.layoutChange();\n            }\n\n            return ans;\n        },\n\n        layoutH: function(items, width, coord) {\n            var totalArea = this._totalArea(items);\n\n            var height = round(totalArea / width),\n                top = coord.top,\n                left = 0;\n\n            for (var i = 0; i < items.length; i++) {\n                items[i].coord = {\n                    height: height,\n                    width: round(items[i].area / height),\n                    top: top,\n                    left: coord.left + left\n                };\n                left += items[i].coord.width;\n            }\n\n            var ans = {\n                height: coord.height - height,\n                width: coord.width,\n                top: coord.top + height,\n                left: coord.left\n            };\n\n            ans.dim = math.min(ans.width, ans.height);\n\n            if (ans.dim != ans.width) {\n                this.layoutChange();\n            }\n\n            return ans;\n        },\n\n        _totalArea: function(items) {\n            var total = 0;\n\n            for (var i = 0; i < items.length; i++) {\n                total += items[i].area;\n            }\n\n            return total;\n        }\n    });\n\n    var SquarifiedView = Class.extend({\n        init: function(treeMap, options) {\n            this.options = deepExtend({}, this.options, options);\n            this.treeMap = treeMap;\n            this.element = $(treeMap.element);\n\n            this.offset = 0;\n        },\n\n        titleSize: function(item, element) {\n            var text = element.children(\".k-treemap-title\");\n            return text.height() || 0;\n        },\n\n        htmlSize: function(root) {\n            var rootElement = this._getByUid(root.dataItem.uid);\n            var htmlSize = {\n                text: 0\n            };\n\n            if (root.children) {\n                this._clean(rootElement);\n\n                var text = this._getText(root);\n                if (text) {\n                    var title = this._createTitle(root);\n                    rootElement.append(title);\n\n                    this._compile(title, root.dataItem);\n\n                    htmlSize.text = title.height();\n                }\n\n                rootElement.append(this._createWrap());\n\n                this.offset = (outerWidth(rootElement) - rootElement.innerWidth()) / 2;\n            }\n\n            return htmlSize;\n        },\n\n        _compile: function(element, dataItem) {\n            this.treeMap.angular(\"compile\", function() {\n                return {\n                    elements: element,\n                    data: [ { dataItem: dataItem } ]\n                };\n            });\n        },\n\n        _getByUid: function(uid) {\n            return this.element.find(\".k-treemap-tile[\" + kendo.attr(\"uid\") + \"='\" + uid + \"']\");\n        },\n\n        render: function(root) {\n            var rootElement = this._getByUid(root.dataItem.uid);\n            var children = root.children;\n            if (children) {\n                var rootWrap = rootElement.find(\".k-treemap-wrap\");\n\n                for (var i = 0; i < children.length; i++) {\n                    var leaf = children[i];\n                    var htmlElement = this._createLeaf(leaf);\n                    rootWrap.append(htmlElement);\n\n                    this._compile(htmlElement.children(), leaf.dataItem);\n\n                    this.treeMap.trigger(ITEM_CREATED, {\n                        element: htmlElement\n                    });\n                }\n            }\n        },\n\n        createRoot: function(root) {\n            var htmlElement = this._createLeaf(root);\n            this.element.append(htmlElement);\n            this._compile(htmlElement.children(), root.dataItem);\n\n            this.treeMap.trigger(ITEM_CREATED, {\n                element: htmlElement\n            });\n        },\n\n        _clean: function(root) {\n            this.treeMap.angular(\"cleanup\", function() {\n                return {\n                    elements: root.children(\":not(.k-treemap-wrap)\")\n                };\n            });\n\n            root.css(\"background-color\", \"\");\n            root.removeClass(\"k-leaf\");\n            root.removeClass(\"k-inverse\");\n            root.empty();\n        },\n\n        _createLeaf: function(item) {\n            return this._createTile(item)\n                    .css(\"background-color\", item.color)\n                    .addClass(\"k-leaf\")\n                    .toggleClass(\n                        \"k-inverse\",\n                        this._tileColorBrightness(item) > 180\n                    )\n                    .toggle(item.value !== 0)\n                    .append($(\"<div></div>\")\n                    .html(this._getText(item)));\n        },\n\n        _createTile: function(item) {\n            var tile = $(\"<div class='k-treemap-tile'></div>\");\n            this.setItemSize(item, tile);\n\n            if (defined(item.dataItem) && defined(item.dataItem.uid)) {\n                tile.attr(kendo.attr(\"uid\"), item.dataItem.uid);\n            }\n\n            return tile;\n        },\n\n        _itemCoordinates: function(item) {\n            var coordinates = {\n                width: item.coord.width,\n                height: item.coord.height,\n                left: item.coord.left,\n                top: item.coord.top\n            };\n\n            if (coordinates.left && this.offset) {\n                coordinates.width += this.offset * 2;\n            } else {\n                coordinates.width += this.offset;\n            }\n\n            if (coordinates.top) {\n                coordinates.height += this.offset * 2;\n            } else {\n                coordinates.height += this.offset;\n            }\n\n            return coordinates;\n        },\n\n        setItemSize: function(item, element) {\n            var coordinates = this._itemCoordinates(item);\n            element.css({\n                width: coordinates.width,\n                height: coordinates.height,\n                left: coordinates.left,\n                top: coordinates.top\n            });\n        },\n\n        _getText: function(item) {\n            var text = item.text;\n\n            if (this.options.template) {\n                text = this._renderTemplate(item);\n            }\n\n            return text;\n        },\n\n        _renderTemplate: function(item) {\n            var titleTemplate = template(this.options.template);\n            return titleTemplate({\n                dataItem: item.dataItem,\n                text: item.text\n            });\n        },\n\n        _createTitle: function(item) {\n            return $(\"<div class='k-treemap-title'></div>\")\n                    .append($(\"<div></div>\").html(this._getText(item)));\n        },\n\n        _createWrap: function() {\n            return $(\"<div class='k-treemap-wrap'></div>\");\n        },\n\n        _tileColorBrightness: function(item) {\n            return colorBrightness(item.color);\n        }\n    });\n\n    var SliceAndDice = Class.extend({\n        createRoot: function(root, width, height, vertical) {\n            root.coord = {\n                width: width,\n                height: height,\n                top: 0,\n                left: 0\n            };\n            root.vertical = vertical;\n        },\n\n        init: function(vertical) {\n            this.vertical = vertical;\n            this.quotient = vertical ? 1 : 0;\n        },\n\n        compute: function(children, rootCoord, htmlSize) {\n\n            if (children.length > 0) {\n                var width = rootCoord.width;\n                var height = rootCoord.height;\n\n                if (this.vertical) {\n                    height -= htmlSize.text;\n                } else {\n                    width -= htmlSize.text;\n                }\n\n                var newRootCoord = {\n                    width: width,\n                    height: height,\n                    top: 0,\n                    left: 0\n                };\n\n                this.layoutChildren(children, newRootCoord);\n            }\n        },\n\n        layoutChildren: function(items, coord) {\n            var parentArea = coord.width * coord.height;\n            var totalArea = 0;\n            var itemsArea = [];\n            var i;\n\n            for (i = 0; i < items.length; i++) {\n                var item = items[i];\n                itemsArea[i] = parseFloat(items[i].value);\n                totalArea += itemsArea[i];\n                item.vertical = this.vertical;\n            }\n\n            for (i = 0; i < itemsArea.length; i++) {\n                items[i].area = parentArea * itemsArea[i] / totalArea;\n            }\n\n            this.sliceAndDice(items, coord);\n        },\n\n        sliceAndDice: function(items, coord) {\n            var totalArea = this._totalArea(items);\n            if (items[0].level % 2 === this.quotient) {\n                this.layoutHorizontal(items, coord, totalArea);\n            } else {\n                this.layoutVertical(items, coord, totalArea);\n            }\n        },\n\n        layoutHorizontal: function(items, coord, totalArea) {\n            var left = 0;\n\n            for (var i = 0; i < items.length; i++) {\n                var item = items[i];\n                var width = item.area / (totalArea / coord.width);\n                item.coord = {\n                    height: coord.height,\n                    width: width,\n                    top: coord.top,\n                    left: coord.left + left\n                };\n\n                left += width;\n            }\n        },\n\n        layoutVertical: function(items, coord, totalArea) {\n            var top = 0;\n\n            for (var i = 0; i < items.length; i++) {\n                var item = items[i];\n                var height = item.area / (totalArea / coord.height);\n                item.coord = {\n                    height: height,\n                    width: coord.width,\n                    top: coord.top + top,\n                    left: coord.left\n                };\n\n                top += height;\n            }\n        },\n\n        _totalArea: function(items) {\n            var total = 0;\n\n            for (var i = 0; i < items.length; i++) {\n                total += items[i].area;\n            }\n\n            return total;\n        }\n    });\n\n    var SliceAndDiceView = SquarifiedView.extend({\n        htmlSize: function(root) {\n            var rootElement = this._getByUid(root.dataItem.uid);\n            var htmlSize = {\n                text: 0,\n                offset: 0\n            };\n\n            if (root.children) {\n                this._clean(rootElement);\n\n                var text = this._getText(root);\n                if (text) {\n                    var title = this._createTitle(root);\n                    rootElement.append(title);\n                    this._compile(title, root.dataItem);\n\n                    if (root.vertical) {\n                        htmlSize.text = title.height();\n                    } else {\n                        htmlSize.text = title.width();\n                    }\n                }\n\n                rootElement.append(this._createWrap());\n\n                this.offset = (outerWidth(rootElement) - rootElement.innerWidth()) / 2;\n            }\n\n            return htmlSize;\n        },\n\n        titleSize: function(item, element) {\n            var size;\n            if (item.vertical) {\n               size = element.children(\".k-treemap-title\").height();\n            } else {\n               size = element.children(\".k-treemap-title-vertical\").width();\n            }\n            return size || 0;\n        },\n\n        _createTitle: function(item) {\n            var title;\n            if (item.vertical) {\n                title = $(\"<div class='k-treemap-title'></div>\");\n            } else {\n                title = $(\"<div class='k-treemap-title-vertical'></div>\");\n            }\n\n            return title.append($(\"<div></div>\").html(this._getText(item)));\n        }\n    });\n\n    function getField(field, row) {\n        if (row === null) {\n            return row;\n        }\n\n        var get = getter(field, true);\n        return get(row);\n    }\n\n    function defined(value) {\n        return typeof value !== UNDEFINED;\n    }\n\n    function colorsByLength(min, max, length) {\n        var minRGBtoDecimal = rgbToDecimal(min);\n        var maxRGBtoDecimal = rgbToDecimal(max);\n        var isDarker = colorBrightness(min) - colorBrightness(max) < 0;\n        var colors = [];\n\n        colors.push(min);\n\n        for (var i = 0; i < length; i++) {\n            var rgbColor = {\n                r: colorByIndex(minRGBtoDecimal.r, maxRGBtoDecimal.r, i, length, isDarker),\n                g: colorByIndex(minRGBtoDecimal.g, maxRGBtoDecimal.g, i, length, isDarker),\n                b: colorByIndex(minRGBtoDecimal.b, maxRGBtoDecimal.b, i, length, isDarker)\n            };\n            colors.push(buildColorFromRGB(rgbColor));\n        }\n\n        colors.push(max);\n\n        return colors;\n    }\n\n    function colorByIndex(min, max, index, length, isDarker) {\n        var minColor = math.min(math.abs(min), math.abs(max));\n        var maxColor = math.max(math.abs(min), math.abs(max));\n        var step = (maxColor - minColor) / (length + 1);\n        var currentStep = step * (index + 1);\n        var color;\n\n        if (isDarker) {\n            color = minColor + currentStep;\n        } else {\n            color = maxColor - currentStep;\n        }\n\n        return color;\n    }\n\n    function buildColorFromRGB(color) {\n        return \"#\" + decimalToRgb(color.r) + decimalToRgb(color.g) + decimalToRgb(color.b);\n    }\n\n    function rgbToDecimal(color) {\n        color = color.replace(\"#\", \"\");\n        var rgbColor = colorToRGB(color);\n\n        return {\n            r: rgbToHex(rgbColor.r),\n            g: rgbToHex(rgbColor.g),\n            b: rgbToHex(rgbColor.b)\n        };\n    }\n\n    function decimalToRgb(number) {\n        var result = math.round(number).toString(16).toUpperCase();\n\n        if (result.length === 1) {\n            result = \"0\" + result;\n        }\n\n        return result;\n    }\n\n    function colorToRGB(color) {\n        var colorLength = color.length;\n        var rgbColor = {};\n        if (colorLength === 3) {\n            rgbColor.r = color[0];\n            rgbColor.g = color[1];\n            rgbColor.b = color[2];\n        } else {\n            rgbColor.r = color.substring(0, 2);\n            rgbColor.g = color.substring(2, 4);\n            rgbColor.b = color.substring(4, 6);\n        }\n\n        return rgbColor;\n    }\n\n    function rgbToHex(rgb) {\n        return parseInt(rgb.toString(16), 16);\n    }\n\n    function colorBrightness(color) {\n        var brightness = 0;\n        if (color) {\n            color = rgbToDecimal(color);\n            brightness = math.sqrt(0.241 * color.r * color.r + 0.691 * color.g * color.g + 0.068 * color.b * color.b);\n        }\n\n        return brightness;\n    }\n\n    function round(value) {\n        var power = math.pow(10, 4);\n        return math.round(value * power) / power;\n    }\n\n    dataviz.ui.plugin(TreeMap);\n\n})(window.kendo.jQuery);\n\nreturn window.kendo;\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3) { (a3 || a2)(); });\n\n"],"names":["define","__meta__","id","name","category","description","depends","$","window","kendo","jQuery","undefined","math","Math","isArray","Array","outerHeight","_outerHeight","outerWidth","_outerWidth","Class","Widget","ui","template","deepExtend","HierarchicalDataSource","data","getter","dataviz","NS","CHANGE","DATA_BOUND","ITEM_CREATED","MAX_VALUE","Number","MOUSEOVER_NS","MOUSELEAVE_NS","UNDEFINED","TreeMap","extend","init","element","options","destroy","empty","fn","call","this","wrapper","_initTheme","addClass","_setLayout","_originalOptions","_initDataSource","_attachEvents","notify","theme","autoBind","textField","valueField","colorField","events","that","themes","themeName","toLowerCase","themeOptions","treeMap","on","_mouseover","bind","_mouseleave","_resizeHandler","resize","onResize","type","_layout","SliceAndDice","_view","SliceAndDiceView","Squarified","SquarifiedView","dataSource","_dataChangeHandler","_onDataChange","create","fetch","setDataSource","unbind","e","node","items","item","i","_cleanItems","_wrapItem","createRoot","_root","_colorIdx","length","root","_getByUid","uid","children","Query","_sortForGrouping","push","htmlSize","compute","coord","_setColors","render","load","trigger","angular","elements","find","colors","colorIdx","color","colorRange","colorsByLength","leafNodes","defined","dataItem","hasChildren","_contentSize","view","renderHeight","wrap","value","getField","text","level","pop","concat","attr","getByUid","findByUid","target","hasClass","_removeActiveState","removeClass","off","unbindResize","getSize","dimensions","_resize","rootElement","width","height","css","_resizeItems","child","childElement","titleSize","idx","filter","setItemSize","setOptions","_setEvents","top","left","leaf","tree","layoutChildren","parentArea","totalArea","itemsArea","parseFloat","area","minimumSideValue","layoutHorizontal","firstElement","tail","slice","squarify","initElement","computeDim","layoutLast","layoutRow","worstAspectRatio","newCoords","dim","w","layoutV","layoutH","orientation","layoutVertical","layoutChange","areaSum","maxArea","minArea","max","rootCoord","newRootCoord","_totalArea","round","ans","min","total","offset","_clean","_getText","title","_createTitle","append","_compile","_createWrap","innerWidth","rootWrap","htmlElement","_createLeaf","_createTile","toggleClass","_tileColorBrightness","toggle","html","tile","_itemCoordinates","coordinates","_renderTemplate","titleTemplate","colorBrightness","vertical","quotient","sliceAndDice","size","field","row","get","minRGBtoDecimal","rgbToDecimal","maxRGBtoDecimal","isDarker","rgbColor","r","colorByIndex","g","b","buildColorFromRGB","index","minColor","abs","maxColor","step","currentStep","decimalToRgb","replace","colorToRGB","rgbToHex","number","result","toString","toUpperCase","colorLength","substring","rgb","parseInt","brightness","sqrt","power","pow","plugin","amd","a1","a2","a3"],"mappings":"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"}