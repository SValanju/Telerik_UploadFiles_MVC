{"version":3,"file":"kendo.ooxml.min.js","sources":["kendo.ooxml.js"],"sourcesContent":["(function(f, define){\n    define('ooxml/utils',[\n        \"kendo.core\"\n    ], f);\n})(function(){\n\n(function () {\n\n/* global JSZip */\n\nkendo.ooxml = kendo.ooxml || {};\n\nkendo.ooxml.createZip = function() {\n    if (typeof JSZip === \"undefined\") {\n       throw new Error(\"JSZip not found. Check http://docs.telerik.com/kendo-ui/framework/excel/introduction#requirements for more details.\");\n    }\n\n    return new JSZip();\n};\n\n})();\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3){ (a3 || a2)(); });\n\n/***********************************************************************\n * WARNING: this file is auto-generated.  If you change it directly,\n * your modifications will eventually be lost.  The source code is in\n * `kendo-ooxml` repository, you should make your changes there and\n * run `src-modules/sync.sh` in this repository.\n */\n(function(f, define){\n    define('ooxml/kendo-ooxml',[\n        \"kendo.core\",\n        \"./utils\"\n    ], f);\n})(function(){\n\n(function ($) {\n/* jshint eqnull:true */\n/* jshint laxbreak:true */\n\nwindow.kendo.ooxml = window.kendo.ooxml || {};\nvar ooxml = kendo.ooxml;\n\nvar map = $.map;\nvar createZip = ooxml.createZip;\n\nvar current = {\n    toString: function (value) { return value; }\n};\n\nvar IntlService = kendo.Class.extend({\n\n});\n\nIntlService.register = function(userImplementation) {\n    current = userImplementation;\n};\n\nIntlService.toString = function(value, format) {\n    return current.toString(value, format);\n};\n\n// date packing utilities from Kendo Spreadsheet\n\n// Julian days algorithms from http://www.hermetic.ch/cal_stud/jdn.htm#comp\nfunction dateToJulianDays(y, m, d) {\n    return ((1461 * (y + 4800 + ((m - 13) / 12 | 0))) / 4 | 0) +\n        ((367 * (m - 1 - 12 * ((m - 13) / 12 | 0))) / 12 | 0) -\n        ((3 * (((y + 4900 + ((m - 13) / 12 | 0)) / 100 | 0))) / 4 | 0) +\n        d - 32075;\n}\n\n// This uses the Google Spreadsheet approach: treat 1899-12-31 as day 1, allowing to avoid\n// implementing the \"Leap Year Bug\" yet still be Excel compatible for dates starting 1900-03-01.\nvar BASE_DATE = dateToJulianDays(1900, 0, -1);\n\nfunction packDate(year, month, date) {\n    return dateToJulianDays(year, month, date) - BASE_DATE;\n}\n\nfunction packTime(hh, mm, ss, ms) {\n    return (hh + (mm + (ss + ms / 1000) / 60) / 60) / 24;\n}\n\nfunction dateToSerial(date) {\n    var time = packTime(date.getHours(),\n                          date.getMinutes(),\n                          date.getSeconds(),\n                          date.getMilliseconds());\n    var serial = packDate(date.getFullYear(),\n                            date.getMonth(),\n                            date.getDate());\n    return serial < 0 ? serial - 1 + time : serial + time;\n}\n\nvar MIME_TYPE = \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\";\nvar DATA_URL_PREFIX = \"data:\" + MIME_TYPE + \";base64,\";\nvar DATA_URL_OPTIONS = { compression: \"DEFLATE\", type: \"base64\" };\nvar BLOB_OPTIONS = { compression: \"DEFLATE\", type: \"blob\" };\nvar ARRAYBUFFER_OPTIONS = { compression: \"DEFLATE\", type: \"arraybuffer\" };\n\n/* eslint-disable key-spacing, no-arrow-condition, indent, no-nested-ternary, consistent-return */\n\nfunction toDataURI(content) {\n    return DATA_URL_PREFIX + content;\n}\n\nfunction indexOf(thing, array) {\n    return array.indexOf(thing);\n}\n\nvar parseJSON = JSON.parse.bind(JSON);\n\nfunction ESC(val) {\n    return String(val)\n        .replace(/&/g, \"&amp;\")\n        .replace(/</g, \"&lt;\")\n        .replace(/>/g, \"&gt;\")\n        .replace(/\\\"/g, \"&quot;\")\n        .replace(/\\'/g, \"&#39;\");\n}\n\nfunction repeat(count, func) {\n    var str = \"\";\n    for (var i = 0; i < count; ++i) {\n        str += func(i);\n    }\n    return str;\n}\n\nfunction foreach(arr, func) {\n    var str = \"\";\n    if (arr != null) {\n        if (Array.isArray(arr)) {\n            for (var i = 0; i < arr.length; ++i) {\n                str += func(arr[i], i);\n            }\n        } else if (typeof arr == \"object\") {\n            Object.keys(arr).forEach(function (key, i) {\n                str += func(arr[key], key, i);\n            });\n        }\n    }\n    return str;\n}\n\nvar XMLHEAD = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r';\n\nvar RELS = XMLHEAD + \"\\n            <Relationships xmlns=\\\"http://schemas.openxmlformats.org/package/2006/relationships\\\">\\n               <Relationship Id=\\\"rId3\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties\\\" Target=\\\"docProps/app.xml\\\"/>\\n               <Relationship Id=\\\"rId2\\\" Type=\\\"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties\\\" Target=\\\"docProps/core.xml\\\"/>\\n               <Relationship Id=\\\"rId1\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\\\" Target=\\\"xl/workbook.xml\\\"/>\\n            </Relationships>\";\n\nvar CORE = function (ref) {\n  var creator = ref.creator;\n  var lastModifiedBy = ref.lastModifiedBy;\n  var created = ref.created;\n  var modified = ref.modified;\n\n  return (XMLHEAD + \"\\n <cp:coreProperties xmlns:cp=\\\"http://schemas.openxmlformats.org/package/2006/metadata/core-properties\\\"\\n   xmlns:dc=\\\"http://purl.org/dc/elements/1.1/\\\" xmlns:dcterms=\\\"http://purl.org/dc/terms/\\\"\\n   xmlns:dcmitype=\\\"http://purl.org/dc/dcmitype/\\\" xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\">\\n   <dc:creator>\" + (ESC(creator)) + \"</dc:creator>\\n   <cp:lastModifiedBy>\" + (ESC(lastModifiedBy)) + \"</cp:lastModifiedBy>\\n   <dcterms:created xsi:type=\\\"dcterms:W3CDTF\\\">\" + (ESC(created)) + \"</dcterms:created>\\n   <dcterms:modified xsi:type=\\\"dcterms:W3CDTF\\\">\" + (ESC(modified)) + \"</dcterms:modified>\\n</cp:coreProperties>\");\n};\n\nvar APP = function (ref) {\n  var sheets = ref.sheets;\n\n  return (XMLHEAD + \"\\n<Properties xmlns=\\\"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\\\" xmlns:vt=\\\"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes\\\">\\n  <Application>Microsoft Excel</Application>\\n  <DocSecurity>0</DocSecurity>\\n  <ScaleCrop>false</ScaleCrop>\\n  <HeadingPairs>\\n    <vt:vector size=\\\"2\\\" baseType=\\\"variant\\\">\\n      <vt:variant>\\n        <vt:lpstr>Worksheets</vt:lpstr>\\n      </vt:variant>\\n      <vt:variant>\\n        <vt:i4>\" + (sheets.length) + \"</vt:i4>\\n      </vt:variant>\\n    </vt:vector>\\n  </HeadingPairs>\\n  <TitlesOfParts>\\n    <vt:vector size=\\\"\" + (sheets.length) + \"\\\" baseType=\\\"lpstr\\\">\" + (foreach(sheets, function (sheet, i) { return sheet.options.title\n          ? (\"<vt:lpstr>\" + (ESC(sheet.options.title)) + \"</vt:lpstr>\")\n          : (\"<vt:lpstr>Sheet\" + (i + 1) + \"</vt:lpstr>\"); }\n      )) + \"</vt:vector>\\n  </TitlesOfParts>\\n  <LinksUpToDate>false</LinksUpToDate>\\n  <SharedDoc>false</SharedDoc>\\n  <HyperlinksChanged>false</HyperlinksChanged>\\n  <AppVersion>14.0300</AppVersion>\\n</Properties>\");\n};\n\nvar CONTENT_TYPES = function (ref) {\n  var sheetCount = ref.sheetCount;\n  var commentFiles = ref.commentFiles;\n  var drawingFiles = ref.drawingFiles;\n\n  return (XMLHEAD + \"\\n<Types xmlns=\\\"http://schemas.openxmlformats.org/package/2006/content-types\\\">\\n  <Default Extension=\\\"png\\\" ContentType=\\\"image/png\\\"/>\\n  <Default Extension=\\\"gif\\\" ContentType=\\\"image/gif\\\"/>\\n  <Default Extension=\\\"jpg\\\" ContentType=\\\"image/jpeg\\\"/>\\n  <Default Extension=\\\"rels\\\" ContentType=\\\"application/vnd.openxmlformats-package.relationships+xml\\\" />\\n  <Default Extension=\\\"xml\\\" ContentType=\\\"application/xml\\\" />\\n  <Default Extension=\\\"vml\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.vmlDrawing\\\"/>\\n  <Override PartName=\\\"/xl/workbook.xml\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\\\" />\\n  <Override PartName=\\\"/xl/styles.xml\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\\\"/>\\n  <Override PartName=\\\"/xl/sharedStrings.xml\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\\\"/>\\n  \" + (repeat(sheetCount, function (idx) { return (\"<Override PartName=\\\"/xl/worksheets/sheet\" + (idx + 1) + \".xml\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\\\" />\"); })) + \"\\n  \" + (foreach(commentFiles, function (filename) { return (\"<Override PartName=\\\"/xl/\" + filename + \"\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml\\\"/>\"); })) + \"\\n  \" + (foreach(drawingFiles, function (filename) { return (\"<Override PartName=\\\"/xl/drawings/\" + filename + \"\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.drawing+xml\\\"/>\"); })) + \"\\n  <Override PartName=\\\"/docProps/core.xml\\\" ContentType=\\\"application/vnd.openxmlformats-package.core-properties+xml\\\" />\\n  <Override PartName=\\\"/docProps/app.xml\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.extended-properties+xml\\\" />\\n</Types>\");\n};\n\nvar WORKBOOK = function (ref) {\n  var sheets = ref.sheets;\n  var filterNames = ref.filterNames;\n  var userNames = ref.userNames;\n\n  return (XMLHEAD + \"\\n<workbook xmlns=\\\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\\\" xmlns:r=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\\\">\\n  <fileVersion appName=\\\"xl\\\" lastEdited=\\\"5\\\" lowestEdited=\\\"5\\\" rupBuild=\\\"9303\\\" />\\n  <workbookPr defaultThemeVersion=\\\"124226\\\" />\\n  <bookViews>\\n    <workbookView xWindow=\\\"240\\\" yWindow=\\\"45\\\" windowWidth=\\\"18195\\\" windowHeight=\\\"7995\\\" />\\n  </bookViews>\\n  <sheets>\\n  \" + (foreach(sheets, function (ref, i) {\n    var options = ref.options;\n\n    var name = options.name || options.title || (\"Sheet\" + (i + 1));\n    return (\"<sheet name=\\\"\" + (ESC(name)) + \"\\\" sheetId=\\\"\" + (i + 1) + \"\\\" r:id=\\\"rId\" + (i + 1) + \"\\\" />\");\n  })) + \"\\n  </sheets>\\n  \" + (filterNames.length || userNames.length ? (\"\\n    <definedNames>\\n      \" + (foreach(filterNames, function (f) { return (\"\\n         <definedName name=\\\"_xlnm._FilterDatabase\\\" hidden=\\\"1\\\" localSheetId=\\\"\" + (f.localSheetId) + \"\\\">\" + (ESC(quoteSheet(f.name))) + \"!\" + (ESC(f.from)) + \":\" + (ESC(f.to)) + \"</definedName>\"); })) + \"\\n      \" + (foreach(userNames, function (f) { return (\"\\n         <definedName name=\\\"\" + (f.name) + \"\\\" hidden=\\\"\" + (f.hidden ? 1 : 0) + \"\\\" \" + (f.localSheetId != null ? (\"localSheetId=\\\"\" + (f.localSheetId) + \"\\\"\") : '') + \">\" + (ESC(f.value)) + \"</definedName>\"); })) + \"\\n    </definedNames>\") : '') + \"\\n  <calcPr fullCalcOnLoad=\\\"1\\\" calcId=\\\"145621\\\" />\\n</workbook>\");\n};\n\nvar WORKSHEET = function (ref$1) {\n  var frozenColumns = ref$1.frozenColumns;\n  var frozenRows = ref$1.frozenRows;\n  var columns = ref$1.columns;\n  var defaults = ref$1.defaults;\n  var data = ref$1.data;\n  var index = ref$1.index;\n  var mergeCells = ref$1.mergeCells;\n  var autoFilter = ref$1.autoFilter;\n  var filter = ref$1.filter;\n  var showGridLines = ref$1.showGridLines;\n  var hyperlinks = ref$1.hyperlinks;\n  var validations = ref$1.validations;\n  var defaultCellStyleId = ref$1.defaultCellStyleId;\n  var rtl = ref$1.rtl;\n  var legacyDrawing = ref$1.legacyDrawing;\n  var drawing = ref$1.drawing;\n  var lastRow = ref$1.lastRow;\n  var lastCol = ref$1.lastCol;\n\n  return (XMLHEAD + \"\\n<worksheet xmlns=\\\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\\\" xmlns:mc=\\\"http://schemas.openxmlformats.org/markup-compatibility/2006\\\" xmlns:r=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\\\" xmlns:x14ac=\\\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\\\" mc:Ignorable=\\\"x14ac\\\">\\n   \" + (lastRow && lastCol ? (\"<dimension ref=\\\"A1:\" + (ref(lastRow - 1, lastCol - 1)) + \"\\\" />\") : \"\") + \"\\n\\n   <sheetViews>\\n     <sheetView \" + (rtl ? 'rightToLeft=\"1\"' : '') + \" \" + (index === 0 ? 'tabSelected=\"1\"' : '') + \" workbookViewId=\\\"0\\\" \" + (showGridLines === false ? 'showGridLines=\"0\"' : '') + \">\\n     \" + (frozenRows || frozenColumns ? (\"\\n       <pane state=\\\"frozen\\\"\\n         \" + (frozenColumns ? (\"xSplit=\\\"\" + frozenColumns + \"\\\"\") : '') + \"\\n         \" + (frozenRows ? (\"ySplit=\\\"\" + frozenRows + \"\\\"\") : '') + \"\\n         topLeftCell=\\\"\" + (String.fromCharCode(65 + (frozenColumns || 0)) + ((frozenRows || 0) + 1)) + \"\\\"\\n       />\") : '') + \"\\n     </sheetView>\\n   </sheetViews>\\n\\n   <sheetFormatPr x14ac:dyDescent=\\\"0.25\\\" \" + (!defaults.skipCustomHeight ? 'customHeight=\"1\"' : '') + \" defaultRowHeight=\\\"\" + (defaults.rowHeight ? defaults.rowHeight * 0.75 : 15) + \"\\\"\\n     \" + (defaults.columnWidth ? (\"defaultColWidth=\\\"\" + (toWidth(defaults.columnWidth)) + \"\\\"\") : '') + \" />\\n\\n   \" + (defaultCellStyleId != null || (columns && columns.length > 0) ? (\"\\n     <cols>\\n       \" + (!columns || !columns.length ? (\"\\n         <col min=\\\"1\\\" max=\\\"16384\\\" style=\\\"\" + defaultCellStyleId + \"\\\"\\n              \" + (defaults.columnWidth ? (\"width=\\\"\" + (toWidth(defaults.columnWidth)) + \"\\\"\") : '') + \" /> \") : '') + \"\\n       \" + (foreach(columns, function (column, ci) {\n         var columnIndex = typeof column.index === \"number\" ? column.index + 1 : (ci + 1);\n         if (column.width === 0) {\n           return (\"<col \" + (defaultCellStyleId != null ? (\"style=\\\"\" + defaultCellStyleId + \"\\\"\") : '') + \"\\n                        min=\\\"\" + columnIndex + \"\\\" max=\\\"\" + columnIndex + \"\\\" hidden=\\\"1\\\" customWidth=\\\"1\\\" />\");\n         }\n         return (\"<col \" + (defaultCellStyleId != null ? (\"style=\\\"\" + defaultCellStyleId + \"\\\"\") : '') + \"\\n                      min=\\\"\" + columnIndex + \"\\\" max=\\\"\" + columnIndex + \"\\\" customWidth=\\\"1\\\"\\n                      \" + (column.autoWidth\n                          ? (\"width=\\\"\" + (((column.width * 7 + 5) / 7 * 256) / 256) + \"\\\" bestFit=\\\"1\\\"\")\n                          : (\"width=\\\"\" + (toWidth(column.width)) + \"\\\"\")) + \" />\");\n       })) + \"\\n     </cols>\") : '') + \"\\n\\n   <sheetData>\\n     \" + (foreach(data, function (row, ri) {\n       var rowIndex = typeof row.index === \"number\" ? row.index + 1 : (ri + 1);\n       return (\"\\n         <row r=\\\"\" + rowIndex + \"\\\" x14ac:dyDescent=\\\"0.25\\\"\\n              \" + (row.level ? (\"outlineLevel=\\\"\" + (row.level) + \"\\\"\") : '') + \"\\n              \" + (row.height === 0 ? 'hidden=\"1\"'\n                                 : row.height ? (\"ht=\\\"\" + (toHeight(row.height)) + \"\\\" customHeight=\\\"1\\\"\") : \"\") + \">\\n           \" + (foreach(row.data, function (cell) { return (\"\\n             <c r=\\\"\" + (cell.ref) + \"\\\" \" + (cell.style ? (\"s=\\\"\" + (cell.style) + \"\\\"\") : '') + \" \" + (cell.type ? (\"t=\\\"\" + (cell.type) + \"\\\"\") : '') + \">\\n               \" + (cell.formula != null ? writeFormula(cell.formula) : '') + \"\\n               \" + (cell.value != null ? (\"<v>\" + (ESC(cell.value)) + \"</v>\") : '') + \"\\n             </c>\"); })) + \"\\n         </row>\\n       \");})) + \"\\n   </sheetData>\\n\\n   \" + (autoFilter ? (\"<autoFilter ref=\\\"\" + (autoFilter.from) + \":\" + (autoFilter.to) + \"\\\"/>\")\n                : filter ? spreadsheetFilters(filter) : '') + \"\\n\\n   \" + (mergeCells.length ? (\"\\n     <mergeCells count=\\\"\" + (mergeCells.length) + \"\\\">\\n       \" + (foreach(mergeCells, function (ref) { return (\"<mergeCell ref=\\\"\" + ref + \"\\\"/>\"); })) + \"\\n     </mergeCells>\") : '') + \"\\n\\n   \" + (validations.length ? (\"\\n     <dataValidations>\\n       \" + (foreach(validations, function (val) { return (\"\\n         <dataValidation sqref=\\\"\" + (val.sqref.join(\" \")) + \"\\\"\\n                         showErrorMessage=\\\"\" + (val.showErrorMessage) + \"\\\"\\n                         type=\\\"\" + (ESC(val.type)) + \"\\\"\\n                         \" + (val.type !== \"list\" ? (\"operator=\\\"\" + (ESC(val.operator)) + \"\\\"\") : '') + \"\\n                         allowBlank=\\\"\" + (val.allowBlank) + \"\\\"\\n                         showDropDown=\\\"\" + (val.showDropDown) + \"\\\"\\n                         \" + (val.error ? (\"error=\\\"\" + (ESC(val.error)) + \"\\\"\") : '') + \"\\n                         \" + (val.errorTitle ? (\"errorTitle=\\\"\" + (ESC(val.errorTitle)) + \"\\\"\") : '') + \">\\n           \" + (val.formula1 ? (\"<formula1>\" + (ESC(val.formula1)) + \"</formula1>\") : '') + \"\\n           \" + (val.formula2 ? (\"<formula2>\" + (ESC(val.formula2)) + \"</formula2>\") : '') + \"\\n         </dataValidation>\"); })) + \"\\n     </dataValidations>\") : '') + \"\\n\\n   \" + (hyperlinks.length ? (\"\\n     <hyperlinks>\\n       \" + (foreach(hyperlinks, function (link) { return (\"\\n         <hyperlink ref=\\\"\" + (link.ref) + \"\\\" r:id=\\\"\" + (link.rId) + \"\\\"/>\"); })) + \"\\n     </hyperlinks>\") : '') + \"\\n\\n   <pageMargins left=\\\"0.7\\\" right=\\\"0.7\\\" top=\\\"0.75\\\" bottom=\\\"0.75\\\" header=\\\"0.3\\\" footer=\\\"0.3\\\" />\\n   \" + (drawing ? (\"<drawing r:id=\\\"\" + drawing + \"\\\"/>\") : '') + \"\\n   \" + (legacyDrawing ? (\"<legacyDrawing r:id=\\\"\" + legacyDrawing + \"\\\"/>\") : '') + \"\\n</worksheet>\");\n};\n\nvar WORKBOOK_RELS = function (ref) {\n  var count = ref.count;\n\n  return (XMLHEAD + \"\\n<Relationships xmlns=\\\"http://schemas.openxmlformats.org/package/2006/relationships\\\">\\n  \" + (repeat(count, function (idx) { return (\"\\n    <Relationship Id=\\\"rId\" + (idx + 1) + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\\\" Target=\\\"worksheets/sheet\" + (idx + 1) + \".xml\\\" />\"); })) + \"\\n  <Relationship Id=\\\"rId\" + (count + 1) + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\\\" Target=\\\"styles.xml\\\" />\\n  <Relationship Id=\\\"rId\" + (count + 2) + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings\\\" Target=\\\"sharedStrings.xml\\\" />\\n</Relationships>\");\n};\n\nvar WORKSHEET_RELS = function (ref) {\n  var hyperlinks = ref.hyperlinks;\n  var comments = ref.comments;\n  var sheetIndex = ref.sheetIndex;\n  var drawings = ref.drawings;\n\n  return (XMLHEAD + \"\\n<Relationships xmlns=\\\"http://schemas.openxmlformats.org/package/2006/relationships\\\">\\n  \" + (foreach(hyperlinks, function (link) { return (\"\\n    <Relationship Id=\\\"\" + (link.rId) + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink\\\" Target=\\\"\" + (ESC(link.target)) + \"\\\" TargetMode=\\\"External\\\" />\"); })) + \"\\n  \" + (!comments.length ? '' : (\"\\n    <Relationship Id=\\\"comment\" + sheetIndex + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments\\\" Target=\\\"../comments\" + sheetIndex + \".xml\\\"/>\\n    <Relationship Id=\\\"vml\" + sheetIndex + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing\\\" Target=\\\"../drawings/vmlDrawing\" + sheetIndex + \".vml\\\"/>\")) + \"\\n  \" + (!drawings.length ? '' : (\"\\n    <Relationship Id=\\\"drw\" + sheetIndex + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing\\\" Target=\\\"../drawings/drawing\" + sheetIndex + \".xml\\\"/>\")) + \"\\n</Relationships>\");\n};\n\nvar COMMENTS_XML = function (ref) {\n  var comments = ref.comments;\n\n  return (XMLHEAD + \"\\n<comments xmlns=\\\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\\\">\\n  <authors>\\n    <author></author>\\n  </authors>\\n  <commentList>\\n    \" + (foreach(comments, function (comment) { return (\"\\n      <comment ref=\\\"\" + (comment.ref) + \"\\\" authorId=\\\"0\\\">\\n        <text>\\n          <r>\\n            <rPr>\\n              <sz val=\\\"8\\\"/>\\n              <color indexed=\\\"81\\\"/>\\n              <rFont val=\\\"Tahoma\\\"/>\\n              <charset val=\\\"1\\\"/>\\n            </rPr>\\n            <t>\" + (ESC(comment.text)) + \"</t>\\n          </r>\\n        </text>\\n      </comment>\"); })) + \"\\n  </commentList>\\n</comments>\");\n};\n\nvar LEGACY_DRAWING = function (ref) {\n  var comments = ref.comments;\n\n  return (\"<xml xmlns:v=\\\"urn:schemas-microsoft-com:vml\\\"\\n     xmlns:o=\\\"urn:schemas-microsoft-com:office:office\\\"\\n     xmlns:x=\\\"urn:schemas-microsoft-com:office:excel\\\">\\n  <v:shapetype coordsize=\\\"21600,21600\\\" id=\\\"_x0000_t202\\\" path=\\\"m,l,21600r21600,l21600,xe\\\">\\n    <v:stroke joinstyle=\\\"miter\\\"/>\\n    <v:path gradientshapeok=\\\"t\\\" o:connecttype=\\\"rect\\\"/>\\n  </v:shapetype>\\n  \" + (foreach(comments, function (comment) { return (\"\\n    <v:shape type=\\\"#_x0000_t202\\\" style=\\\"visibility: hidden\\\" fillcolor=\\\"#ffffe1\\\" o:insetmode=\\\"auto\\\">\\n      <v:shadow on=\\\"t\\\" color=\\\"black\\\" obscured=\\\"t\\\"/>\\n      <x:ClientData ObjectType=\\\"Note\\\">\\n        <x:MoveWithCells/>\\n        <x:SizeWithCells/>\\n        <x:Anchor>\" + (comment.anchor) + \"</x:Anchor>\\n        <x:AutoFill>False</x:AutoFill>\\n        <x:Row>\" + (comment.row) + \"</x:Row>\\n        <x:Column>\" + (comment.col) + \"</x:Column>\\n      </x:ClientData>\\n    </v:shape>\"); })) + \"\\n</xml>\");\n};\n\nvar DRAWINGS_XML = function (drawings) { return (XMLHEAD + \"\\n<xdr:wsDr xmlns:xdr=\\\"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing\\\"\\n          xmlns:a=\\\"http://schemas.openxmlformats.org/drawingml/2006/main\\\"\\n          xmlns:r=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\\\">\\n  \" + (foreach(drawings, function (drawing, index) { return (\"\\n    <xdr:oneCellAnchor editAs=\\\"oneCell\\\">\\n      <xdr:from>\\n        <xdr:col>\" + (drawing.col) + \"</xdr:col>\\n        <xdr:colOff>\" + (drawing.colOffset) + \"</xdr:colOff>\\n        <xdr:row>\" + (drawing.row) + \"</xdr:row>\\n        <xdr:rowOff>\" + (drawing.rowOffset) + \"</xdr:rowOff>\\n      </xdr:from>\\n      <xdr:ext cx=\\\"\" + (drawing.width) + \"\\\" cy=\\\"\" + (drawing.height) + \"\\\" />\\n      <xdr:pic>\\n        <xdr:nvPicPr>\\n          <xdr:cNvPr id=\\\"\" + (index + 1) + \"\\\" name=\\\"Picture \" + (index + 1) + \"\\\"/>\\n          <xdr:cNvPicPr/>\\n        </xdr:nvPicPr>\\n        <xdr:blipFill>\\n          <a:blip r:embed=\\\"\" + (drawing.imageId) + \"\\\"/>\\n          <a:stretch>\\n            <a:fillRect/>\\n          </a:stretch>\\n        </xdr:blipFill>\\n        <xdr:spPr>\\n          <a:prstGeom prst=\\\"rect\\\">\\n            <a:avLst/>\\n          </a:prstGeom>\\n        </xdr:spPr>\\n      </xdr:pic>\\n      <xdr:clientData/>\\n    </xdr:oneCellAnchor>\"); })) + \"\\n</xdr:wsDr>\"); };\n\nvar DRAWINGS_RELS_XML = function (rels) { return (XMLHEAD + \"\\n<Relationships xmlns=\\\"http://schemas.openxmlformats.org/package/2006/relationships\\\">\\n  \" + (foreach(rels, function (rel) { return (\"\\n    <Relationship Id=\\\"\" + (rel.rId) + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\\\" Target=\\\"\" + (rel.target) + \"\\\"/>\"); })) + \"\\n</Relationships>\"); };\n\nvar SHARED_STRINGS = function (ref) {\n  var count = ref.count;\n  var uniqueCount = ref.uniqueCount;\n  var indexes = ref.indexes;\n\n  return (XMLHEAD + \"\\n<sst xmlns=\\\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\\\" count=\\\"\" + count + \"\\\" uniqueCount=\\\"\" + uniqueCount + \"\\\">\\n  \" + (foreach(Object.keys(indexes), function (index) { return (\"\\n    <si><t xml:space=\\\"preserve\\\">\" + (ESC(index.substring(1))) + \"</t></si>\"); })) + \"\\n</sst>\");\n};\n\nvar STYLES = function (ref) {\n  var formats = ref.formats;\n  var fonts = ref.fonts;\n  var fills = ref.fills;\n  var borders = ref.borders;\n  var styles = ref.styles;\n\n  return (XMLHEAD + \"\\n<styleSheet\\n    xmlns=\\\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\\\"\\n    xmlns:mc=\\\"http://schemas.openxmlformats.org/markup-compatibility/2006\\\"\\n    mc:Ignorable=\\\"x14ac\\\"\\n    xmlns:x14ac=\\\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\\\">\\n  <numFmts count=\\\"\" + (formats.length) + \"\\\">\\n  \" + (foreach(formats, function (format, fi) { return (\"\\n    <numFmt formatCode=\\\"\" + (ESC(format.format)) + \"\\\" numFmtId=\\\"\" + (165 + fi) + \"\\\" />\"); })) + \"\\n  </numFmts>\\n  <fonts count=\\\"\" + (fonts.length + 1) + \"\\\" x14ac:knownFonts=\\\"1\\\">\\n    <font>\\n       <sz val=\\\"11\\\" />\\n       <color theme=\\\"1\\\" />\\n       <name val=\\\"Calibri\\\" />\\n       <family val=\\\"2\\\" />\\n       <scheme val=\\\"minor\\\" />\\n    </font>\\n    \" + (foreach(fonts, function (font) { return (\"\\n    <font>\\n      \" + (font.bold ? '<b/>' : '') + \"\\n      \" + (font.italic ? '<i/>' : '') + \"\\n      \" + (font.underline ? '<u/>' : '') + \"\\n      <sz val=\\\"\" + (font.fontSize || 11) + \"\\\" />\\n      \" + (font.color ? (\"<color rgb=\\\"\" + (ESC(font.color)) + \"\\\" />\") : '<color theme=\"1\" />') + \"\\n      \" + (font.fontFamily ? (\"\\n        <name val=\\\"\" + (ESC(font.fontFamily)) + \"\\\" />\\n        <family val=\\\"2\\\" />\\n      \") : \"\\n        <name val=\\\"Calibri\\\" />\\n        <family val=\\\"2\\\" />\\n        <scheme val=\\\"minor\\\" />\\n      \") + \"\\n    </font>\"); })) + \"\\n  </fonts>\\n  <fills count=\\\"\" + (fills.length + 2) + \"\\\">\\n      <fill><patternFill patternType=\\\"none\\\"/></fill>\\n      <fill><patternFill patternType=\\\"gray125\\\"/></fill>\\n    \" + (foreach(fills, function (fill) { return (\"\\n      \" + (fill.background ? (\"\\n        <fill>\\n          <patternFill patternType=\\\"solid\\\">\\n              <fgColor rgb=\\\"\" + (ESC(fill.background)) + \"\\\"/>\\n          </patternFill>\\n        </fill>\\n      \") : '')); })) + \"\\n  </fills>\\n  <borders count=\\\"\" + (borders.length + 1) + \"\\\">\\n    <border><left/><right/><top/><bottom/><diagonal/></border>\\n    \" + (foreach(borders, borderTemplate)) + \"\\n  </borders>\\n  <cellStyleXfs count=\\\"1\\\">\\n    <xf borderId=\\\"0\\\" fillId=\\\"0\\\" fontId=\\\"0\\\" />\\n  </cellStyleXfs>\\n  <cellXfs count=\\\"\" + (styles.length + 1) + \"\\\">\\n    <xf numFmtId=\\\"0\\\" fontId=\\\"0\\\" fillId=\\\"0\\\" borderId=\\\"0\\\" xfId=\\\"0\\\" />\\n    \" + (foreach(styles, function (style) { return (\"\\n      <xf xfId=\\\"0\\\"\\n          \" + (style.fontId ? (\"fontId=\\\"\" + (style.fontId) + \"\\\" applyFont=\\\"1\\\"\") : '') + \"\\n          \" + (style.fillId ? (\"fillId=\\\"\" + (style.fillId) + \"\\\" applyFill=\\\"1\\\"\") : '') + \"\\n          \" + (style.numFmtId ? (\"numFmtId=\\\"\" + (style.numFmtId) + \"\\\" applyNumberFormat=\\\"1\\\"\") : '') + \"\\n          \" + (style.textAlign || style.verticalAlign || style.wrap ? 'applyAlignment=\"1\"' : '') + \"\\n          \" + (style.borderId ? (\"borderId=\\\"\" + (style.borderId) + \"\\\" applyBorder=\\\"1\\\"\") : '') + \">\\n        \" + (style.textAlign || style.verticalAlign || style.wrap ? (\"\\n        <alignment\\n          \" + (style.textAlign ? (\"horizontal=\\\"\" + (ESC(style.textAlign)) + \"\\\"\") : '') + \"\\n          \" + (style.verticalAlign ? (\"vertical=\\\"\" + (ESC(style.verticalAlign)) + \"\\\"\") : '') + \"\\n          \" + (style.indent ? (\"indent=\\\"\" + (ESC(style.indent)) + \"\\\"\") : '') + \"\\n          \" + (style.wrap ? 'wrapText=\"1\"' : '') + \" />\\n        \") : '') + \"\\n      </xf>\\n    \"); })) + \"\\n  </cellXfs>\\n  <cellStyles count=\\\"1\\\">\\n    <cellStyle name=\\\"Normal\\\" xfId=\\\"0\\\" builtinId=\\\"0\\\"/>\\n  </cellStyles>\\n  <dxfs count=\\\"0\\\" />\\n  <tableStyles count=\\\"0\\\" defaultTableStyle=\\\"TableStyleMedium2\\\" defaultPivotStyle=\\\"PivotStyleMedium9\\\" />\\n</styleSheet>\");\n};\n\nfunction writeFormula(formula) {\n    if (typeof formula == \"string\") {\n        return (\"<f>\" + (ESC(formula)) + \"</f>\");\n    }\n    // array formulas\n    return (\"<f t=\\\"array\\\" ref=\\\"\" + (formula.ref) + \"\\\">\" + (ESC(formula.src)) + \"</f>\");\n}\n\nfunction numChar(colIndex) {\n   var letter = Math.floor(colIndex / 26) - 1;\n\n   return (letter >= 0 ? numChar(letter) : \"\") + String.fromCharCode(65 + (colIndex % 26));\n}\n\nfunction ref(rowIndex, colIndex) {\n    return numChar(colIndex) + (rowIndex + 1);\n}\n\nfunction $ref(rowIndex, colIndex) {\n    return \"$\" + numChar(colIndex) + \"$\" + (rowIndex + 1);\n}\n\nfunction filterRowIndex(options) {\n    var frozenRows = options.frozenRows || (options.freezePane || {}).rowSplit || 1;\n    return frozenRows - 1;\n}\n\nfunction toWidth(px) {\n    var maximumDigitWidth = 7;\n    return (px / maximumDigitWidth) - (Math.floor(128 / maximumDigitWidth) / 256);\n}\n\nfunction toHeight(px) {\n    return px * 0.75;\n}\n\nfunction stripFunnyChars(value) {\n    return String(value)\n        .replace(/[\\x00-\\x09\\x0B\\x0C\\x0E-\\x1F]/g, \"\") // leave CRLF in\n        .replace(/\\r?\\n/g, \"\\r\\n\");                   // make sure LF is preceded by CR\n}\n\nvar Worksheet = kendo.Class.extend({\n    init: function(options, sharedStrings, styles, borders) {\n        this.options = options;\n        this._strings = sharedStrings;\n        this._styles = styles;\n        this._borders = borders;\n        this._validations = {};\n        this._comments = [];\n        this._drawings = options.drawings || [];\n        this._hyperlinks = (this.options.hyperlinks || []).map(\n            function (link, i) { return $.extend({}, link, { rId: (\"link\" + i) }); });\n    },\n\n    relsToXML: function() {\n        var hyperlinks = this._hyperlinks;\n        var comments = this._comments;\n        var drawings = this._drawings;\n\n        if (hyperlinks.length || comments.length || drawings.length) {\n            return WORKSHEET_RELS({\n                hyperlinks : hyperlinks,\n                comments   : comments,\n                sheetIndex : this.options.sheetIndex,\n                drawings   : drawings\n            });\n        }\n    },\n\n    toXML: function(index) {\n        var this$1 = this;\n\n        var mergeCells = this.options.mergedCells || [];\n        var rows = this.options.rows || [];\n        var data = inflate(rows, mergeCells);\n\n        this._readCells(data);\n\n        var autoFilter = this.options.filter;\n        var filter;\n        if (autoFilter && (typeof autoFilter.from === \"number\") && (typeof autoFilter.to === \"number\")) {\n            // Grid enables auto filter\n            autoFilter = {\n                from: ref(filterRowIndex(this.options), autoFilter.from),\n                to: ref(filterRowIndex(this.options), autoFilter.to)\n            };\n        } else if (autoFilter && autoFilter.ref && autoFilter.columns) {\n            // this is probably from the Spreadsheet\n            filter = autoFilter;\n            autoFilter = null;\n        }\n\n        var validations = [];\n        for (var i in this._validations) {\n            if (Object.prototype.hasOwnProperty.call(this$1._validations, i)) {\n                validations.push(this$1._validations[i]);\n            }\n        }\n\n        var defaultCellStyleId = null;\n        if (this.options.defaultCellStyle) {\n            defaultCellStyleId = this._lookupStyle(this.options.defaultCellStyle);\n        }\n\n        var freezePane = this.options.freezePane || {};\n        var defaults = this.options.defaults || {};\n        var lastRow = this.options.rows ? this._getLastRow() : 1;\n        var lastCol = this.options.rows ? this._getLastCol() : 1;\n\n        return WORKSHEET({\n            frozenColumns: this.options.frozenColumns || freezePane.colSplit,\n            frozenRows: this.options.frozenRows || freezePane.rowSplit,\n            columns: this.options.columns,\n            defaults: defaults,\n            data: data,\n            index: index,\n            mergeCells: mergeCells,\n            autoFilter: autoFilter,\n            filter: filter,\n            showGridLines: this.options.showGridLines,\n            hyperlinks: this._hyperlinks,\n            validations: validations,\n            defaultCellStyleId: defaultCellStyleId,\n            rtl: this.options.rtl !== undefined ? this.options.rtl : defaults.rtl,\n            legacyDrawing: this._comments.length ? (\"vml\" + (this.options.sheetIndex)) : null,\n            drawing: this._drawings.length ? (\"drw\" + (this.options.sheetIndex)) : null,\n            lastRow: lastRow,\n            lastCol: lastCol\n        });\n    },\n\n    commentsXML: function() {\n        if (this._comments.length) {\n            return COMMENTS_XML({ comments: this._comments });\n        }\n    },\n\n    drawingsXML: function(images) {\n        if (this._drawings.length) {\n            var rels = {};\n            var main = this._drawings.map(function (drw) {\n                var ref = parseRef(drw.topLeftCell);\n                var img = rels[drw.image];\n                if (!img) {\n                    img = rels[drw.image] = {\n                        rId: (\"img\" + (drw.image)),\n                        target: images[drw.image].target\n                    };\n                }\n                return {\n                    col       : ref.col,\n                    colOffset : pixelsToExcel(drw.offsetX),\n                    row       : ref.row,\n                    rowOffset : pixelsToExcel(drw.offsetY),\n                    width     : pixelsToExcel(drw.width),\n                    height    : pixelsToExcel(drw.height),\n                    imageId   : img.rId\n                };\n            });\n            return {\n                main: DRAWINGS_XML(main),\n                rels: DRAWINGS_RELS_XML(rels)\n            };\n        }\n    },\n\n    legacyDrawing: function() {\n        if (this._comments.length) {\n            return LEGACY_DRAWING({ comments: this._comments });\n        }\n    },\n\n    _lookupString: function(value) {\n        var key = \"$\" + value;\n        var index = this._strings.indexes[key];\n        var result;\n\n        if (index !== undefined) {\n            result = index;\n        } else {\n            result = this._strings.indexes[key] = this._strings.uniqueCount;\n            this._strings.uniqueCount ++;\n        }\n\n        this._strings.count ++;\n\n        return result;\n    },\n\n    _lookupStyle: function(style) {\n        var json = JSON.stringify(style);\n\n        if (json === \"{}\") {\n            return 0;\n        }\n\n        var index = indexOf(json, this._styles);\n\n        if (index < 0) {\n            index = this._styles.push(json) - 1;\n        }\n\n        // There is one default style\n        return index + 1;\n    },\n\n    _lookupBorder: function(border) {\n        var json = JSON.stringify(border);\n        if (json === \"{}\") {\n            return;\n        }\n\n        var index = indexOf(json, this._borders);\n        if (index < 0) {\n            index = this._borders.push(json) - 1;\n        }\n\n        // There is one default border\n        return index + 1;\n    },\n\n    _readCells: function(rowData) {\n        var this$1 = this;\n\n        for (var i = 0; i < rowData.length; i++) {\n            var row = rowData[i];\n            var cells = row.cells;\n\n            row.data = [];\n\n            for (var j = 0; j < cells.length; j++) {\n                var cellData = this$1._cell(cells[j], row.index, j);\n                if (cellData) {\n                    row.data.push(cellData);\n                }\n            }\n        }\n    },\n\n    _cell: function(data, rowIndex, cellIndex) {\n        if (!data || data === EMPTY_CELL) {\n            return null;\n        }\n\n        var value = data.value;\n\n        var border = {};\n\n        if (data.borderLeft) {\n            border.left = data.borderLeft;\n        }\n\n        if (data.borderRight) {\n            border.right = data.borderRight;\n        }\n\n        if (data.borderTop) {\n            border.top = data.borderTop;\n        }\n\n        if (data.borderBottom) {\n            border.bottom = data.borderBottom;\n        }\n\n        border = this._lookupBorder(border);\n\n        var defStyle = this.options.defaultCellStyle || {};\n        var style = { borderId: border };\n\n        (function(add) {\n            add(\"color\");\n            add(\"background\");\n            add(\"bold\");\n            add(\"italic\");\n            add(\"underline\");\n            if (!add(\"fontFamily\")) { add(\"fontName\", \"fontFamily\"); }\n            add(\"fontSize\");\n            add(\"format\");\n            if (!add(\"textAlign\")) { add(\"hAlign\", \"textAlign\"); }\n            if (!add(\"verticalAlign\")) { add(\"vAlign\", \"verticalAlign\"); }\n            add(\"wrap\");\n            add(\"indent\");\n        })(\n            function(prop, target) {\n                var val = data[prop];\n                if (val === undefined) {\n                    val = defStyle[prop];\n                }\n                if (val !== undefined) {\n                    style[target || prop] = val;\n                    return true;\n                }\n            }\n        );\n\n        var columns = this.options.columns || [];\n\n        var column = columns[cellIndex];\n        var type = typeof value;\n\n        if (column && column.autoWidth && (!data.colSpan || data.colSpan === 1)) {\n            var displayValue = value;\n\n            // XXX: let's not bring kendo.toString in only for this.\n            //      better wait until the spreadsheet engine is available as a separate\n            //      component, then we can use a real Excel-like formatter.\n            //\n            if (type === \"number\") {\n                // kendo.toString will not behave exactly like the Excel format\n                // Still, it's the best we have available for estimating the character count.\n                displayValue = IntlService.toString(value, data.format);\n            }\n\n            column.width = Math.max(column.width || 0, String(displayValue).length);\n        }\n\n        if (type === \"string\") {\n            value = stripFunnyChars(value);\n            value = this._lookupString(value);\n            type = \"s\";\n        } else if (type === \"number\") {\n            type = \"n\";\n        } else if (type === \"boolean\") {\n            type = \"b\";\n            value = Number(value);\n        } else if (value && value.getTime) {\n            type = null;\n            value = dateToSerial(value);\n            if (!style.format) {\n                style.format = \"mm-dd-yy\";\n            }\n        } else {\n            type = null;\n            value = null;\n        }\n\n        style = this._lookupStyle(style);\n\n        var cellName = ref(rowIndex, cellIndex);\n\n        if (data.validation) {\n            this._addValidation(data.validation, cellName);\n        }\n\n        if (data.comment) {\n            var anchor = [\n                cellIndex + 1,  // start column\n                15,             // start column offset\n                rowIndex,       // start row\n                10,             // start row offset\n                cellIndex + 3,  // end column\n                15,             // end column offset\n                rowIndex + 3,   // end row\n                4               // end row offset\n            ];\n            this._comments.push({\n                ref    : cellName,\n                text   : data.comment,\n                row    : rowIndex,\n                col    : cellIndex,\n                anchor : anchor.join(\", \")\n            });\n        }\n\n        return {\n            value: value,\n            formula: data.formula,\n            type: type,\n            style: style,\n            ref: cellName\n        };\n    },\n\n    _addValidation: function(v, ref) {\n        var tmp = {\n            showErrorMessage : v.type === \"reject\" ? 1 : 0,\n            formula1         : v.from,\n            formula2         : v.to,\n            type             : MAP_EXCEL_TYPE[v.dataType] || v.dataType,\n            operator         : MAP_EXCEL_OPERATOR[v.comparerType] || v.comparerType,\n            allowBlank       : v.allowNulls ? 1 : 0,\n            showDropDown     : v.showButton ? 0 : 1, // LOL, Excel!\n            error            : v.messageTemplate,\n            errorTitle       : v.titleTemplate\n        };\n        var json = JSON.stringify(tmp);\n        if (!this._validations[json]) {\n            this._validations[json] = tmp;\n            tmp.sqref = [];\n        }\n        this._validations[json].sqref.push(ref);\n    },\n\n    _getLastRow: function() {\n        return countData(this.options.rows);\n    },\n\n    _getLastCol: function() {\n        var last = 0;\n        this.options.rows.forEach(function(row) {\n            if (row.cells) {\n                last = Math.max(last, countData(row.cells));\n            }\n        });\n        return last;\n    }\n});\n\nfunction countData(data) {\n    var last = data.length;\n    data.forEach(function(el) {\n        if (el.index && el.index >= last) {\n            last = el.index + 1;\n        }\n    });\n    return last;\n}\n\nvar MAP_EXCEL_OPERATOR = {\n    // includes only what differs; key is our operator, value is Excel\n    // operator.\n    greaterThanOrEqualTo : \"greaterThanOrEqual\",\n    lessThanOrEqualTo    : \"lessThanOrEqual\"\n};\n\nvar MAP_EXCEL_TYPE = {\n    number: \"decimal\"\n};\n\nvar defaultFormats = {\n    \"General\": 0,\n    \"0\": 1,\n    \"0.00\": 2,\n    \"#,##0\": 3,\n    \"#,##0.00\": 4,\n    \"0%\": 9,\n    \"0.00%\": 10,\n    \"0.00E+00\": 11,\n    \"# ?/?\": 12,\n    \"# ??/??\": 13,\n    \"mm-dd-yy\": 14,\n    \"d-mmm-yy\": 15,\n    \"d-mmm\": 16,\n    \"mmm-yy\": 17,\n    \"h:mm AM/PM\": 18,\n    \"h:mm:ss AM/PM\": 19,\n    \"h:mm\": 20,\n    \"h:mm:ss\": 21,\n    \"m/d/yy h:mm\": 22,\n    \"#,##0 ;(#,##0)\": 37,\n    \"#,##0 ;[Red](#,##0)\": 38,\n    \"#,##0.00;(#,##0.00)\": 39,\n    \"#,##0.00;[Red](#,##0.00)\": 40,\n    \"mm:ss\": 45,\n    \"[h]:mm:ss\": 46,\n    \"mmss.0\": 47,\n    \"##0.0E+0\": 48,\n    \"@\": 49,\n    \"[$-404]e/m/d\": 27,\n    \"m/d/yy\": 30,\n    \"t0\": 59,\n    \"t0.00\": 60,\n    \"t#,##0\": 61,\n    \"t#,##0.00\": 62,\n    \"t0%\": 67,\n    \"t0.00%\": 68,\n    \"t# ?/?\": 69,\n    \"t# ??/??\": 70\n};\n\nfunction convertColor(value) {\n    var color = value;\n    if (color.length < 6) {\n        color = color.replace(/(\\w)/g, function($0, $1) {\n            return $1 + $1;\n        });\n    }\n\n    color = color.substring(1).toUpperCase();\n\n    if (color.length < 8) {\n        color = \"FF\" + color;\n    }\n\n    return color;\n}\n\nvar Workbook = kendo.Class.extend({\n    init: function(options) {\n        var this$1 = this;\n\n        this.options = options || {};\n        this._strings = {\n            indexes: {},\n            count: 0,\n            uniqueCount: 0\n        };\n        this._styles = [];\n        this._borders = [];\n        this._images = this.options.images;\n        this._imgId = 0;\n\n        this._sheets = map(this.options.sheets || [], function (options, i) {\n            options.defaults = this$1.options;\n            options.sheetIndex = i + 1;\n            return new Worksheet(options, this$1._strings, this$1._styles, this$1._borders);\n        });\n    },\n\n    imageFilename: function(mimeType) {\n        var id = ++this._imgId;\n        switch (mimeType) {\n          case \"image/jpg\":\n          case \"image/jpeg\":\n            return (\"image\" + id + \".jpg\");\n          case \"image/png\":\n            return (\"image\" + id + \".png\");\n          case \"image/gif\":\n            return (\"image\" + id + \".gif\");\n          default:\n            return (\"image\" + id + \".bin\"); // XXX: anything better to do here?\n        }\n    },\n\n    toZIP: function() {\n        var this$1 = this;\n\n        var zip = createZip();\n\n        var docProps = zip.folder(\"docProps\");\n\n        docProps.file(\"core.xml\", CORE({\n            creator: this.options.creator || \"Kendo UI\",\n            lastModifiedBy: this.options.creator || \"Kendo UI\",\n            created: this.options.date || new Date().toJSON(),\n            modified: this.options.date || new Date().toJSON()\n        }));\n\n        var sheetCount = this._sheets.length;\n\n        docProps.file(\"app.xml\", APP({ sheets: this._sheets }));\n\n        var rels = zip.folder(\"_rels\");\n        rels.file(\".rels\", RELS);\n\n        var xl = zip.folder(\"xl\");\n\n        var xlRels = xl.folder(\"_rels\");\n        xlRels.file(\"workbook.xml.rels\", WORKBOOK_RELS({ count: sheetCount }));\n\n        if (this._images) {\n            var media = xl.folder(\"media\");\n            Object.keys(this._images).forEach(function (id) {\n                var img = this$1._images[id];\n                var filename = this$1.imageFilename(img.type);\n                media.file(filename, img.data);\n                img.target = \"../media/\" + filename;\n            });\n        }\n\n        var sheetIds = {};\n        xl.file(\"workbook.xml\", WORKBOOK({\n            sheets: this._sheets,\n            filterNames: map(this._sheets, function(sheet, index) {\n                var options = sheet.options;\n                var sheetName = (options.name || options.title || \"Sheet\" + (index + 1));\n                sheetIds[sheetName.toLowerCase()] = index;\n                var filter = options.filter;\n                if (filter) {\n                    if (filter.ref) {\n                        // spreadsheet provides `ref`\n                        var a = filter.ref.split(\":\");\n                        var from = parseRef(a[0]);\n                        var to = parseRef(a[1]);\n                        return {\n                            localSheetId: index,\n                            name: sheetName,\n                            from: $ref(from.row, from.col),\n                            to: $ref(to.row, to.col)\n                        };\n                    } else if (typeof filter.from !== \"undefined\" && typeof filter.to !== \"undefined\") {\n                        // grid does this\n                        return {\n                            localSheetId: index,\n                            name: sheetName,\n                            from: $ref(filterRowIndex(options), filter.from),\n                            to: $ref(filterRowIndex(options), filter.to)\n                        };\n                    }\n                }\n            }),\n            userNames: map(this.options.names || [], function(def) {\n                return {\n                    name: def.localName,\n                    localSheetId: def.sheet ? sheetIds[def.sheet.toLowerCase()] : null,\n                    value: def.value,\n                    hidden: def.hidden\n                };\n            })\n        }));\n\n        var worksheets = xl.folder(\"worksheets\");\n        var drawings = xl.folder(\"drawings\");\n        var drawingsRels = drawings.folder(\"_rels\");\n        var sheetRels = worksheets.folder(\"_rels\");\n        var commentFiles = [];\n        var drawingFiles = [];\n\n        for (var idx = 0; idx < sheetCount; idx++) {\n            var sheet = this$1._sheets[idx];\n            var sheetName = \"sheet\" + (idx + 1) + \".xml\";\n            var sheetXML = sheet.toXML(idx); // must be called before relsToXML\n            var relsXML = sheet.relsToXML();\n            var commentsXML = sheet.commentsXML();\n            var legacyDrawing = sheet.legacyDrawing();\n            var drawingsXML = sheet.drawingsXML(this$1._images);\n\n            if (relsXML) {\n                sheetRels.file(sheetName + \".rels\", relsXML);\n            }\n            if (commentsXML) {\n                var name = \"comments\" + (sheet.options.sheetIndex) + \".xml\";\n                xl.file(name, commentsXML);\n                commentFiles.push(name);\n            }\n            if (legacyDrawing) {\n                drawings.file((\"vmlDrawing\" + (sheet.options.sheetIndex) + \".vml\"), legacyDrawing);\n            }\n            if (drawingsXML) {\n                var name$1 = \"drawing\" + (sheet.options.sheetIndex) + \".xml\";\n                drawings.file(name$1, drawingsXML.main);\n                drawingsRels.file((name$1 + \".rels\"), drawingsXML.rels);\n                drawingFiles.push(name$1);\n            }\n\n            worksheets.file(sheetName, sheetXML);\n        }\n\n        var borders = map(this._borders, parseJSON);\n\n        var styles = map(this._styles, parseJSON);\n\n        var hasFont = function(style) {\n            return style.underline || style.bold || style.italic || style.color || style.fontFamily || style.fontSize;\n        };\n\n        var convertFontSize = function(value) {\n            var fontInPx = Number(value);\n            var fontInPt;\n\n            if (fontInPx) {\n                fontInPt = fontInPx * 3 / 4;\n            }\n\n            return fontInPt;\n        };\n\n        var fonts = map(styles, function(style) {\n            if (style.fontSize) {\n                style.fontSize = convertFontSize(style.fontSize);\n            }\n\n            if (style.color) {\n                style.color = convertColor(style.color);\n            }\n\n            if (hasFont(style)) {\n                return style;\n            }\n        });\n\n        var formats = map(styles, function(style) {\n            if (style.format && defaultFormats[style.format] === undefined) {\n                return style;\n            }\n        });\n\n        var fills = map(styles, function(style) {\n            if (style.background) {\n                style.background = convertColor(style.background);\n                return style;\n            }\n        });\n\n        xl.file(\"styles.xml\", STYLES({\n            fonts: fonts,\n            fills: fills,\n            formats: formats,\n            borders: borders,\n            styles: map(styles, function(style) {\n                var result = {};\n\n                if (hasFont(style)) {\n                    result.fontId = indexOf(style, fonts) + 1;\n                }\n\n                if (style.background) {\n                    result.fillId = indexOf(style, fills) + 2;\n                }\n\n                result.textAlign = style.textAlign;\n                result.indent = style.indent;\n                result.verticalAlign = style.verticalAlign;\n                result.wrap = style.wrap;\n                result.borderId = style.borderId;\n\n                if (style.format) {\n                    if (defaultFormats[style.format] !== undefined) {\n                        result.numFmtId = defaultFormats[style.format];\n                    } else {\n                        result.numFmtId = 165 + indexOf(style, formats);\n                    }\n                }\n\n                return result;\n            })\n        }));\n\n        xl.file(\"sharedStrings.xml\", SHARED_STRINGS(this._strings));\n\n        zip.file(\"[Content_Types].xml\", CONTENT_TYPES({\n            sheetCount: sheetCount,\n            commentFiles: commentFiles,\n            drawingFiles: drawingFiles\n        }));\n\n        return zip;\n    },\n\n    toDataURL: function() {\n        var zip = this.toZIP();\n\n        return zip.generateAsync ? zip.generateAsync(DATA_URL_OPTIONS).then(toDataURI) : toDataURI(zip.generate(DATA_URL_OPTIONS));\n    },\n\n    toBlob: function() {\n        var zip = this.toZIP();\n        if (zip.generateAsync) {\n            return zip.generateAsync(BLOB_OPTIONS);\n        }\n        return new Blob([ zip.generate(ARRAYBUFFER_OPTIONS) ], { type: MIME_TYPE });\n    }\n});\n\nfunction borderStyle(width) {\n    var alias = \"thin\";\n\n    if (width === 2) {\n        alias = \"medium\";\n    } else if (width === 3) {\n        alias = \"thick\";\n    }\n\n    return alias;\n}\n\nfunction borderSideTemplate(name, style) {\n    var result = \"\";\n\n    if (style) {\n        result += \"<\" + name + \" style=\\\"\" + borderStyle(style.size) + \"\\\">\";\n        if (style.color) {\n            result += \"<color rgb=\\\"\" + convertColor(style.color) + \"\\\"/>\";\n        }\n        result += \"</\" + name + \">\";\n    }\n\n    return result;\n}\n\nfunction borderTemplate(border) {\n    return \"<border>\" +\n       borderSideTemplate(\"left\", border.left) +\n       borderSideTemplate(\"right\", border.right) +\n       borderSideTemplate(\"top\", border.top) +\n       borderSideTemplate(\"bottom\", border.bottom) +\n   \"</border>\";\n}\n\nvar EMPTY_CELL = {};\nfunction inflate(rows, mergedCells) {\n    var rowData = [];\n    var rowsByIndex = [];\n\n    indexRows(rows, function(row, index) {\n        var data = {\n            _source: row,\n            index: index,\n            height: row.height,\n            level: row.level,\n            cells: []\n        };\n\n        rowData.push(data);\n        rowsByIndex[index] = data;\n    });\n\n    var sorted = sortByIndex(rowData).slice(0);\n    var ctx = {\n        rowData: rowData,\n        rowsByIndex: rowsByIndex,\n        mergedCells: mergedCells\n    };\n\n    for (var i = 0; i < sorted.length; i++) {\n        fillCells(sorted[i], ctx);\n        delete sorted[i]._source;\n    }\n\n    return sortByIndex(rowData);\n}\n\nfunction indexRows(rows, callback) {\n    for (var i = 0; i < rows.length; i++) {\n        var row = rows[i];\n        if (!row) {\n            continue;\n        }\n\n        var index = row.index;\n        if (typeof index !== \"number\") {\n            index = i;\n        }\n\n        callback(row, index);\n    }\n}\n\nfunction sortByIndex(items) {\n    return items.sort(function(a, b) {\n        return a.index - b.index;\n    });\n}\n\nfunction pushUnique(array, el) {\n    if (array.indexOf(el) < 0) {\n        array.push(el);\n    }\n}\n\nfunction getSpan(mergedCells, ref) {\n    for (var i = 0; i < mergedCells.length; ++i) {\n        var range = mergedCells[i];\n        var a = range.split(\":\");\n        var topLeft = a[0];\n        if (topLeft === ref) {\n            var bottomRight = a[1];\n            topLeft = parseRef(topLeft);\n            bottomRight = parseRef(bottomRight);\n            return {\n                rowSpan: bottomRight.row - topLeft.row + 1,\n                colSpan: bottomRight.col - topLeft.col + 1\n            };\n        }\n    }\n}\n\nfunction parseRef(ref) {\n    function getcol(str) {\n        var upperStr = str.toUpperCase();\n        var col = 0;\n        for (var i = 0; i < upperStr.length; ++i) {\n            col = col * 26 + upperStr.charCodeAt(i) - 64;\n        }\n        return col - 1;\n    }\n\n    function getrow(str) {\n        return parseInt(str, 10) - 1;\n    }\n\n    var m = /^([a-z]+)(\\d+)$/i.exec(ref);\n    return {\n        row: getrow(m[2]),\n        col: getcol(m[1])\n    };\n}\n\nfunction pixelsToExcel(px) {\n    return Math.round(px * 9525);\n}\n\nfunction fillCells(data, ctx) {\n    var row = data._source;\n    var rowIndex = data.index;\n    var cells = row.cells;\n    var cellData = data.cells;\n\n    if (!cells) {\n        return;\n    }\n\n    for (var i = 0; i < cells.length; i++) {\n        var cell = cells[i] || EMPTY_CELL;\n\n        var rowSpan = cell.rowSpan || 1;\n        var colSpan = cell.colSpan || 1;\n\n        var cellIndex = insertCell(cellData, cell);\n        var topLeftRef = ref(rowIndex, cellIndex);\n\n        if (rowSpan === 1 && colSpan === 1) {\n            // could still be merged: the spreadsheet does not send\n            // rowSpan/colSpan, but mergedCells is already populated.\n            // https://github.com/telerik/kendo-ui-core/issues/2401\n            var tmp = getSpan(ctx.mergedCells, topLeftRef);\n            if (tmp) {\n                colSpan = tmp.colSpan;\n                rowSpan = tmp.rowSpan;\n            }\n        }\n\n        spanCell(cell, cellData, cellIndex, colSpan);\n\n        if (rowSpan > 1 || colSpan > 1) {\n            pushUnique(ctx.mergedCells,\n                       topLeftRef + \":\" + ref(rowIndex + rowSpan - 1,\n                                              cellIndex + colSpan - 1));\n        }\n\n        if (rowSpan > 1) {\n            for (var ri = rowIndex + 1; ri < rowIndex + rowSpan; ri++) {\n                var nextRow = ctx.rowsByIndex[ri];\n                if (!nextRow) {\n                    nextRow = ctx.rowsByIndex[ri] = { index: ri, cells: [] };\n                    ctx.rowData.push(nextRow);\n                }\n\n                spanCell(cell, nextRow.cells, cellIndex - 1, colSpan + 1);\n            }\n        }\n    }\n}\n\nfunction insertCell(data, cell) {\n    var index;\n\n    if (typeof cell.index === \"number\") {\n        index = cell.index;\n        insertCellAt(data, cell, cell.index);\n    } else {\n        index = appendCell(data, cell);\n    }\n\n    return index;\n}\n\nfunction insertCellAt(data, cell, index) {\n    data[index] = cell;\n}\n\nfunction appendCell(data, cell) {\n    var index = data.length;\n\n    for (var i = 0; i < data.length + 1; i++) {\n        if (!data[i]) {\n            data[i] = cell;\n            index = i;\n            break;\n        }\n    }\n\n    return index;\n}\n\nfunction spanCell(cell, row, startIndex, colSpan) {\n    for (var i = 1; i < colSpan; i++) {\n        var tmp = {\n            borderTop    : cell.borderTop,\n            borderRight  : cell.borderRight,\n            borderBottom : cell.borderBottom,\n            borderLeft   : cell.borderLeft\n        };\n        insertCellAt(row, tmp, startIndex + i);\n    }\n}\n\nvar SPREADSHEET_FILTERS = function (ref$1) {\n  var ref = ref$1.ref;\n  var columns = ref$1.columns;\n  var generators = ref$1.generators;\n\n  return (\"\\n<autoFilter ref=\\\"\" + ref + \"\\\">\\n  \" + (foreach(columns, function (col) { return (\"\\n    <filterColumn colId=\\\"\" + (col.index) + \"\\\">\\n      \" + (generators[col.filter](col)) + \"\\n    </filterColumn>\\n  \"); })) + \"\\n</autoFilter>\");\n};\n\nvar SPREADSHEET_CUSTOM_FILTER = function (ref) {\n  var logic = ref.logic;\n  var criteria = ref.criteria;\n\n  return (\"\\n<customFilters \" + (logic === 'and' ? 'and=\"1\"' : '') + \">\\n\" + (foreach(criteria, function (f) {\n    var op = spreadsheetFilters.customOperator(f);\n    var val = spreadsheetFilters.customValue(f);\n    return (\"<customFilter \" + (op ? (\"operator=\\\"\" + op + \"\\\"\") : '') + \" val=\\\"\" + val + \"\\\"/>\");\n})) + \"\\n</customFilters>\");\n};\n\nvar SPREADSHEET_DYNAMIC_FILTER = function (ref) {\n  var type = ref.type;\n\n  return (\"<dynamicFilter type=\\\"\" + (spreadsheetFilters.dynamicFilterType(type)) + \"\\\" />\");\n};\n\nvar SPREADSHEET_TOP_FILTER = function (ref) {\n  var type = ref.type;\n  var value = ref.value;\n\n  return (\"<top10 percent=\\\"\" + (/percent$/i.test(type) ? 1 : 0) + \"\\\"\\n       top=\\\"\" + (/^top/i.test(type) ? 1 : 0) + \"\\\"\\n       val=\\\"\" + value + \"\\\" />\");\n};\n\nvar SPREADSHEET_VALUE_FILTER = function (ref) {\n    var blanks = ref.blanks;\n    var values = ref.values;\n\n    return (\"<filters \" + (blanks ? 'blank=\"1\"' : '') + \">\\n    \" + (foreach(values, function (value) { return (\"\\n      <filter val=\\\"\" + value + \"\\\" />\"); })) + \"\\n  </filters>\");\n};\n\nfunction spreadsheetFilters(filter) {\n    return SPREADSHEET_FILTERS({\n        ref: filter.ref,\n        columns: filter.columns,\n        generators: {\n            custom  : SPREADSHEET_CUSTOM_FILTER,\n            dynamic : SPREADSHEET_DYNAMIC_FILTER,\n            top     : SPREADSHEET_TOP_FILTER,\n            value   : SPREADSHEET_VALUE_FILTER\n        }\n    });\n}\n\nspreadsheetFilters.customOperator = function(f) {\n    return {\n        eq  : \"equal\",\n        gt  : \"greaterThan\",\n        gte : \"greaterThanOrEqual\",\n        lt  : \"lessThan\",\n        lte : \"lessThanOrEqual\",\n        ne  : \"notEqual\",\n\n        // These are not in the spec, but seems to be how Excel does\n        // it (see customValue below).  For the non-negated versions,\n        // the operator attribute is missing completely.\n        doesnotstartwith: \"notEqual\",\n        doesnotendwith: \"notEqual\",\n        doesnotcontain: \"notEqual\",\n        doesnotmatch: \"notEqual\"\n    }[f.operator.toLowerCase()];\n};\n\nfunction quoteSheet(name) {\n    if (/^\\'/.test(name)) { // assume already quoted, the Spreadsheet does it.\n        return name;\n    }\n    if (/^[a-z_][a-z0-9_]*$/i.test(name)) {\n        return name;        // no need to quote it\n    }\n    return \"'\" + name.replace(/\\x27/g, \"\\\\'\") + \"'\";\n}\n\nspreadsheetFilters.customValue = function(f) {\n    function esc(str) {\n        return str.replace(/([*?])/g, \"~$1\");\n    }\n\n    switch (f.operator.toLowerCase()) {\n        case \"startswith\":\n        case \"doesnotstartwith\":\n            return esc(f.value) + \"*\";\n\n        case \"endswith\":\n        case \"doesnotendwith\":\n            return \"*\" + esc(f.value);\n\n        case \"contains\":\n        case \"doesnotcontain\":\n            return \"*\" + esc(f.value) + \"*\";\n\n        default:\n            return f.value;\n    }\n};\n\nspreadsheetFilters.dynamicFilterType = function(type) {\n    return {\n        quarter1  : \"Q1\",\n        quarter2  : \"Q2\",\n        quarter3  : \"Q3\",\n        quarter4  : \"Q4\",\n        january   : \"M1\",\n        february  : \"M2\",\n        march     : \"M3\",\n        april     : \"M4\",\n        may       : \"M5\",\n        june      : \"M6\",\n        july      : \"M7\",\n        august    : \"M8\",\n        september : \"M9\",\n        october   : \"M10\",\n        november  : \"M11\",\n        december  : \"M12\"\n    }[type.toLowerCase()] || type;\n};\n\nkendo.deepExtend(kendo.ooxml, {\n    IntlService: IntlService,\n    Workbook: Workbook,\n    Worksheet: Worksheet\n});\n\n})(window.kendo.jQuery);\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3){ (a3 || a2)(); });\n(function(f, define){\n    define('ooxml/main',[\n        \"kendo.core\",\n        \"./kendo-ooxml\"\n    ], f);\n})(function(){\n\n(function ($) {\n\nvar Workbook = kendo.ooxml.Workbook;\n\nkendo.ooxml.IntlService.register({\n    toString: kendo.toString\n});\n\nkendo.ooxml.Workbook = Workbook.extend({\n    toDataURL: function() {\n        var result = Workbook.fn.toDataURL.call(this);\n        if (typeof result !== 'string') {\n            throw new Error('The toDataURL method can be used only with jsZip 2. Either include jsZip 2 or use the toDataURLAsync method.');\n        }\n\n        return result;\n    },\n\n    toDataURLAsync: function() {\n        var deferred = $.Deferred();\n        var result = Workbook.fn.toDataURL.call(this);\n        if (typeof result === 'string') {\n            result = deferred.resolve(result);\n        } else if (result && result.then){\n            result.then(function(dataURI) {\n                deferred.resolve(dataURI);\n            }, function() {\n                deferred.reject();\n            });\n        }\n\n        return deferred.promise();\n    }\n});\n\n})(window.kendo.jQuery);\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3){ (a3 || a2)(); });\n\n(function(f, define) {\n    define('kendo.ooxml',[ \"./ooxml/main\" ], f);\n})(function() {\n\nvar __meta__ = { // jshint ignore:line\n    id: \"ooxml\",\n    name: \"XLSX generation\",\n    category: \"framework\",\n    advanced: true,\n    depends: [ \"core\" ]\n};\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3) { (a3 || a2)(); });\n\n"],"names":["define","kendo","ooxml","createZip","JSZip","Error","amd","a1","a2","a3","$","window","jQuery","map","current","toString","value","IntlService","Class","extend","dateToJulianDays","y","m","d","register","userImplementation","format","BASE_DATE","packDate","year","month","date","packTime","hh","mm","ss","ms","dateToSerial","time","getHours","getMinutes","getSeconds","getMilliseconds","serial","getFullYear","getMonth","getDate","MIME_TYPE","DATA_URL_PREFIX","DATA_URL_OPTIONS","compression","type","BLOB_OPTIONS","ARRAYBUFFER_OPTIONS","toDataURI","content","indexOf","thing","array","parseJSON","JSON","parse","bind","ESC","val","String","replace","repeat","count","func","str","i","foreach","arr","Array","isArray","length","Object","keys","forEach","key","XMLHEAD","RELS","CORE","ref","creator","lastModifiedBy","created","modified","APP","sheets","sheet","options","title","CONTENT_TYPES","sheetCount","commentFiles","drawingFiles","idx","filename","WORKBOOK","filterNames","userNames","name","f","quoteSheet","from","to","hidden","localSheetId","WORKSHEET","ref$1","frozenColumns","frozenRows","columns","defaults","data","index","mergeCells","autoFilter","filter","showGridLines","hyperlinks","validations","defaultCellStyleId","rtl","legacyDrawing","drawing","lastRow","lastCol","fromCharCode","skipCustomHeight","rowHeight","columnWidth","toWidth","column","ci","columnIndex","width","autoWidth","row","ri","rowIndex","level","height","toHeight","cell","style","formula","writeFormula","spreadsheetFilters","sqref","join","operator","error","errorTitle","formula1","formula2","link","WORKBOOK_RELS","WORKSHEET_RELS","comments","sheetIndex","drawings","target","COMMENTS_XML","comment","text","LEGACY_DRAWING","DRAWINGS_XML","DRAWINGS_RELS_XML","rels","rel","SHARED_STRINGS","uniqueCount","indexes","substring","STYLES","formats","fonts","fills","borders","styles","fi","font","bold","italic","underline","fontSize","color","fontFamily","fill","background","borderTemplate","fontId","fillId","numFmtId","textAlign","verticalAlign","wrap","borderId","indent","src","numChar","colIndex","letter","Math","floor","$ref","filterRowIndex","freezePane","rowSplit","px","maximumDigitWidth","stripFunnyChars","Worksheet","init","sharedStrings","this","_strings","_styles","_borders","_validations","_comments","_drawings","_hyperlinks","rId","relsToXML","toXML","this$1","mergedCells","rows","inflate","_readCells","prototype","hasOwnProperty","call","push","defaultCellStyle","_lookupStyle","_getLastRow","_getLastCol","colSplit","undefined","commentsXML","drawingsXML","images","main","drw","parseRef","topLeftCell","img","image","col","colOffset","pixelsToExcel","offsetX","rowOffset","offsetY","imageId","_lookupString","result","json","stringify","_lookupBorder","border","rowData","cells","j","cellData","_cell","cellIndex","EMPTY_CELL","borderLeft","left","borderRight","right","borderTop","top","borderBottom","bottom","defStyle","add","prop","colSpan","displayValue","max","Number","getTime","cellName","validation","_addValidation","anchor","v","tmp","showErrorMessage","MAP_EXCEL_TYPE","dataType","MAP_EXCEL_OPERATOR","comparerType","allowBlank","allowNulls","showDropDown","showButton","messageTemplate","titleTemplate","countData","last","el","greaterThanOrEqualTo","lessThanOrEqualTo","number","defaultFormats","General","0","0.00","#,##0","#,##0.00","0%","0.00%","0.00E+00","# ?/?","# ??/??","mm-dd-yy","d-mmm-yy","d-mmm","mmm-yy","h:mm AM/PM","h:mm:ss AM/PM","h:mm","h:mm:ss","m/d/yy h:mm","#,##0 ;(#,##0)","#,##0 ;[Red](#,##0)","#,##0.00;(#,##0.00)","#,##0.00;[Red](#,##0.00)","mm:ss","[h]:mm:ss","mmss.0","##0.0E+0","@","[$-404]e/m/d","m/d/yy","t0","t0.00","t#,##0","t#,##0.00","t0%","t0.00%","t# ?/?","t# ??/??","convertColor","$0","$1","toUpperCase","Workbook","_images","_imgId","_sheets","imageFilename","mimeType","id","toZIP","zip","docProps","folder","file","Date","toJSON","xl","xlRels","media","sheetIds","sheetName","toLowerCase","a","split","names","def","localName","worksheets","drawingsRels","sheetRels","sheetXML","relsXML","name$1","hasFont","convertFontSize","fontInPx","fontInPt","toDataURL","generateAsync","then","generate","toBlob","Blob","borderStyle","alias","borderSideTemplate","size","rowsByIndex","indexRows","_source","sorted","sortByIndex","slice","ctx","fillCells","callback","items","sort","b","pushUnique","getSpan","range","topLeft","bottomRight","rowSpan","getcol","upperStr","charCodeAt","getrow","parseInt","exec","round","insertCell","topLeftRef","spanCell","nextRow","insertCellAt","appendCell","startIndex","SPREADSHEET_FILTERS","generators","SPREADSHEET_CUSTOM_FILTER","logic","criteria","op","customOperator","customValue","SPREADSHEET_DYNAMIC_FILTER","dynamicFilterType","SPREADSHEET_TOP_FILTER","test","SPREADSHEET_VALUE_FILTER","blanks","values","custom","dynamic","eq","gt","gte","lt","lte","ne","doesnotstartwith","doesnotendwith","doesnotcontain","doesnotmatch","esc","quarter1","quarter2","quarter3","quarter4","january","february","march","april","may","june","july","august","september","october","november","december","deepExtend","fn","toDataURLAsync","deferred","Deferred","resolve","dataURI","reject","promise","__meta__","category","advanced","depends"],"mappings":"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"}