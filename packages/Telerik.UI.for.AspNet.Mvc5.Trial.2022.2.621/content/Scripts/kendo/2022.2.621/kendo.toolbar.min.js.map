{"version":3,"file":"kendo.toolbar.min.js","sources":["kendo.toolbar.js"],"sourcesContent":["(function(f, define) {\n    define('kendo.toolbar',[ \"kendo.core\", \"kendo.userevents\", \"kendo.popup\", \"kendo.html.button\", \"kendo.splitbutton\", \"kendo.dropdownbutton\" ], f);\n})(function() {\n\nvar __meta__ = { // jshint ignore:line\n    id: \"toolbar\",\n    name: \"ToolBar\",\n    category: \"web\",\n    description: \"The ToolBar widget displays one or more command buttons divided into groups.\",\n    depends: [ \"core\", \"html.button\", \"splitbutton\", \"dropdownbutton\" ]\n};\n\n(function($, undefined) {\n    var kendo = window.kendo,\n        Class = kendo.Class,\n        ui = kendo.ui,\n        Widget = ui.Widget,\n        isFunction = kendo.isFunction,\n        keys = kendo.keys,\n        outerWidth = kendo._outerWidth,\n        ns = \".kendoToolBar\",\n        TOOLBAR = \"k-toolbar\",\n        KBUTTON = \"k-button\",\n        OVERFLOW_BUTTON = \"k-overflow-button\",\n        TOGGLE_BUTTON = \"k-toggle-button\",\n        BUTTON_GROUP = \"k-button-group\",\n        SPLIT_BUTTON = \"k-split-button\",\n        MENU_BUTTON = \"k-menu-button\",\n        KSEPARATOR = \"k-separator\",\n        SPACER_CLASS = \"k-spacer\",\n        POPUP = \"k-popup\",\n        RESIZABLE_TOOLBAR = \"k-toolbar-resizable\",\n        STATE_SELECTED = \"k-selected\",\n        STATE_DISABLED = \"k-disabled\",\n        STATE_HIDDEN = \"k-hidden\",\n        FORCE_HIDDEN = \"k-force-hidden\",\n        GROUP_START = \"k-group-start\",\n        GROUP_END = \"k-group-end\",\n        MENU_LINK = \"k-menu-link\",\n        MENU_ITEM = \"k-menu-item\",\n        OVERFLOW_GROUP = \"k-overflow-group\",\n        OVERFLOW_HIDDEN = \"k-overflow-hidden\",\n        OVERFLOW_ANCHOR = \"k-overflow-anchor\",\n        OVERFLOW_CONTAINER = \"k-overflow-container\",\n        OVERFLOW_WRAPPER = \"k-overflow-wrapper\",\n        FIRST_TOOLBAR_VISIBLE = \"k-toolbar-first-visible\",\n        LAST_TOOLBAR_VISIBLE = \"k-toolbar-last-visible\",\n\n        ARIA_DISABLED = \"aria-disabled\",\n        ARIA_PRESSED = \"aria-pressed\",\n\n        CLICK = \"click\",\n        TOGGLE = \"toggle\",\n        OPEN = \"open\",\n        CLOSE = \"close\",\n        FOCUS = \"focus\",\n        FOCUSIN = \"focusin\",\n        KEYDOWN = \"keydown\",\n        TAP = \"tap\",\n\n        SPACER = \"spacer\",\n        BOTH = \"both\",\n        PRIMARY = \"primary\",\n        HREF = \"href\",\n        ROLE = \"role\",\n        BUTTON = \"button\",\n        SPLITBUTTON = \"splitButton\",\n        DROPDOWNBUTTON = \"dropDownButton\",\n        SEPARATOR = \"separator\",\n        OVERFLOW = \"overflow\",\n        NEXT = \"next\",\n        PREV = \"prev\",\n        TABINDEX = \"tabindex\",\n        TEMPLATE = \"template\",\n\n        OVERFLOW_OPEN = \"overflowOpen\",\n        OVERFLOW_CLOSE = \"overflowClose\",\n        OVERFLOW_NEVER = \"never\",\n        OVERFLOW_AUTO = \"auto\",\n        OVERFLOW_ALWAYS = \"always\",\n\n        OPTION_LIST_SUFFIX = \"_optionlist\",\n\n        KENDO_UID_ATTR = kendo.attr(\"uid\"),\n\n        POPUP_ITEM_TEMPLATE = '<li class=\"k-menu-item k-item\">',\n\n        MENU_LINK_SPAN = '<span tabindex=\"0\" class=\"k-link k-menu-link\">' +\n                '<span class=\"k-menu-link-text\">#:text#</span>' +\n            '</span>',\n\n        MENU_LINK_A = '<a href=\"#:href#\" class=\"k-link k-menu-link\">' +\n                '<span class=\"k-menu-link-text\">#:text#</span>' +\n            '</a>',\n\n        EMPTY = \" \",\n        NOTHING = \"\",\n        TEXT_ITEM = \"textItem\",\n        DOT = \".\",\n        COMMA = \",\",\n        ID = \"id\";\n\n        kendo.toolbar = {};\n\n        var components = {\n            overflowAnchor: '<div tabindex=\"0\" class=\"k-overflow-anchor k-button k-button-md k-rounded-md k-button-flat k-button-flat-base\" title=\"More tools\" role=\"button\"></div>',\n            overflowContainer: '<ul class=\"k-overflow-container k-list-container\"></ul>'\n        };\n\n        kendo.toolbar.registerComponent = function(name, toolbar, overflow) {\n            components[name] = {\n                toolbar: toolbar,\n                overflow: overflow\n            };\n        };\n\n        var Item = kendo.Class.extend({\n            addOverflowAttr: function() {\n                this.element.attr(kendo.attr(OVERFLOW), this.options.overflow || OVERFLOW_AUTO);\n            },\n\n            addUidAttr: function() {\n                this.element.attr(KENDO_UID_ATTR, this.options.uid);\n            },\n\n            addIdAttr: function() {\n                if (this.options.id) {\n                    this.element.attr(ID, this.options.id);\n                }\n            },\n\n            addOverflowIdAttr: function() {\n                if (this.options.id) {\n                    this.element.attr(ID, this.options.id + \"_overflow\");\n                }\n            },\n\n            attributes: function() {\n                var attributes = this.options.attributes,\n                    classes;\n\n                if (attributes) {\n                    if (attributes.class) {\n                        classes = attributes.class;\n\n                        this.element.addClass(classes);\n\n                        delete attributes.class;\n                    }\n\n                    this.element.attr(attributes);\n\n                    attributes.class = classes;\n                }\n            },\n\n            show: function() {\n                this.element.removeClass(STATE_HIDDEN);\n                this.element.removeClass(FORCE_HIDDEN);\n                this.options.hidden = false;\n            },\n\n            hide: function() {\n                this.element.addClass(STATE_HIDDEN);\n                this.element.addClass(FORCE_HIDDEN);\n\n                if (this.overflow && this.overflowHidden) {\n                    this.overflowHidden();\n                }\n                this.options.hidden = true;\n            },\n\n            remove: function() {\n                this.element.remove();\n            },\n\n            enable: function(isEnabled) {\n                if (isEnabled === undefined) {\n                    isEnabled = true;\n                }\n                this.element.toggleClass(STATE_DISABLED, !isEnabled);\n                this.element.attr(ARIA_DISABLED, !isEnabled);\n\n                this.options.enable = isEnabled;\n            },\n\n            twin: function() {\n                var uid = this.element.attr(KENDO_UID_ATTR);\n                if (this.overflow && this.options.splitContainerId) {\n                    return $(\"#\" + this.options.splitContainerId)\n                            .find(\"[\" + KENDO_UID_ATTR + \"='\" + uid + \"']\")\n                            .data(this.options.type);\n                } else if (this.overflow) {\n                    return this.toolbar\n                            .element\n                            .find(\"[\" + KENDO_UID_ATTR + \"='\" + uid + \"']\")\n                            .data(this.options.type);\n                } else if (this.toolbar.options.resizable) {\n                    return this.toolbar\n                            .popup.element\n                            .find(\"[\" + KENDO_UID_ATTR + \"='\" + uid + \"']\")\n                            .data(this.options.type);\n                }\n            }\n        });\n\n        kendo.toolbar.Item = Item;\n\n        var BareItem = Item.extend({\n            init: function(options, toolbar) {\n                this.options = $.extend({}, this.options, options);\n                this.toolbar = toolbar;\n            }\n        });\n\n        kendo.toolbar.BareItem = BareItem;\n\n        var Button = Item.extend({\n            init: function(options, toolbar) {\n                var element = options.useButtonTag ? $('<button></button>') : $('<a role=\"button\" href></a>');\n\n                this.element = element;\n                this.options = $.extend({}, this.options, options);\n                this.toolbar = toolbar;\n\n                this.attributes();\n\n                if (options.primary) {\n                    this.options.themeColor = PRIMARY;\n                }\n\n                if (options.togglable) {\n                    element.addClass(TOGGLE_BUTTON);\n                    this.toggle(options.selected);\n                }\n\n                if (options.url !== undefined && !options.useButtonTag) {\n                    element.attr(HREF, options.url);\n                    if (options.mobile) {\n                        element.attr(kendo.attr(ROLE), BUTTON);\n                    }\n                }\n\n                if (options.group) {\n                    element.attr(kendo.attr(\"group\"), options.group);\n                    this.group = this.toolbar.addToGroup(this, options.group);\n                }\n\n                if (!options.togglable && options.click && isFunction(options.click)) {\n                    this.clickHandler = options.click;\n                }\n\n                if (options.togglable && options.toggle && isFunction(options.toggle)) {\n                    this.toggleHandler = options.toggle;\n                }\n            },\n\n            options: {\n                showIcon: BOTH,\n                showText: BOTH\n            },\n\n            toggle: function(state, propagate) {\n                state = !!state;\n\n                if (this.group && state) {\n                    this.group.select(this);\n                } else if (!this.group) {\n                    this.select(state);\n                }\n\n                if (propagate && this.twin()) {\n                    this.twin().toggle(state);\n                }\n            },\n\n            getParentGroup: function() {\n                if (this.options.isChild) {\n                    return this.element.closest(DOT + BUTTON_GROUP).data(\"buttonGroup\");\n                }\n            }\n        });\n\n        kendo.toolbar.Button = Button;\n\n        var ToolBarButton = Button.extend({\n            init: function(options, toolbar) {\n                Button.fn.init.call(this, options, toolbar);\n\n                var element = this.element;\n                options = this.options;\n\n                element.addClass(KBUTTON);\n\n                this.addIdAttr();\n\n                if (options.align) {\n                    element.addClass(\"k-align-\" + options.align);\n                }\n\n                if (!!options.text && (options.showText == \"toolbar\" || options.showText == BOTH)) {\n                    if (options.mobile) {\n                        element.html('<span class=\"km-text\">' + options.text + \"</span>\");\n                    } else {\n                        element.html(options.text);\n                    }\n                } else if (!!options.text) {\n                    element.attr(\"aria-label\", options.text);\n                }\n\n                if (options.icon || options.spriteCssClass || options.imageUrl) {\n                    if (options.showIcon !== \"toolbar\" && options.showIcon !== BOTH) {\n                        options.icon = null;\n                        options.spriteCssClass = null;\n                        options.imageUrl = null;\n                    }\n                }\n\n                kendo.html.renderButton(element, options);\n\n                this.addUidAttr();\n                this.addOverflowAttr();\n                this.enable(options.enable);\n\n                if (options.hidden) {\n                    this.hide();\n                }\n\n                this.element.data({\n                    type: BUTTON,\n                    button: this\n                });\n            },\n\n            select: function(selected) {\n                if (selected === undefined) {\n                    selected = false;\n                }\n\n                if (this.options.togglable) {\n                    this.element.attr(ARIA_PRESSED, selected);\n                }\n\n                this.element.toggleClass(STATE_SELECTED, selected);\n                this.options.selected = selected;\n            }\n        });\n\n        kendo.toolbar.ToolBarButton = ToolBarButton;\n\n        var OverflowButton = Button.extend({\n            init: function(options, toolbar) {\n                this.overflow = true;\n\n                Button.fn.init.call(this, $.extend({}, options), toolbar);\n\n                var element = this.element;\n                options = this.options;\n\n                if (!!options.text && (options.showText == OVERFLOW || options.showText == BOTH)) {\n                    if (options.mobile) {\n                        element.html('<span class=\"km-text\">' + options.text + \"</span>\");\n                    } else {\n                        element.html(options.text);\n                    }\n                } else if (!!options.text) {\n                    element.attr(\"aria-label\", options.text);\n                }\n\n                if (options.icon || options.spriteCssClass || options.imageUrl) {\n                    if (options.showIcon !== OVERFLOW && options.showIcon !== BOTH) {\n                        options.icon = null;\n                        options.spriteCssClass = null;\n                        options.imageUrl = null;\n                    }\n                }\n\n                kendo.html.renderButton(element, options);\n\n                if (!options.isChild) {\n                    this._wrap();\n                }\n\n                this.addOverflowIdAttr();\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                this.enable(options.enable);\n\n                element.addClass(OVERFLOW_BUTTON + EMPTY + KBUTTON);\n\n                if (options.hidden) {\n                    this.hide();\n                }\n\n                if (options.togglable) {\n                    this.toggle(options.selected);\n                }\n\n                this.element.data({\n                    type: BUTTON,\n                    button: this\n                });\n            },\n\n            _wrap: function() {\n                this.element = this.element.wrap(POPUP_ITEM_TEMPLATE).parent();\n            },\n\n            overflowHidden: function() {\n                this.element.addClass(OVERFLOW_HIDDEN);\n            },\n\n            select: function(selected) {\n                if (selected === undefined) {\n                    selected = false;\n                }\n\n                if (this.options.isChild) {\n                    this.element.toggleClass(STATE_SELECTED, selected);\n                } else {\n                    this.element.find(DOT + KBUTTON).toggleClass(STATE_SELECTED, selected);\n                }\n                this.options.selected = selected;\n            }\n        });\n\n        kendo.toolbar.OverflowButton = OverflowButton;\n        kendo.toolbar.registerComponent(BUTTON, ToolBarButton, OverflowButton);\n\n        var ButtonGroup = Item.extend({\n            createButtons: function(buttonConstructor) {\n                var options = this.options;\n                var items = options.buttons || [];\n                var item;\n\n                for (var i = 0; i < items.length; i++) {\n                    if (!items[i].uid) {\n                        items[i].uid = kendo.guid();\n                    }\n                    item = new buttonConstructor($.extend({ mobile: options.mobile, isChild: true, type: BUTTON }, items[i]), this.toolbar);\n                    item.element.appendTo(this.element);\n                }\n            },\n\n            refresh: function() {\n                this.element.children().filter(\":not('.\" + STATE_HIDDEN + \"')\").first().addClass(GROUP_START);\n                this.element.children().filter(\":not('.\" + STATE_HIDDEN + \"')\").last().addClass(GROUP_END);\n            }\n        });\n\n        kendo.toolbar.ButtonGroup = ButtonGroup;\n\n        var ToolBarButtonGroup = ButtonGroup.extend({\n            init: function(options, toolbar) {\n                var element = this.element = $('<div></div>');\n                this.options = options;\n                this.toolbar = toolbar;\n\n                this.addIdAttr();\n\n                if (options.align) {\n                    element.addClass(\"k-align-\" + options.align);\n                }\n\n                this.createButtons(ToolBarButton);\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                this.refresh();\n\n                element.addClass(BUTTON_GROUP);\n\n                if (options.hidden) {\n                    this.hide();\n                }\n\n                this.element.data({\n                    type: \"buttonGroup\",\n                    buttonGroup: this\n                });\n            }\n        });\n\n        kendo.toolbar.ToolBarButtonGroup = ToolBarButtonGroup;\n\n        var OverflowButtonGroup = ButtonGroup.extend({\n            init: function(options, toolbar) {\n                var element = this.element = $('<li></li>');\n                this.options = options;\n                this.toolbar = toolbar;\n                this.overflow = true;\n\n                this.addOverflowIdAttr();\n\n                this.createButtons(OverflowButton);\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                this.refresh();\n\n                element.addClass((options.mobile ? NOTHING : BUTTON_GROUP) + EMPTY + OVERFLOW_GROUP);\n\n                this.element.data({\n                    type: \"buttonGroup\",\n                    buttonGroup: this\n                });\n            },\n\n            overflowHidden: function() {\n                this.element.addClass(OVERFLOW_HIDDEN);\n            }\n        });\n\n        kendo.toolbar.OverflowButtonGroup = OverflowButtonGroup;\n        kendo.toolbar.registerComponent(\"buttonGroup\", ToolBarButtonGroup, OverflowButtonGroup);\n\n        var ToolBarMenuButton = ToolBarButton.extend({\n            init: function(options, toolbar) {\n                var element, img, span;\n\n                options = this.options = $.extend({}, this.options, options);\n\n                if (options.url !== undefined) {\n                    element = $(kendo.template(MENU_LINK_A)({\n                        href: options.url,\n                        text: options.text\n                    }));\n                } else {\n                    element = $(kendo.template(MENU_LINK_SPAN)({\n                        text: options.text\n                    }));\n                }\n\n                this.element = element;\n                this.toolbar = toolbar;\n\n                if (options.click && isFunction(options.click)) {\n                    this.clickHandler = options.click;\n                }\n\n                if (options.togglable && options.toggle && isFunction(options.toggle)) {\n                    this.toggleHandler = options.toggle;\n                }\n\n                if (options.imageUrl) {\n                    img = $('<img alt=\"icon\" class=\"k-image\" />').prependTo(element);\n                    img.attr(\"src\", options.imageUrl);\n                } else if (options.icon) {\n                    span = $('<span></span>').prependTo(element);\n                    span.attr(\"class\", \"k-icon k-i-\" + options.icon);\n                } else if (options.spriteCssClass) {\n                    span = $('<span class=\"k-sprite\"></span>').prependTo(element);\n                    span.addClass(options.spriteCssClass);\n                }\n\n                this.addIdAttr();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                this.attributes();\n                this.enable(options.enable);\n\n                if (options.group) {\n                    element.attr(kendo.attr(\"group\"), options.group);\n                    this.group = this.toolbar.addToGroup(this, options.group);\n                }\n\n                if (options.hidden) {\n                    this.hide();\n                }\n\n                this.element.data({\n                    type: BUTTON,\n                    button: this\n                });\n            }\n        });\n\n        kendo.toolbar.ToolBarMenuButton = ToolBarMenuButton;\n\n        var ToolBarSplitButton = Item.extend({\n            init: function(options, toolbar) {\n                var that = this;\n\n                that.options = $.extend({\n                    id: options.id || options.uid,\n                    enable: true\n                }, options, {\n                    togglable: false // disable togglable for splitbutton\n                });\n\n                if (options.primary) {\n                    that.options.themeColor = PRIMARY;\n                }\n\n                if (options.showIcon === \"overflow\") {\n                    that.options.icon = null;\n                }\n\n                if (options.showText === \"overflow\") {\n                    that.options.text = \"\";\n                }\n\n                that.toolbar = toolbar;\n\n                that.splitButton = new ui.SplitButton($(\"<button id='\" + that.options.id + \"'>\" + that.options.text + \"</button>\"),\n                                                         $.extend({}, that.options, {\n                                                             items: that._extend(options.menuButtons),\n                                                        }), toolbar.options);\n                that.element = that.splitButton.wrapper;\n\n                that.splitButton.bind(CLICK, toolbar._buttonClick.bind(toolbar));\n                that.splitButton.bind(CLOSE, that._close.bind(that));\n                that.splitButton.bind(OPEN, that._open.bind(that));\n\n                that.splitButton.element.data({\n                    type: SPLITBUTTON,\n                    button: that,\n                    splitButton: that\n                });\n\n                that.splitButton.wrapper.data({\n                    type: SPLITBUTTON,\n                    button: that,\n                    splitButton: that\n                });\n\n                that.addOverflowAttr();\n                that.addUidAttr();\n                that.attributes();\n                that.addMenuAttributes();\n\n                if (that.options.enable === false) {\n                    that.enable(this.options.enable);\n                }\n\n                if (that.options.hidden) {\n                    that.hide();\n                }\n            },\n            _open: function(ev) {\n                var that = this;\n                var isDefaultPrevented = that.toolbar.trigger(OPEN, { target: that.element });\n                if (isDefaultPrevented) {\n                    ev.preventDefault();\n                }\n            },\n            _close: function(ev) {\n                var that = this;\n                var isDefaultPrevented = that.toolbar.trigger(CLOSE, { target: that.element });\n                if (isDefaultPrevented) {\n                    ev.preventDefault();\n                }\n                that.splitButton.element.trigger(FOCUS);\n            },\n            _extend: function(items) {\n                var that = this;\n                return items.map(function(item) {\n                    var itemInstance = new BareItem(item, that.toolbar);\n                    return $.extend({}, item, {\n                        togglable: false,\n                        data: function() {\n                            return {\n                                type: BUTTON,\n                                button: itemInstance,\n                                splitButton: that\n                            };\n                        }\n                    });\n                });\n            },\n            addMenuAttributes: function() {\n                var that = this,\n                    items = that.splitButton.items(),\n                    itemInstance;\n\n                items.each(function(index, item) {\n                    item = $(item);\n                    itemInstance = item.data(BUTTON);\n                    itemInstance.element = item;\n                    itemInstance.options = $.extend({\n                        type: BUTTON,\n                        enable: true\n                    }, itemInstance.options);\n\n                    itemInstance.addOverflowAttr();\n                    itemInstance.addUidAttr();\n                });\n            },\n            remove: function() {\n                var elmToRemove = this.splitButton.wrapper;\n                this.splitButton.destroy();\n                elmToRemove.remove();\n            },\n            enable: function(enable, item) {\n                this.splitButton.enable(enable, item, true);\n\n                if (this.twin()) {\n                    this.twin().enable(enable);\n                }\n            },\n            attributes: function() {\n                var that = this,\n                    mainButton = that.splitButton.element,\n                    attributes = this.options.attributes,\n                    classes;\n\n                if (attributes) {\n                    if (attributes.class) {\n                        classes = attributes.class;\n\n                        mainButton.addClass(classes);\n\n                        delete attributes.class;\n                    }\n\n                    mainButton.attr(attributes);\n\n                    attributes.class = classes;\n                }\n            },\n        });\n\n        kendo.toolbar.ToolBarSplitButton = ToolBarSplitButton;\n\n        var OverflowSplitButton = Item.extend({\n            init: function(options, toolbar) {\n                var element = this.element = $('<li class=\"' + SPLIT_BUTTON + '\"></li>'),\n                    items = options.menuButtons,\n                    item, splitContainerId;\n\n                this.options = $.extend({}, options, { togglable: false });\n                this.toolbar = toolbar;\n                this.overflow = true;\n                splitContainerId = (options.id || options.uid) + OPTION_LIST_SUFFIX;\n\n                this.mainButton = new OverflowButton($.extend({ isChild: true }, options, { togglable: false }));\n                this.mainButton.element.appendTo(element);\n\n                for (var i = 0; i < items.length; i++) {\n                    item = new OverflowButton($.extend({ mobile: options.mobile, type: BUTTON, splitContainerId: splitContainerId, isChild: true }, items[i], { click: options.click }), this.toolbar);\n                    item.element.appendTo(element);\n                }\n\n                this.addUidAttr();\n                this.addOverflowAttr();\n\n                this.mainButton.main = true;\n\n                if (this.options.enable === false) {\n                    this.enable(this.options.enable);\n                }\n\n                element.data({\n                    type: SPLITBUTTON,\n                    splitButton: this\n                });\n            },\n\n            enable: function(isEnabled) {\n                var elements = this.element.add(this.element.find(DOT + OVERFLOW_BUTTON));\n\n                if (isEnabled === undefined) {\n                    isEnabled = true;\n                }\n\n                elements.toggleClass(STATE_DISABLED, !isEnabled);\n                elements.attr(ARIA_DISABLED, !isEnabled);\n\n                this.options.enable = isEnabled;\n            },\n\n            overflowHidden: function() {\n                this.element.addClass(OVERFLOW_HIDDEN);\n            }\n        });\n\n        kendo.toolbar.OverflowSplitButton = OverflowSplitButton;\n        kendo.toolbar.registerComponent(SPLITBUTTON, ToolBarSplitButton, OverflowSplitButton);\n\n        var ToolBarDropDownButton = Item.extend({\n            init: function(options, toolbar) {\n                var that = this;\n\n                that.options = $.extend({\n                    id: options.id || options.uid,\n                    enable: true\n                }, options, {\n                    togglable: false // disable togglable for dropdownbutton\n                });\n\n                if (options.primary) {\n                    that.options.themeColor = PRIMARY;\n                }\n\n                if (options.showIcon === \"overflow\") {\n                    that.options.icon = null;\n                }\n\n                if (options.showText === \"overflow\") {\n                    that.options.text = \"\";\n                }\n\n                that.toolbar = toolbar;\n\n                that.dropDownButton = new ui.DropDownButton($(\"<button id='\" + that.options.id + \"'>\" + that.options.text + \"</button>\"),\n                                                         $.extend({}, that.options, {\n                                                             items: that._extend(options.menuButtons)\n                                                        }), toolbar.options);\n                that.element = that.dropDownButton.element;\n\n                that.dropDownButton.bind(CLICK, toolbar._buttonClick.bind(toolbar));\n                that.dropDownButton.bind(CLOSE, that._close.bind(that));\n                that.dropDownButton.bind(OPEN, that._open.bind(that));\n\n                that.dropDownButton.element.data({\n                    type: DROPDOWNBUTTON,\n                    button: that,\n                    dropDownButton: that\n                });\n\n                that.addOverflowAttr();\n                that.addUidAttr();\n                that.attributes();\n                that.addMenuAttributes();\n\n                if (that.options.enable === false) {\n                    that.enable(this.options.enable);\n                }\n\n                if (that.options.hidden) {\n                    that.hide();\n                }\n            },\n            _open: function(ev) {\n                var that = this;\n                var isDefaultPrevented = that.toolbar.trigger(OPEN, { target: that.element });\n                if (isDefaultPrevented) {\n                    ev.preventDefault();\n                }\n            },\n            _close: function(ev) {\n                var that = this;\n                var isDefaultPrevented = that.toolbar.trigger(CLOSE, { target: that.element });\n                if (isDefaultPrevented) {\n                    ev.preventDefault();\n                }\n                that.dropDownButton.element.trigger(FOCUS);\n            },\n            _extend: function(items) {\n                var that = this;\n                return items.map(function(item) {\n                    var itemInstance = new BareItem(item, that.toolbar);\n                    return $.extend({}, item, {\n                        data: function() {\n                            return {\n                                type: BUTTON,\n                                button: itemInstance,\n                                dropDownButton: that\n                            };\n                        }\n                    });\n                });\n            },\n            addMenuAttributes: function() {\n                var that = this,\n                    items = that.dropDownButton.items(),\n                    itemInstance;\n\n                items.each(function(index, item) {\n                    item = $(item);\n                    itemInstance = item.data(BUTTON);\n                    itemInstance.element = item;\n                    itemInstance.options = $.extend({\n                        type: BUTTON,\n                        enable: true\n                    }, itemInstance.options);\n\n                    itemInstance.addOverflowAttr();\n                    itemInstance.addUidAttr();\n                });\n            },\n            remove: function() {\n                var elmToRemove = this.dropDownButton.element;\n                this.dropDownButton.destroy();\n                elmToRemove.remove();\n            },\n            enable: function(enable, item) {\n                this.dropDownButton.enable(enable, item, true);\n\n                if (this.twin()) {\n                    this.twin().enable(enable);\n                }\n            },\n            attributes: function() {\n                var that = this,\n                    mainButton = that.element,\n                    attributes = this.options.attributes,\n                    classes;\n\n                if (attributes) {\n                    if (attributes.class) {\n                        classes = attributes.class;\n\n                        mainButton.addClass(classes);\n\n                        delete attributes.class;\n                    }\n\n                    mainButton.attr(attributes);\n\n                    attributes.class = classes;\n                }\n            },\n        });\n\n        kendo.toolbar.ToolBarSplitButton = ToolBarSplitButton;\n\n        var OverflowTextItem = Item.extend({\n            init: function(options, toolbar) {\n                var element = this.element = $('<span></span>');\n\n                this.element = element;\n                this.options = options;\n                this.toolbar = toolbar;\n                this.overflow = true;\n\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowIdAttr();\n\n                if (options.icon && (!options.showIcon || options.showIcon !== \"toolbar\")) {\n                    element.append(\"<span class=\\\"k-icon k-i-\" + options.icon + \"\\\"></span>\");\n                }\n\n                if (options.showText !== \"toolbar\") {\n                    element.append(\"<span>\" + this.options.text + \"</span>\");\n                }\n\n                element.data({\n                    type: TEXT_ITEM,\n                    textItem: this\n                });\n            },\n\n            overflowHidden: function() {\n                this.element.addClass(OVERFLOW_HIDDEN);\n            }\n        });\n\n        var OverflowDropDownButton = Item.extend({\n            init: function(options, toolbar) {\n                var element = this.element = $('<li class=\"' + SPLIT_BUTTON + ' ' + MENU_BUTTON + '\"></li>'),\n                    items = options.menuButtons,\n                    item, splitContainerId;\n\n                this.options = $.extend({}, options, { togglable: false });\n                this.toolbar = toolbar;\n                this.overflow = true;\n                splitContainerId = (options.id || options.uid) + OPTION_LIST_SUFFIX;\n\n                this.mainButton = new OverflowTextItem($.extend({ isChild: true }, options, { togglable: false }));\n                this.mainButton.element.appendTo(element);\n\n                for (var i = 0; i < items.length; i++) {\n                    item = new OverflowButton($.extend({ mobile: options.mobile, type: BUTTON, splitContainerId: splitContainerId, isChild: true }, items[i], { click: options.click }), this.toolbar);\n                    item.element.appendTo(element);\n                }\n\n                this.addUidAttr();\n                this.addOverflowAttr();\n\n                this.mainButton.main = true;\n\n                if (this.options.enable === false) {\n                    this.enable(this.options.enable);\n                }\n\n                element.data({\n                    type: DROPDOWNBUTTON,\n                    dropDownButton: this\n                });\n            },\n\n            enable: function(isEnabled) {\n                var elements = this.element.add(this.element.find(DOT + OVERFLOW_BUTTON));\n\n                if (isEnabled === undefined) {\n                    isEnabled = true;\n                }\n\n                elements.toggleClass(STATE_DISABLED, !isEnabled);\n                elements.attr(ARIA_DISABLED, !isEnabled);\n\n                this.options.enable = isEnabled;\n            },\n\n            overflowHidden: function() {\n                this.element.addClass(OVERFLOW_HIDDEN);\n            }\n        });\n\n        kendo.toolbar.OverflowSplitButton = OverflowDropDownButton;\n        kendo.toolbar.registerComponent(DROPDOWNBUTTON, ToolBarDropDownButton, OverflowDropDownButton);\n\n        var ToolBarSeparator = Item.extend({\n            init: function(options, toolbar) {\n                var element = this.element = $('<div>&nbsp;</div>');\n\n                this.element = element;\n                this.options = options;\n                this.toolbar = toolbar;\n\n                this.attributes();\n                this.addIdAttr();\n                this.addUidAttr();\n                this.addOverflowAttr();\n\n                element.addClass(KSEPARATOR);\n                element.attr(ROLE, SEPARATOR);\n\n                element.data({\n                    type: SEPARATOR,\n                    separator: this\n                });\n            }\n        });\n\n        var OverflowSeparator = Item.extend({\n            init: function(options, toolbar) {\n                var element = this.element = $('<li>&nbsp;</li>');\n\n                this.element = element;\n                this.options = options;\n                this.toolbar = toolbar;\n                this.overflow = true;\n\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowIdAttr();\n\n                element.addClass(KSEPARATOR);\n                element.attr(ROLE, SEPARATOR);\n\n                element.data({\n                    type: SEPARATOR,\n                    separator: this\n                });\n            },\n\n            overflowHidden: function() {\n                this.element.addClass(OVERFLOW_HIDDEN);\n            }\n        });\n\n        kendo.toolbar.registerComponent(\"separator\", ToolBarSeparator, OverflowSeparator);\n\n        var ToolBarSpacer = Item.extend({\n            init: function(options, toolbar) {\n                var element = this.element = $('<div>&nbsp;</div>');\n\n                this.element = element;\n                this.options = options;\n                this.toolbar = toolbar;\n\n                element.addClass(SPACER_CLASS);\n\n                element.data({\n                    type: SPACER\n                });\n            }\n        });\n\n        kendo.toolbar.registerComponent(SPACER, ToolBarSpacer);\n\n        var TemplateItem = Item.extend({\n            init: function(template, options, toolbar) {\n                var element = isFunction(template) ? template(options) : template;\n\n                if (!(element instanceof jQuery)) {\n                    element = $(\"<div></div>\").html(element);\n                } else {\n                    element = element.wrap(\"<div></div>\").parent();\n                }\n\n                this.element = element;\n                this.options = options;\n                this.options.type = TEMPLATE;\n                this.toolbar = toolbar;\n\n                this.attributes();\n                this.addUidAttr();\n                this.addIdAttr();\n                this.addOverflowAttr();\n\n                if (options.hidden) {\n                    this.hide();\n                }\n\n                element.data({\n                    type: TEMPLATE,\n                    template: this\n                });\n            }\n        });\n\n        kendo.toolbar.TemplateItem = TemplateItem;\n\n        var OverflowTemplateItem = Item.extend({\n            init: function(template, options, toolbar) {\n                var element = isFunction(template) ? $(template(options)) : $(template);\n\n                if (!(element instanceof jQuery)) {\n                    element = $(\"<li></li>\").html(element);\n                } else {\n                    element = element.wrap(\"<li></li>\").parent();\n                }\n\n                this.element = element;\n                this.options = options;\n                this.options.type = TEMPLATE;\n                this.toolbar = toolbar;\n                this.overflow = true;\n\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowIdAttr();\n                this.addOverflowAttr();\n\n                element.data({\n                    type: TEMPLATE,\n                    template: this\n                });\n            },\n\n            overflowHidden: function() {\n                this.element.addClass(OVERFLOW_HIDDEN);\n            }\n        });\n\n        kendo.toolbar.OverflowTemplateItem = OverflowTemplateItem;\n\n        function toggleActive(e) {\n            if (!e.target.is(\".k-toggle-button\")) {\n                e.target.toggleClass(STATE_SELECTED, e.type == \"press\");\n            }\n        }\n\n        function actionSheetWrap(element) {\n            element = $(element);\n\n            return element.hasClass(\"km-actionsheet\") ? element.closest(\".km-popup-wrapper\") : element.addClass(\"km-widget km-actionsheet\")\n                             .wrap('<div class=\"km-actionsheet-wrapper km-actionsheet-tablet km-widget km-popup\"></div>').parent()\n                             .wrap('<div class=\"km-popup-wrapper k-popup\"></div>').parent();\n        }\n\n        function preventClick(e) {\n            if ($(e.target).closest(\"a.k-button\").length) {\n                e.preventDefault();\n            }\n        }\n\n        function findFocusableSibling(element, dir) {\n            var getSibling = dir === NEXT ? $.fn.next : $.fn.prev;\n            var getter = dir === NEXT ? $.fn.first : $.fn.last;\n            var candidate = getSibling.call(element);\n\n            if (!candidate.length && element.is(DOT + OVERFLOW_ANCHOR)) {\n                return element;\n            }\n\n            if (candidate.is(\":kendoFocusable\") || !candidate.length) {\n                return candidate;\n            }\n\n            if (candidate.find(\":kendoFocusable\").length) {\n                return getter.call(candidate.find(\":kendoFocusable\"));\n            }\n\n            return findFocusableSibling(candidate, dir);\n        }\n\n        var Group = Class.extend({\n            init: function(name) {\n                this.name = name;\n                this.buttons = [];\n            },\n\n            add: function(button) {\n                this.buttons[this.buttons.length] = button;\n            },\n\n            remove: function(button) {\n                var index = $.inArray(button, this.buttons);\n                this.buttons.splice(index, 1);\n            },\n\n            select: function(button) {\n                var tmp;\n                for (var i = 0; i < this.buttons.length; i ++) {\n                    tmp = this.buttons[i];\n\n                    tmp.select(false);\n                }\n\n                button.select(true);\n                if (button.twin()) {\n                    button.twin().select(true);\n                }\n            }\n        });\n\n        var ToolBar = Widget.extend({\n            init: function(element, options) {\n                var that = this;\n                Widget.fn.init.call(that, element, options);\n\n                options = that.options;\n                element = that.wrapper = that.element;\n\n                element.addClass(TOOLBAR + \" k-widget\");\n                element.attr(ROLE, \"toolbar\");\n\n                this.uid = kendo.guid();\n                this._isRtl = kendo.support.isRtl(element);\n                this._groups = {};\n                element.attr(KENDO_UID_ATTR, this.uid);\n\n                that.isMobile = (typeof options.mobile === \"boolean\") ? options.mobile : that.element.closest(\".km-root\")[0];\n                that.animation = that.isMobile ? { open: { effects: \"fade\" } } : {};\n\n                if (that.isMobile) {\n                    element.addClass(\"km-widget\");\n                    KBUTTON = \"km-button\";\n                    BUTTON_GROUP = \"km-buttongroup\";\n                    STATE_SELECTED = \"km-state-active\";\n                    STATE_DISABLED = \"km-state-disabled\";\n                }\n\n                if (options.resizable) {\n                    that._renderOverflow();\n                    element.addClass(RESIZABLE_TOOLBAR);\n\n                    that.overflowUserEvents = new kendo.UserEvents(that.element, {\n                        threshold: 5,\n                        allowSelection: true,\n                        filter: DOT + OVERFLOW_ANCHOR,\n                        tap: that._toggleOverflow.bind(that)\n                    });\n\n                    that._resizeHandler = kendo.onResize(function() {\n                        that.resize();\n                    });\n                } else {\n                    that.popup = { element: $([]) };\n                }\n\n                if (options.items && options.items.length) {\n                    for (var i = 0; i < options.items.length; i++) {\n                        that.add(options.items[i]);\n                    }\n\n                    if (options.resizable) {\n                        that._shrink(that.element.innerWidth());\n                    }\n                }\n\n                that.userEvents = new kendo.UserEvents(document.documentElement, {\n                    threshold: 5,\n                    allowSelection: true,\n                    filter:\n                        \"[\" + KENDO_UID_ATTR + \"=\" + this.uid + \"] a.\" + KBUTTON + COMMA + EMPTY +\n                        \"[\" + KENDO_UID_ATTR + \"=\" + this.uid + \"] .\" + MENU_ITEM + COMMA + EMPTY +\n                        \"[\" + KENDO_UID_ATTR + \"=\" + this.uid + \"] .\" + OVERFLOW_BUTTON,\n                    tap: that._buttonClick.bind(that),\n                    press: toggleActive,\n                    release: toggleActive\n                });\n\n                that.element.on(CLICK + ns, \"a.k-button\", preventClick);\n                that._navigatable();\n\n                if (options.resizable) {\n                    that.popup.element.on(CLICK + ns, + \"a.k-button\", preventClick);\n                }\n\n                if (options.resizable) {\n                    this._toggleOverflowAnchor();\n                }\n\n                kendo.notify(that);\n            },\n\n            events: [\n                CLICK,\n                TOGGLE,\n                OPEN,\n                CLOSE,\n                OVERFLOW_OPEN,\n                OVERFLOW_CLOSE\n            ],\n\n            options: {\n                name: \"ToolBar\",\n                items: [],\n                resizable: true,\n                mobile: null\n            },\n\n            addToGroup: function(button, groupName) {\n                var group;\n\n                if (!this._groups[groupName]) {\n                    group = this._groups[groupName] = new Group();\n                } else {\n                    group = this._groups[groupName];\n                }\n\n                group.add(button);\n                return group;\n            },\n\n            destroy: function() {\n                var that = this;\n\n                that.destroySplitButtons();\n                that.destroyDropDownButtons();\n\n                that.element.off(ns, \"a.k-button\");\n\n                that.userEvents.destroy();\n\n                if (that.options.resizable) {\n                    kendo.unbindResize(that._resizeHandler);\n                    that.overflowUserEvents.destroy();\n                    that.popup.element.off(ns, \"a.k-button\");\n                    that.popup.destroy();\n                }\n\n                Widget.fn.destroy.call(that);\n            },\n\n            destroySplitButtons: function() {\n                var that = this,\n                    splitButtonWrappers = that.element.find(DOT + SPLIT_BUTTON),\n                    item;\n\n\n                splitButtonWrappers.each(function(idx, element) {\n                    item = that._getItem(element);\n\n                    if (item && item.type === SPLITBUTTON) {\n                        item = item.toolbar;\n                    }\n\n                    if (item && item.splitButton && item.splitButton.destroy) {\n                        item.splitButton.destroy();\n                        $(element).remove();\n                    }\n                });\n            },\n\n            destroyDropDownButtons: function() {\n                var that = this,\n                    dropDownButtons = that.element.find(DOT + MENU_BUTTON),\n                    item;\n\n\n                    dropDownButtons.each(function(idx, element) {\n                    item = that._getItem(element);\n\n                    if (item && item.type === DROPDOWNBUTTON) {\n                        item = item.toolbar;\n                    }\n\n                    if (item && item.dropDownButton && item.dropDownButton.destroy) {\n                        item.dropDownButton.destroy();\n                        $(element).remove();\n                    }\n                });\n            },\n\n            add: function(options) {\n                var component = components[options.type],\n                    template = options.template,\n                    tool, that = this,\n                    itemClasses = that.isMobile ? NOTHING : \"k-item\",\n                    overflowTemplate = options.overflowTemplate,\n                    overflowTool;\n\n                $.extend(options, {\n                    uid: kendo.guid(),\n                    animation: that.animation,\n                    mobile: that.isMobile,\n                    rootUid: that.uid\n                });\n\n                if (options.menuButtons) {\n                    for (var i = 0; i < options.menuButtons.length; i++) {\n                        $.extend(options.menuButtons[i], {\n                            uid: kendo.guid()\n                        });\n                    }\n                }\n\n                if ((template && !overflowTemplate) || options.type === SPACER) {\n                    options.overflow = OVERFLOW_NEVER;\n                } else if (!options.overflow) {\n                    options.overflow = OVERFLOW_AUTO;\n                }\n\n                //add the command in the overflow popup\n                if (options.overflow !== OVERFLOW_NEVER && that.options.resizable) {\n                    if (overflowTemplate) { //template command\n                         overflowTool = new OverflowTemplateItem(overflowTemplate, options, that);\n                    } else if (component) { //build-in command\n                        overflowTool = new component.overflow(options, that);\n                        overflowTool.element.addClass(itemClasses);\n                    }\n\n                    if (overflowTool) {\n                        if (options.overflow === OVERFLOW_AUTO) {\n                            overflowTool.overflowHidden();\n                        }\n\n                        overflowTool.element.appendTo(that.popup.container);\n                        that.angular(\"compile\", function() {\n                            return { elements: overflowTool.element.get() };\n                        });\n                    }\n                }\n\n                //add the command in the toolbar container\n                if (options.overflow !== OVERFLOW_ALWAYS) {\n                    if (template) { //template command\n                        tool = new TemplateItem(template, options, that);\n                    } else if (component) { //build-in command\n                        tool = new component.toolbar(options, that);\n                    }\n\n                    if (tool) {\n                        tool.element.appendTo(that.element);\n\n                        that.angular(\"compile\", function() {\n                            return { elements: tool.element.get() };\n                        });\n                    }\n                }\n            },\n\n            _getItem: function(candidate) {\n                var element,\n                    toolbarItem,\n                    overflowItem,\n                    isResizable = this.options.resizable,\n                    type;\n\n                //find toolbar item\n                element = this.element.find(candidate);\n\n                if (!element.length) {\n                    element = $(\"[data-role=\\\"buttonmenu\\\"]\").find(candidate);\n                }\n\n                type = element.length ? element.data(\"type\") : NOTHING;\n                toolbarItem = element.data(type);\n\n                if (toolbarItem && isResizable) {\n\n                        overflowItem = toolbarItem.twin();\n                } else if (isResizable) { //find overflow item\n                    element = this.popup.element.find(candidate);\n                    type = element.length ? element.data(\"type\") : NOTHING;\n                    overflowItem = element.data(type);\n\n                    if (type === TEXT_ITEM) {\n                        element = element.parent(DOT + MENU_BUTTON);\n                        type = \"dropDownButton\";\n                        overflowItem = element.data(type);\n                    }\n\n                    if (overflowItem && overflowItem.main && type !== TEXT_ITEM) {\n                        element = element.parent(DOT + SPLIT_BUTTON);\n                        type = \"splitButton\";\n                        overflowItem = element.data(type);\n                    }\n                }\n\n                return {\n                    type: type,\n                    toolbar: toolbarItem,\n                    overflow: overflowItem\n                };\n            },\n\n            remove: function(candidate) {\n                var item = this._getItem(candidate);\n\n                if (item.toolbar) { item.toolbar.remove(); }\n                if (item.overflow) { item.overflow.remove(); }\n\n                this.resize(true);\n            },\n\n            hide: function(candidate) {\n                var item = this._getItem(candidate);\n                var buttonGroupInstance;\n\n                if (item.toolbar) {\n                    if (item.toolbar.options.type === BUTTON && item.toolbar.options.isChild) {\n                        buttonGroupInstance = item.toolbar.getParentGroup();\n\n                        item.toolbar.hide();\n\n                        if (buttonGroupInstance) {\n                            buttonGroupInstance.refresh();\n                        }\n                    } else if (!item.toolbar.options.hidden) {\n                        item.toolbar.hide();\n                    }\n                }\n\n                if (item.overflow) {\n                    if (item.overflow.options.type === BUTTON && item.overflow.options.isChild) {\n                        buttonGroupInstance = item.overflow.getParentGroup();\n\n                        item.overflow.hide();\n\n                        if (buttonGroupInstance) {\n                            buttonGroupInstance.refresh();\n                        }\n                    } else if (!item.overflow.options.hidden) {\n                        item.overflow.hide();\n                    }\n                }\n\n                this.resize(true);\n            },\n\n            show: function(candidate) {\n                var item = this._getItem(candidate);\n                var buttonGroupInstance;\n\n                if (item.toolbar) {\n                    if (item.toolbar.options.type === BUTTON && item.toolbar.options.isChild) {\n                        buttonGroupInstance = item.toolbar.getParentGroup();\n                        item.toolbar.show();\n\n                        if (buttonGroupInstance) {\n                            buttonGroupInstance.refresh();\n                        }\n                    } else if (item.toolbar.options.hidden) {\n                        item.toolbar.show();\n                    }\n                }\n\n                if (item.overflow) {\n                    if (item.overflow.options.type === BUTTON && item.overflow.options.isChild) {\n                        buttonGroupInstance = item.overflow.getParentGroup();\n\n                        item.toolbar.show();\n\n                        if (buttonGroupInstance) {\n                            buttonGroupInstance.refresh();\n                        }\n                    } else if (item.overflow.options.hidden) {\n                        item.overflow.show();\n                    }\n                }\n\n                this.resize(true);\n            },\n\n            enable: function(element, enable) {\n                var item = this._getItem(element);\n\n                if (typeof enable == \"undefined\") {\n                    enable = true;\n                }\n\n                if (item.toolbar) { item.toolbar.enable(enable, item.element); }\n                if (item.overflow) { item.overflow.enable(enable); }\n            },\n\n            getSelectedFromGroup: function(groupName) {\n                return this.element.find(DOT + TOGGLE_BUTTON + \"[data-group='\" + groupName + \"']\").filter(DOT + STATE_SELECTED);\n            },\n\n            toggle: function(button, checked) {\n                var element = $(button),\n                    item = element.data(BUTTON);\n\n                if (item.options.togglable) {\n                    if (checked === undefined) {\n                        checked = true;\n                    }\n\n                    item.toggle(checked, true);\n                }\n            },\n\n            _renderOverflow: function() {\n                var that = this,\n                    overflowContainer = components.overflowContainer,\n                    isRtl = that._isRtl,\n                    horizontalDirection = isRtl ? \"left\" : \"right\";\n\n                that.overflowAnchor = $(components.overflowAnchor).addClass(KBUTTON);\n\n                that.element.append(that.overflowAnchor);\n\n                if (that.isMobile) {\n                    that.overflowAnchor.append('<span class=\"km-icon km-more\"></span>');\n                    overflowContainer = actionSheetWrap(overflowContainer);\n                } else {\n                    that.overflowAnchor.append('<span class=\"k-icon k-i-more-vertical\"></span>');\n                }\n\n                that.popup = new kendo.ui.Popup(overflowContainer, {\n                    origin: \"bottom \" + horizontalDirection,\n                    position: \"top \" + horizontalDirection,\n                    anchor: that.overflowAnchor,\n                    isRtl: isRtl,\n                    animation: that.animation,\n                    appendTo: that.isMobile ? $(that.isMobile).children(\".km-pane\") : null,\n                    copyAnchorStyles: false,\n                    open: function(e) {\n                        var wrapper = kendo.wrap(that.popup.element)\n                            .addClass(OVERFLOW_WRAPPER);\n\n                        if (!that.isMobile) {\n                            wrapper.css(\"margin-left\", (isRtl ? -1 : 1) * ((outerWidth(wrapper) - wrapper.width()) / 2 + 1));\n                        } else {\n                            that.popup.container.css(\"max-height\", (parseFloat($(\".km-content:visible\").innerHeight()) - 15) + \"px\");\n                        }\n\n                        if (that.trigger(OVERFLOW_OPEN)) {\n                            e.preventDefault();\n                        }\n                    },\n                    activate: function() {\n                        this.element.find(\":kendoFocusable\").first().trigger(FOCUS);\n                    },\n                    close: function(e) {\n                        if (that.trigger(OVERFLOW_CLOSE)) {\n                            e.preventDefault();\n                        }\n\n                        this.element.trigger(FOCUS);\n                    }\n                });\n\n                that.popup.element.on(KEYDOWN + ns, DOT + KBUTTON, function(e) {\n                    var target = $(e.target),\n                        li = target.parent(),\n                        isComplexTool = li.is(DOT + BUTTON_GROUP) || li.is(DOT + SPLIT_BUTTON),\n                        element;\n\n                    e.preventDefault();\n\n                    if (e.keyCode === keys.ESC || e.keyCode === keys.TAB || (e.altKey && e.keyCode === keys.UP)) {\n\n                        that._toggleOverflow();\n                        that.overflowAnchor.trigger(FOCUS);\n                    } else if (e.keyCode === keys.DOWN) {\n                        element = !isComplexTool || (isComplexTool && target.is(\":last-child\")) || (isComplexTool && !target.next().is(\":kendoFocusable\")) ? li : target;\n                        findFocusableSibling(element, NEXT).trigger(FOCUS);\n                    } else if (e.keyCode === keys.UP) {\n                        element = !isComplexTool || (isComplexTool && target.is(\":first-child\")) || (isComplexTool && !target.prev().is(\":kendoFocusable\")) ? li : target;\n                        findFocusableSibling(element, PREV).trigger(FOCUS);\n                    } else if ((e.keyCode === keys.SPACEBAR || e.keyCode === keys.ENTER) && !$(e.target).is(DOT + STATE_DISABLED)) {\n                        that.userEvents.trigger(TAP, { target: $(e.target) });\n                        that.overflowAnchor.trigger(FOCUS);\n                    } else if (e.keyCode === keys.HOME) {\n                        li.parent().find(\":kendoFocusable\").first().trigger(FOCUS);\n                    } else if (e.keyCode === keys.END) {\n                        li.parent().find(\":kendoFocusable\").last().trigger(FOCUS);\n                    }\n                });\n\n                if (that.isMobile) {\n                    that.popup.container = that.popup.element.find(DOT + OVERFLOW_CONTAINER);\n                } else {\n                    that.popup.container = that.popup.element;\n                }\n\n                that.popup.container.attr(KENDO_UID_ATTR, this.uid);\n            },\n\n            _toggleOverflowAnchor: function() {\n                var hasVisibleChildren = false;\n                var paddingEnd = this._isRtl ? \"padding-left\" : \"padding-right\";\n\n                if (this.options.mobile) {\n                    hasVisibleChildren = this.popup.element.find(DOT + OVERFLOW_CONTAINER).children(\":not(.\" + OVERFLOW_HIDDEN + \", .\" + POPUP + \")\").length > 0;\n                } else {\n                    hasVisibleChildren = this.popup.element.children(\":not(.\" + OVERFLOW_HIDDEN + \", .\" + POPUP + \")\").length > 0;\n                }\n\n                if (hasVisibleChildren) {\n                    this.overflowAnchor.css({\n                        visibility: \"visible\",\n                        width: NOTHING\n                    });\n                    this.wrapper.css(paddingEnd, this.overflowAnchor.outerWidth(true));\n                } else {\n                    this.overflowAnchor.css({\n                        visibility: \"hidden\",\n                        width: \"1px\"\n                    });\n                    this.wrapper.css(paddingEnd, NOTHING);\n                }\n            },\n\n            _buttonClick: function(e) {\n                var that = this,\n                    target = $(e.target),\n                    item, handler, eventData, urlTarget;\n\n                e.preventDefault();\n\n                if (!target.data(SPLITBUTTON)) {\n                    target = $(e.target).closest(DOT + KBUTTON + COMMA + EMPTY + DOT + MENU_LINK, that.element);\n                }\n\n                if (target.hasClass(OVERFLOW_ANCHOR)) {\n                    return;\n                }\n\n                item = target.data(BUTTON);\n\n                if (!item && that.popup) {\n                    target = $(e.target).closest(DOT + OVERFLOW_BUTTON, that.popup.container);\n                    item = target.parent(\"li\").data(BUTTON);\n                }\n\n                if (!item || !item.options.enable) {\n                    return;\n                }\n\n                if (item.options.togglable) {\n                    handler = isFunction(item.toggleHandler) ? item.toggleHandler : null;\n\n                    item.toggle(!item.options.selected, true);\n                    eventData = { target: target, group: item.options.group, checked: item.options.selected, id: item.options.id, item: item };\n\n                    if (handler) { handler.call(that, eventData); }\n                    that.trigger(TOGGLE, eventData);\n                } else {\n                    handler = isFunction(item.clickHandler) ? item.clickHandler : null;\n                    eventData = { sender: that, target: target, id: item.options.id, item: item };\n\n                    if (handler) { handler.call(that, eventData); }\n                    that.trigger(CLICK, eventData);\n                }\n\n                if (item.options.url) {\n                    if (item.options.attributes && item.options.attributes.target) {\n                        urlTarget = item.options.attributes.target;\n                    }\n                    window.open(item.options.url, urlTarget || \"_self\");\n                }\n\n                if (target.hasClass(OVERFLOW_BUTTON)) {\n                    that.popup.close();\n                }\n            },\n\n            _navigatable: function() {\n                var that = this;\n\n                that.element\n                    .attr(TABINDEX, 0)\n                    .on(FOCUSIN + ns, function(ev) {\n                        var target = $(ev.target);\n                        var element = $(this).find(\":kendoFocusable\").first();\n\n                        if (!target.is(DOT + TOOLBAR) || element.length === 0) {\n                            return;\n                        }\n\n                        if (element.is(DOT + OVERFLOW_ANCHOR)) {\n                            element = findFocusableSibling(element, NEXT);\n                        }\n\n                        if (element.length) {\n                            element[0].focus();\n                        }\n                    })\n                    .on(KEYDOWN + ns, that._keydown.bind(that));\n            },\n\n            _keydown: function(e) {\n                var target = $(e.target),\n                    keyCode = e.keyCode,\n                    items = this.element.children(\":not(.k-separator):visible\"),\n                    direction = this._isRtl ? -1 : 1;\n\n                if (keyCode === keys.TAB) {\n                    var element = target.parentsUntil(this.element).last(),\n                        lastHasFocus = false,\n                        firstHasFocus = false,\n                        isOnlyOverflowAnchor = false;\n\n                    if (!items.not(DOT + OVERFLOW_ANCHOR).length) {\n                        isOnlyOverflowAnchor = true;\n                    }\n\n                    if (!element.length) {\n                        element = target;\n                    }\n\n                    if (element.is(DOT + OVERFLOW_ANCHOR) && !isOnlyOverflowAnchor) {\n                        var lastItemNotOverflowAnchor = items.last();\n\n                        if (e.shiftKey) {\n                            e.preventDefault();\n                        }\n\n                        if (lastItemNotOverflowAnchor.is(\":kendoFocusable\")) {\n                            items.last().trigger(FOCUS);\n                        } else {\n                            items.last().find(\":kendoFocusable\").last().trigger(FOCUS);\n                        }\n                    }\n\n                    if (!e.shiftKey && items.index(element) === items.length - 1) {\n                        if (element.is(DOT + BUTTON_GROUP)) {\n                            lastHasFocus = target.is(\":last-child\");\n                        } else {\n                            lastHasFocus = true;\n                        }\n                    }\n\n                    var isFirstTool = items.index(element) === items.not(\".k-overflow-anchor\").first().index();\n                    if (e.shiftKey && isFirstTool) {\n                        if (element.is(DOT + BUTTON_GROUP)) {\n                            firstHasFocus = target.is(\":first-child\");\n                        } else {\n                            firstHasFocus = true;\n                        }\n                    }\n\n                    if (lastHasFocus && this.overflowAnchor && this.overflowAnchor.css(\"visibility\") !== \"hidden\" && !isOnlyOverflowAnchor) {\n                        e.preventDefault();\n                        this.overflowAnchor.trigger(FOCUS);\n                    }\n\n                    if (firstHasFocus || (isOnlyOverflowAnchor && e.shiftKey)) {\n                        e.preventDefault();\n                        var prevFocusable = this._getPrevFocusable(this.wrapper);\n                        if (prevFocusable) {\n                            prevFocusable.trigger(FOCUS);\n                        }\n                    }\n                    this._preventNextFocus = false;\n                }\n\n                if (e.altKey && keyCode === keys.DOWN) {\n                    var isOverflowAnchor = $(document.activeElement).is(DOT + OVERFLOW_ANCHOR);\n\n                    if (isOverflowAnchor) {\n                        this._toggleOverflow();\n                    }\n\n                    return;\n                }\n\n                if ((keyCode === keys.SPACEBAR || keyCode === keys.ENTER) && !target.is(\"input, checkbox, button\")) {\n                    if (keyCode === keys.SPACEBAR) {\n                        e.preventDefault(); //prevent spacebar to scroll the page down\n                        this.userEvents.trigger(TAP, { target: target });\n                    }\n\n                    return;\n                }\n\n                if (keyCode === keys.HOME) {\n                    if (target.is(\".k-dropdownlist\") || target.is(\"input\")) {\n                        return;\n                    }\n\n                    if (this.overflowAnchor) {\n                        items.eq(1).trigger(FOCUS);\n                    } else {\n                        items.first().trigger(FOCUS);\n                    }\n                    e.preventDefault();\n                } else if (keyCode === keys.END) {\n                    if (target.is(\".k-dropdownlist\") || target.is(\"input\")) {\n                        return;\n                    }\n                    if (this.overflowAnchor && $(this.overflowAnchor).css(\"visibility\") != \"hidden\") {\n                        this.overflowAnchor.trigger(FOCUS);\n                    } else {\n                        items.last().trigger(FOCUS);\n                    }\n                    e.preventDefault();\n                } else if (keyCode === keys.RIGHT && !this._preventNextFocus && !target.is(\"input, select, .k-dropdownlist, .k-colorpicker\") && this._getNextElement(e.target, 1 * direction)) {\n                    this._getNextElement(e.target, 1 * direction).focus();\n                    e.preventDefault();\n                } else if (keyCode === keys.LEFT && !this._preventNextFocus && !target.is(\"input, select, .k-dropdownlist, .k-colorpicker\") && this._getNextElement(e.target, -1 * direction)) {\n                    this._getNextElement(e.target, -1 * direction).focus();\n                    e.preventDefault();\n                }\n            },\n\n            _getNextElement: function(item, direction) {\n                var items = this.element.children(\":not(.k-separator, .k-spacer):visible\");\n                var itemIndex = items.index(item) === -1 ? items.index(item.parentElement) : items.index(item);\n                var startIndex = this.overflowAnchor ? 1 : 0;\n                var directionNumber = direction;\n                var searchIndex = direction === 1 ? items.length - 1 : startIndex;\n                var index = direction === 1 ? startIndex : items.length - 1;\n                var focusableItem = items[itemIndex + direction];\n                this._preventNextFocus = false;\n\n                if ($(item).closest(DOT + BUTTON_GROUP).not(DOT + SPLIT_BUTTON).length && !$(item).is(direction === 1 ? \":last-child\" : \":first-child\")) {\n                    return $(item)\n                        .closest(DOT + BUTTON_GROUP)\n                        .children()[$(item)\n                        .closest(DOT + BUTTON_GROUP)\n                        .children()\n                        .index(item) + direction];\n                }\n\n                if (this.overflowAnchor && item === this.overflowAnchor[0] && direction === -1) {\n                    focusableItem = items[items.length - 1];\n                }\n\n                if (itemIndex === searchIndex) {\n                    focusableItem = !this.overflowAnchor ||\n                        (this.overflowAnchor &&\n                        $(this.overflowAnchor).css(\"visibility\") === \"hidden\") ? items[index] : this.overflowAnchor;\n                }\n\n                while (!$(focusableItem).is(\":kendoFocusable\")) {\n                    if (direction === -1 && $(focusableItem).closest(DOT + BUTTON_GROUP).length) {\n                        focusableItem = $(focusableItem).children(\":not(label, div)\").last();\n                    } else {\n                        focusableItem = $(focusableItem).children(\":not(label, div)\").first();\n                    }\n                    if (!focusableItem.length) {\n                        directionNumber = directionNumber + direction;\n                        focusableItem = items[itemIndex + directionNumber];\n                        if (!focusableItem) {\n                            return this.overflowAnchor;\n                        }\n                    }\n\n                    if ($(focusableItem).hasClass(\"k-combobox\")) {\n                        focusableItem = $(focusableItem).find(\"input\");\n                    }\n\n                    if ($(focusableItem).hasClass(\"k-split-button-arrow\")) {\n                        focusableItem = $(focusableItem).prev();\n                    }\n\n                    this._preventNextFocus = $(focusableItem).closest(DOT + BUTTON_GROUP).length ? false : true;\n                }\n\n                return focusableItem;\n            },\n\n            _getPrevFocusable: function(element) {\n                if (element.is(\"html\")) {\n                    return element;\n                }\n\n                var elementToFocus, prevElement,\n                    prevElements = element.prevAll();\n                prevElements.each(function() {\n                    prevElement = $(this);\n                    if (prevElement.is(\":kendoFocusable\")) {\n                        elementToFocus = prevElement;\n                        return false;\n                    } else if (prevElement.find(\":kendoFocusable\").length > 0) {\n                        elementToFocus = prevElement.find(\":kendoFocusable\").last();\n                        return false;\n                    }\n                });\n                if (elementToFocus) {\n                    return elementToFocus;\n                } else {\n                    return this._getPrevFocusable(element.parent());\n                }\n            },\n\n            _toggle: function(e) {\n                var splitButton = $(e.target).closest(DOT + SPLIT_BUTTON).data(\"splitButton\");\n\n                e.preventDefault();\n\n                if (!splitButton.options.enable) {\n                    return;\n                }\n\n                splitButton.toggle();\n            },\n\n            _toggleOverflow: function() {\n                this.popup.toggle();\n            },\n\n            _resize: function(e) {\n                var containerWidth = e.width;\n\n                if (!this.options.resizable) {\n                    return;\n                }\n\n                this.popup.close();\n\n                this._shrink(containerWidth);\n                this._stretch(containerWidth);\n\n                this._markVisibles();\n\n                this._toggleOverflowAnchor();\n            },\n\n            _childrenWidth: function() {\n                var childrenWidth = 0;\n                var gap = parseInt(this.element.css('gap'), 10) || 0;\n\n                this.element.children(\":visible:not(\" + DOT + SPACER_CLASS + \")\").each(function() {\n                    childrenWidth += outerWidth($(this), true) + gap;\n                });\n\n                return Math.ceil(childrenWidth);\n            },\n\n            _shrink: function(containerWidth) {\n                var commandElement,\n                    visibleCommands;\n\n                if (containerWidth < this._childrenWidth()) {\n                    visibleCommands = this.element.children(\":visible:not([data-overflow='never'], .\" + OVERFLOW_ANCHOR + \")\");\n\n                    for (var i = visibleCommands.length - 1; i >= 0; i--) {\n                        commandElement = visibleCommands.eq(i);\n\n                        if (containerWidth > this._childrenWidth()) {\n                            break;\n                        } else {\n                            this._hideItem(commandElement);\n                        }\n                    }\n                }\n            },\n\n            _stretch: function(containerWidth) {\n                var commandElement,\n                    hiddenCommands;\n\n                if (containerWidth > this._childrenWidth()) {\n                    hiddenCommands = this.element.children(DOT + STATE_HIDDEN + \":not(\" + DOT + FORCE_HIDDEN + \")\");\n\n                    for (var i = 0; i < hiddenCommands.length; i++) {\n                        commandElement = hiddenCommands.eq(i);\n                        if (containerWidth < this._childrenWidth() || !this._showItem(commandElement, containerWidth)) {\n                            break;\n                        }\n                    }\n                }\n            },\n\n            _hideItem: function(item) {\n                item.addClass(STATE_HIDDEN);\n\n                if (this.popup) {\n                    this.popup.container\n                        .find(\">li[data-uid='\" + item.data(\"uid\") + \"']\")\n                        .removeClass(OVERFLOW_HIDDEN);\n                }\n            },\n\n            _showItem: function(item, containerWidth) {\n                var gap = parseInt(this.element.css('gap'), 10) || 0;\n                // From jquery.outerWidth docs:\n                //  > jQuery will attempt to temporarily show and then re-hide an element\n                //  > in order to measure its dimensions, but this is unreliable\n                // Thus we show and hide the item\n                item.removeClass(STATE_HIDDEN);\n                var itemOuterWidth = outerWidth(item, true) + gap;\n                item.addClass(STATE_HIDDEN);\n\n                if (item.length && containerWidth > this._childrenWidth() + itemOuterWidth) {\n\n                    item.removeClass(STATE_HIDDEN);\n\n                    if (this.popup) {\n                        this.popup.container\n                            .find(\">li[data-uid='\" + item.data(\"uid\") + \"']\")\n                            .addClass(OVERFLOW_HIDDEN);\n                    }\n\n                    return true;\n                }\n\n                return false;\n            },\n\n            _markVisibles: function() {\n                var overflowItems = this.popup.container.children(),\n                    toolbarItems = this.element.children(\":not(.k-overflow-anchor)\"),\n                    visibleOverflowItems = overflowItems.filter(\":not(.k-overflow-hidden)\"),\n                    visibleToolbarItems = toolbarItems.filter(\":visible\");\n\n                overflowItems.add(toolbarItems).removeClass(FIRST_TOOLBAR_VISIBLE + EMPTY + LAST_TOOLBAR_VISIBLE);\n                visibleOverflowItems.first().add(visibleToolbarItems.first()).addClass(FIRST_TOOLBAR_VISIBLE);\n                visibleOverflowItems.last().add(visibleToolbarItems.last()).addClass(LAST_TOOLBAR_VISIBLE);\n            }\n\n        });\n\n    kendo.ui.plugin(ToolBar);\n})(window.kendo.jQuery);\n\nreturn window.kendo;\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3) { (a3 || a2)(); });\n\n"],"names":["define","__meta__","id","name","category","description","depends","$","window","kendo","jQuery","undefined","Class","ui","Widget","isFunction","keys","outerWidth","_outerWidth","ns","TOOLBAR","KBUTTON","OVERFLOW_BUTTON","TOGGLE_BUTTON","BUTTON_GROUP","SPLIT_BUTTON","MENU_BUTTON","KSEPARATOR","SPACER_CLASS","POPUP","RESIZABLE_TOOLBAR","STATE_SELECTED","STATE_DISABLED","STATE_HIDDEN","FORCE_HIDDEN","GROUP_START","GROUP_END","MENU_LINK","MENU_ITEM","OVERFLOW_GROUP","OVERFLOW_HIDDEN","OVERFLOW_ANCHOR","OVERFLOW_CONTAINER","OVERFLOW_WRAPPER","FIRST_TOOLBAR_VISIBLE","LAST_TOOLBAR_VISIBLE","ARIA_DISABLED","ARIA_PRESSED","CLICK","TOGGLE","OPEN","CLOSE","FOCUS","FOCUSIN","KEYDOWN","TAP","SPACER","BOTH","PRIMARY","HREF","ROLE","BUTTON","SPLITBUTTON","DROPDOWNBUTTON","SEPARATOR","OVERFLOW","NEXT","PREV","TABINDEX","TEMPLATE","OVERFLOW_OPEN","OVERFLOW_CLOSE","OVERFLOW_NEVER","OVERFLOW_AUTO","OVERFLOW_ALWAYS","OPTION_LIST_SUFFIX","KENDO_UID_ATTR","attr","POPUP_ITEM_TEMPLATE","MENU_LINK_SPAN","MENU_LINK_A","EMPTY","NOTHING","TEXT_ITEM","DOT","COMMA","ID","components","toolbar","overflowAnchor","overflowContainer","Item","registerComponent","overflow","extend","addOverflowAttr","this","element","options","addUidAttr","uid","addIdAttr","addOverflowIdAttr","attributes","classes","class","addClass","show","removeClass","hidden","hide","overflowHidden","remove","enable","isEnabled","toggleClass","twin","splitContainerId","find","data","type","resizable","popup","BareItem","init","Button","useButtonTag","primary","themeColor","togglable","toggle","selected","url","mobile","group","addToGroup","click","clickHandler","toggleHandler","showIcon","showText","state","propagate","select","getParentGroup","isChild","closest","ToolBarButton","fn","call","align","text","html","icon","spriteCssClass","imageUrl","renderButton","button","OverflowButton","_wrap","wrap","parent","ButtonGroup","createButtons","buttonConstructor","items","buttons","item","i","length","guid","appendTo","refresh","children","filter","first","last","ToolBarButtonGroup","buttonGroup","OverflowButtonGroup","ToolBarMenuButton","img","span","template","href","prependTo","ToolBarSplitButton","that","splitButton","SplitButton","_extend","menuButtons","wrapper","bind","_buttonClick","_close","_open","addMenuAttributes","ev","isDefaultPrevented","trigger","target","preventDefault","map","itemInstance","each","index","elmToRemove","destroy","mainButton","OverflowSplitButton","main","elements","add","ToolBarDropDownButton","dropDownButton","DropDownButton","OverflowTextItem","append","textItem","OverflowDropDownButton","ToolBarSeparator","separator","OverflowSeparator","ToolBarSpacer","TemplateItem","OverflowTemplateItem","toggleActive","e","is","actionSheetWrap","hasClass","preventClick","findFocusableSibling","dir","getSibling","next","prev","getter","candidate","Group","inArray","splice","tmp","ToolBar","_isRtl","support","isRtl","_groups","isMobile","animation","open","effects","_renderOverflow","overflowUserEvents","UserEvents","threshold","allowSelection","tap","_toggleOverflow","_resizeHandler","onResize","resize","_shrink","innerWidth","userEvents","document","documentElement","press","release","on","_navigatable","_toggleOverflowAnchor","notify","events","groupName","destroySplitButtons","destroyDropDownButtons","off","unbindResize","splitButtonWrappers","idx","_getItem","dropDownButtons","component","tool","itemClasses","overflowTemplate","overflowTool","rootUid","container","angular","get","toolbarItem","overflowItem","isResizable","buttonGroupInstance","getSelectedFromGroup","checked","horizontalDirection","Popup","origin","position","anchor","copyAnchorStyles","css","width","parseFloat","innerHeight","activate","close","li","isComplexTool","keyCode","ESC","TAB","altKey","UP","DOWN","SPACEBAR","ENTER","HOME","END","hasVisibleChildren","paddingEnd","visibility","handler","eventData","urlTarget","sender","focus","_keydown","direction","parentsUntil","lastHasFocus","firstHasFocus","isOnlyOverflowAnchor","not","lastItemNotOverflowAnchor","shiftKey","isFirstTool","prevFocusable","_getPrevFocusable","_preventNextFocus","isOverflowAnchor","activeElement","eq","RIGHT","_getNextElement","LEFT","itemIndex","parentElement","startIndex","directionNumber","searchIndex","focusableItem","elementToFocus","prevElement","prevElements","prevAll","_toggle","_resize","containerWidth","_stretch","_markVisibles","_childrenWidth","childrenWidth","gap","parseInt","Math","ceil","commandElement","visibleCommands","_hideItem","hiddenCommands","_showItem","itemOuterWidth","overflowItems","toolbarItems","visibleOverflowItems","visibleToolbarItems","plugin","amd","a1","a2","a3"],"mappings":"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"}